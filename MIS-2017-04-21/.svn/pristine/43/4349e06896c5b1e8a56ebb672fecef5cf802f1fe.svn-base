<%@ page contentType="text/html;charset=UTF-8" language="java"%> 
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%> 
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="description" content="">
	<meta name="author" content="">
	<link rel="shortcut icon" href="images/logo.png">

	<title>设备报警历史</title>

	<!-- Bootstrap core CSS -->
	<link href="js/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="js/jquery.gritter/css/jquery.gritter.css" />

	<link rel="stylesheet" href="fonts/font-awesome-4/css/font-awesome.min.css">

	<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
	  <script src="../../assets/js/html5shiv.js"></script>
	  <script src="../../assets/js/respond.min.js"></script>
	<![endif]-->
	<link rel="stylesheet" type="text/css" href="js/jquery.nanoscroller/nanoscroller.css" />
	<link rel="stylesheet" type="text/css" href="js/jquery.easypiechart/jquery.easy-pie-chart.css" />
	<link rel="stylesheet" type="text/css" href="js/bootstrap.switch/bootstrap-switch.css" />
	<link rel="stylesheet" type="text/css" href="js/bootstrap.datetimepicker/css/bootstrap-datetimepicker.min.css" />
	<link rel="stylesheet" type="text/css" href="js/jquery.select2/select2.css" />
	<link rel="stylesheet" type="text/css" href="js/bootstrap.slider/css/slider.css" />
  	<link rel="stylesheet" type="text/css" href="js/jquery.niftymodals/css/component.css" />
  	<link href="js/jquery.icheck/skins/square/blue.css" rel="stylesheet">

  	<link rel="stylesheet" href="js/jquery.crop/css/jquery.Jcrop.css" type="text/css" />
	<link href="css/style.css" rel="stylesheet" />	
	<link rel="stylesheet" type="text/css" href="js/jquery.datatables/bootstrap-adapter/css/datatables.css" />
	<script type="text/javascript" src="js/sortListTool.js"></script>
<style>

.dropdown-toggle{height:24px}
#deltip1, #deltip2{color:#2083d6}

.hideAndShow{display:none;}
.no-bg-border{background-color:#fff;border:none}

.hideul{position:absolute;top:33px;z-index:200;right:15px;left:15px;display:none}
.hideul ul{ border:1px solid #ccc;width:100%;background:#f4f4f4;padding-left:0}
.hideul ul li{ list-style-type:none;text-indent:20px}
.hideul ul li:hover{ background:#ddd}
.mytablenopadding>tr>td{padding-top:0 !important;padding-bottom:0 !important;}
.mytablenopadding>tr>td:nth-child(2){padding-top:7px !important;padding-bottom:7px !important;text-align:right}
.mytablenopadding>tr{background:#fff !important;}
.mytablenopadding input,.mytablenopadding select{border:0}
</style>
<script type="text/javascript" src="js/addressJS.js"></script>
</head>

<body>	
<div id="cl-wrapper" style="padding-top:0px">	
		<div class="container-fluid" style="padding: 0px">
		<!-- 头部开始 -->
			<div class="page-head">
				<h2>设备报警历史</h2>
				<ol class="breadcrumb">
					<li>设备管理</li>
					<input type="hidden" value="" id="sortType">
					<input type="hidden" value="" id="sortColumn">
					<li class="active">设备报警历史</li>
				</ol>
			</div>
		</div>
		<!-- 头部结束 -->
	<div class="cl-mcont">
    <div class="block-flat">
    		<div class="row">
									
										<div class="col-sm-2" style=" vertical-align: middle; height: 34px; line-height: 34px;">
											<label>老人姓名</label>
										</div>
										<div class="col-sm-4 "  style="position:relative">
											<input type="hidden" value="0" id="olderId_hide">
											<div class="input-group " >
												<input class="form-control"  type="text" id="oldinput_search" onclick="getolderName()" oninput="getolderName()" onmouseout="javascript:$('#hideul-1').hide();" onmouseover="javascript:$('#hideul-1').show();">
												<span class="input-group-btn"><button class="btn btn-primary " type="button" style="height:34px"><span class="fa fa-search"></span></button></span>
											</div>
											<div class="hideul" id="hideul-1"  onmouseover="javascript:$('#hideul-1').show();" onmouseout="javascript:$('#hideul-1').hide();">
												<ul id="hideul_nei1">
							
												</ul>
											</div>
										</div>
										
										<div class="col-sm-2" style=" vertical-align: middle; height: 34px; line-height: 34px;">
											<label>设备编号</label>
										</div>
										<div class="col-sm-4 " style="margin-bottom:10px;">
											<input class="form-control" type="text" style="width: 100%" id="dev_bianhao">
										</div>
										<div style="clear:both"></div>
										<div class="col-sm-2  col-md-2" style="vertical-align: middle; height: 34px; line-height: 34px;">
											<label>报警类别</label>
										</div>
										<div class="col-sm-10 col-md-10" style="margin-bottom:10px;">
											<select class="select2" multiple id="list_alarmType">
												<option value="21">门磁未接入网络</option>
												<option value="22">门磁电量不足</option>
												<option value="25">门磁门未关</option>
												<option value="33">腕带紧急求助</option>
												<option value="41">生命感应器未接入网络</option>
												<option value="42">生命感应器电量不足</option>
												<option value="43">生命感应器区域内无人</option>
												<option value="81">定位器SOS报警</option>
												<option value="82">定位器低电量</option>
												<option value="83">定位器摔倒报警</option>
												<option value="84">定位器越界报警</option>
                      						</select>
										</div>
					<div class="col-sm-2  col-md-2" style="padding-top:5px">
						 <strong>报警时间区间</strong>
					</div>
					<div class="col-sm-4 col-md-4" style="">						
                		<div class="input-group">
                		<input class="datetime form-control"  size="10" type="text" id="list_alarmtTimeStart" readonly="" data-min-view="2" data-date-format="yyyy-mm-dd" placeholder="YYYY-MM-DD"/>
                		<span class="input-group-btn"><button class="btn btn-danger deleteThisTime" type="button" style="height:34px"><span class="fa fa-times"></span></button></span>
                		<span class="input-group-addon no-bg-border">~</span>
                		<input class="datetime form-control"   size="10" type="text" id="list_alarmtTimeEnd" readonly="" data-min-view="2" data-date-format="yyyy-mm-dd" placeholder="YYYY-MM-DD"/>
                		<span class="input-group-btn"><button class="btn btn-danger deleteThisTime" type="button" style="height:34px"><span class="fa fa-times"></span></button></span>
                		</div>
					</div>
										
									<!-- 查询框结束 -->
									<!-- 操作按钮开始 -->
									
										<div class="col-sm-12" style="margin-top:20px">	
											<c:if test="${devAlarm_query_btn_control != 'yes' or devAlarm_query_btn_show == 'yes'}">	
												<button class="btn btn-primary" style="margin-bottom: 10px !important; height: 34px;margin-left:0;" onclick="query_alarm()">查询</button>
											</c:if>	
											<!-- <a style="cursor:pointer;text-decoration:underline;vertical-align:bottom;" onclick="$('.hideAndShow').toggle();">更多查询条件</a> -->
											<div class="btn-group" style="margin-top:5px;float:right;margin-right:0">
												 <%-- <c:if test="${devAlarm_add_btn_control != 'yes' or devAlarm_add_btn_show == 'yes'}">
						  						 <button type="button" class="btn btn-primary dropdown-toggle  md-trigger" data-toggle="dropdown" data-modal="servicegongdan_add" onclick="qingkongXZ()">
													<span><i class="fa fa-plus" style="margin-right:5px;"></i>新增</span>
						 						 </button>
						 						 </c:if>	
						 						 <c:if test="${devAlarm_del_btn_control != 'yes' or devAlarm_del_btn_show == 'yes'}">
						 						 <button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown"  style="margin-left:5px;margin-right:0" onclick="doDel()">
													<span><i class="fa fa-minus" style="margin-right:5px;"></i>删除</span>
						 						 </button>
												 </c:if>	
												 <c:if test="${devAlarm_qx_btn_control != 'yes' or devAlarm_qx_btn_show == 'yes'}">
												  <button type="button" class="btn btn-danger dropdown-toggle  md-trigger" data-toggle="dropdown" style="display:none;" data-modal="servicegongdan_quxiao" id="quxiao_open"></button>
						 						  <button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown" onclick="quxiao_qingkong()" style="margin-left:5px;margin-right:0">
													<span><i class="fa fa-minus" style="margin-right:5px;"></i>取消</span>
						 						  </button>
												 </c:if>	 --%>
										 	</div>
										</div>
								
									<!-- 操作按钮结束 -->
                                    <!-- 数据表格开始 -->
										<div class="col-sm-12">							
											<table class="table table-bordered dataTable hover" id="datatable" aria-describedby="datatable_info_alarm">
												<thead>
													<tr role="row">
														<th><strong>设备编号</strong></th>
														<th name="needSort" class="sorting" onclick="queryBySort(this,'alarmTime')"><strong>报警时间</strong></th>
														<th name="needSort" class="sorting" onclick="queryBySort(this,'chinese_olderName')"><strong>绑定老人</strong></th>
														<th name="needSort" class="sorting" onclick="queryBySort(this,'chinese_alarmContent')"><strong>报警内容</strong></th>
														<th name="needSort" class="sorting" onclick="queryBySort(this,'chinese_address')"><strong>报警位置</strong></th>
													</tr>
												</thead>
												<tbody id="datacontainer_alarm" role="alert" aria-live="polite" aria-relevant="all">	
													<!-- <tr>
														<td>1</td>
														<td>1</td>
														<td>1</td>
														<td onclick="$('#fakeMapModal').click()">点击弹出地图</td>
													</tr> -->																		
												</tbody>
											</table>
										</div>
									</div>
									<!-- 数据表格结束 --
									<!-- 数据条数提示开始 -->
									<div class="row">
										<div class="col-sm-12">
											<div class="pull-left">
												<div id="datatable_info_alarm" class="dataTables_info">
													当前显示0 条总记录中的第0-0条
												</div>
											</div>
											<div class="clearfix"></div>
										</div>
									</div>
									<!-- 数据条数提示结束 -->
									<input type="hidden" id="fakeMapModal" class="md-trigger" data-modal="fakeMap">
								    <!-- 分页条开始 -->
									<div class="row">
										<div class="col-sm-4">
											<div class="dataTables_length" id="">
												<label style="margin-top:18px;">每页 <select id="pageSizeSelector_alarm"   size="1"  onchange="query_alarm()"><option selected="selected" value="10">10</option><option value="25">25</option><option value="50">50</option><option value="100">100</option></select> 条</label>
											</div>
										</div>
										<div class="col-sm-8">
											<div class="pull-right">
												<div class="dataTables_paginate paging_bs_normal">
													<ul id="paginationArea_alarm" class="pagination">
													<li class="prev disabled"><a href="#"><span class="fa fa-angle-left"></span>&nbsp;上一页</a></li>
													<li class="active"><a href="#">1</a></li>
													<li class="next"><a href="#">下一页&nbsp;<span class="fa fa-angle-right"></span></a></li></ul>
												</div>
											</div>
										</div>
									</div>
	</div>
	</div>

	</div> 
	
</div> <!-- 主页面结束 -->

    <!-- 模态框开始-->
               
                
				 <div class="md-overlay"></div>


	<script src="js/jquery.js"></script>
	<script type="text/javascript" src="js/jquery.nanoscroller/jquery.nanoscroller.js"></script>
	<script type="text/javascript" src="js/jquery.sparkline/jquery.sparkline.min.js"></script>
	<script type="text/javascript" src="js/jquery.easypiechart/jquery.easy-pie-chart.js"></script>
  <script src="js/jquery.ui/jquery-ui.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/jquery.nestable/jquery.nestable.js"></script>
	<script type="text/javascript" src="js/bootstrap.switch/bootstrap-switch.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
	<script src="js/jquery.select2/select2.min.js" type="text/javascript"></script>
	<script src="js/bootstrap.slider/js/bootstrap-slider.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/jquery.gritter/js/jquery.gritter.js"></script>
  <script type="text/javascript" src="js/jquery.niftymodals/js/jquery.modalEffects.js"></script>   
  <script type="text/javascript" src="js/masonry.js"></script>
  <script type="text/javascript" src="js/jquery.crop/js/jquery.Jcrop.js"></script>

  <!-- The Iframe Transport is required for browsers without support for XHR file uploads -->
  <script src="js/jquery.upload/js/jquery.iframe-transport.js"></script>
  <!-- The basic File Upload plugin -->
  <script src="js/jquery.upload/js/jquery.fileupload.js"></script>
	<script type="text/javascript" src="js/behaviour/general.js"></script>
	<script type="text/javascript" src="js/jquery.icheck/icheck.min.js"></script>


    <script type="text/javascript">
    //根据排序规则重新查询
	function queryBySort(par,column){
		var classFlag = listSortClickEvent(par);
		var type = judgmentChinese(column);
		if(type != null && type != ""){
			classFlag = type + classFlag;
			column = column.substr(8,column.length);
		}
		$("#sortType").val(classFlag);
		$("#sortColumn").val(column);
		go2page_alarm(currentshownpage_alarm);
	}

	$(document).ready(function(){	
		query_alarm();
		updateAlarm();
		
    	App.init();
    	$(".md-trigger").modalEffects();
    	$(".deleteThisTime").click(function(){               //清除日期框中的值
    	       $(this).parent().prev()[0].value = "";
    	});     
	});

var currentshownpage_alarm = 1;
//查询设备报警历史数据
function query_alarm() {
	go2page_alarm(1);
}
function go2page_alarm(pagenumber){
	var pagesize = $("#pageSizeSelector_alarm option:selected").val();
	var olderId_hide = $("#olderId_hide").val();
	var dev_bianhao = $("#dev_bianhao").val();
	
	var list_alarmType = $("#list_alarmType").val();
	var list_alarmtTimeStart = $("#list_alarmtTimeStart").val();
	var list_alarmtTimeEnd = $("#list_alarmtTimeEnd").val();

	var reqmsg="{'action':'QUERY_DEV_ALARM_LIST_REQUEST',";
	
	var sortType = $("#sortType").val();
	var sortColumn = $("#sortColumn").val();
	if(sortType != null && sortType != ""){
		reqmsg += "'order':[{'column':'" + sortColumn + "','type':'" + sortType + "'}],";
	}
	
	reqmsg += "'page':{'pageno':'" + pagenumber + "','pagesize':'" + pagesize + "'},'content':{\"olderShow\":\"true\",\"devShow\":\"true\",";
	
	if (olderId_hide != null && olderId_hide != "" && olderId_hide != "0") {
		reqmsg += "\"olderId\":" + olderId_hide + ",";
	}
	if (dev_bianhao != null && dev_bianhao != "") {
		reqmsg += "\"devCode\":\"" + dev_bianhao + "\",";
	}
	if (list_alarmType != null && list_alarmType != "") {
		reqmsg += "\"alarmType_in\":\"" + list_alarmType + "\",";
	}
	if (list_alarmtTimeStart != null && list_alarmtTimeStart != "") {
	    list_alarmtTimeStart = list_alarmtTimeStart.substring(0, 4) + list_alarmtTimeStart.substring(5, 7) + list_alarmtTimeStart.substring(8, 10) + "000001";
		reqmsg += "\"alarmTime_ge\":\"" + list_alarmtTimeStart + "\",";
	}
	if (list_alarmtTimeEnd != null && list_alarmtTimeEnd != "") {
	    list_alarmtTimeEnd = list_alarmtTimeEnd.substring(0, 4) + list_alarmtTimeEnd.substring(5, 7) + list_alarmtTimeEnd.substring(8, 10) + "235959";
		reqmsg += "\"alarmTime_le\":\"" + list_alarmtTimeEnd + "\",";
	}
	if(list_alarmtTimeStart != null && list_alarmtTimeStart != "" && list_alarmtTimeEnd != null && list_alarmtTimeEnd != ""){
		if(list_alarmtTimeStart > list_alarmtTimeEnd){
			alert("开始时间不得大于结束时间");
			return;
		}
	}
	
	reqmsg += "}}";

    jQuery.ajax({
          type : "post",
          async:true,
          url : "devAlarm.do?handler",
          dataType : "json",
          data: {
               "reqmsg":reqmsg
          },
          success : function(data){
              if(data.des=="success"){
            	  changeData_alarm(data);
              }else if(data.des=="failure"){
                 alert("查询失败");
              }
          },
          error:function(){
	           alert("error");
          }
     });
}
function changeData_alarm(data){
	var htmlcode = "";
	if (data.content != null) {
		jQuery.each(data.content.devAlarmList, function(i, item) {
			htmlcode += "<tr class=\"gradeA odd\">";	
			if(item.dev != null){
				htmlcode += "<td>" + item.dev.code + "</td>";	
			}else{
				htmlcode += "<td>无</td>";	
			}
		    htmlcode += "<td>" + formateTime(item.alarmTime) + "</td>";	
		    htmlcode += "<td>" + item.olderName + "</td>";	
		    htmlcode += "<td>" + item.alarmContent + "</td>";
		    
		    if(item.address != null && item.address != ""){
		    	htmlcode += "<td onclick=\"bjlsMapTip(" + item.id + ")\"><a href=\"###\">" + item.address + "</a></td>";		
		    }else{
		    	 if(item.posLong != null && item.posLong != ""){
		    	 	htmlcode += "<td onclick=\"bjlsMapTip(" + item.id + ")\"><a href=\"###\">" + item.posLong + " , " + item.posLat + "</a></td>";
		    	 }else{
		    	 	htmlcode += "<td onclick=\"bjlsMapTip(" + item.id + ")\"><a href=\"###\">未知</a></td>";
		    	 }
		    }
		    
			htmlcode += "</tr>";
		});
	}
	$("#datacontainer_alarm").html(htmlcode);
	if (data.page != null) {
		genaratePaginateHtml_alarm(data.page.pageno, data.page.pageCount);
		genarateRecordNumberHtml_alarm(data.page.pageno, data.page.pagesize, data.page.recordCount);
	} else {
		genaratePaginateHtml_alarm(1, 1);
		genarateRecordNumberHtml_alarm(1, 10, 0);
	}
}
/**
 * 生成记录数信息
 * @method genarateRecordNumberHtml_alarm
 * @param {Number} currentpage 当前页
 * @param {Number} pagesize 每页记录条目数
 * @param {Number} totalRecord 总记录数
 */
function genarateRecordNumberHtml_alarm(currentpage, pagesize, totalRecord) {
	var recordInfos = "";
	if (totalRecord > 0) {
	    recordInfos = "当前显示" + totalRecord + "条总记录";
		recordInfos += "中第" + ((currentpage - 1) * pagesize + 1) + "-";
		if (currentpage * pagesize > totalRecord) {
			recordInfos += totalRecord;
		} else {
			recordInfos += currentpage * pagesize;
		}
		recordInfos += "条 ";
	} else {
		recordInfos = "当前显示0 条总记录中的第0-0条";
	}
	
	$("#datatable_info_alarm").html(recordInfos);
}

/**
 * 生成分页信息
 * @method genaratePaginateHtml_alarm
 * @param {Number} currentpage 当前页
 * @param {Number} totalpage 总页数
 */
function genaratePaginateHtml_alarm(currentpage, totalpage, pagesize) {
	currentshownpage_alarm = currentpage;

	var htmlcode = "";
	
	//上一页
	if (currentpage > 1) {
		htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page_alarm('1')\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
		htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page_alarm('" + (currentpage - 1) + "')\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
	} else {
		htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
		htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
	}
	
	//具体页码
	if (totalpage <= 5) {
		for (var i = 1; i <= totalpage; i++) {
			if (currentpage == i) {
				htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
			} else {
				htmlcode += "<li><a href=\"#\" onclick=\"go2page_alarm('" + i + "')\">" + i + "</a></li>";
			}
		}
	} else {
		var startpage = currentpage;
		var endpage = currentpage;
		while (true) {
			if (endpage - startpage >= 4) {
				break;
			} else {
				if (startpage > 1) {
					startpage = startpage - 1;
				}
				if (endpage < totalpage) {
					endpage = endpage - (-1);
				}
			}
		}
		
		for (var i = startpage; i <= endpage; i++) {
			if (currentpage == i) {
				htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
			} else {
				htmlcode += "<li><a href=\"#\" onclick=\"go2page_alarm('" + i + "')\">" + i + "</a></li>";
			}
		}
	}
	
	//下一页
	if (totalpage > currentpage) {
		htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page_alarm('" + (parseInt(currentpage) + 1) + "')\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
		htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page_alarm('" + parseInt(totalpage) + "')\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
	} else {
		htmlcode += "<li class=\"next disabled\"><a href=\"#\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
		htmlcode += "<li class=\"next disabled\"><a href=\"#\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
	}
	$("#paginationArea_alarm").html(htmlcode);
}


//实时获取老人姓名
function getolderName(){
	var reqmsg="{'action':'QUERY_OLDER_LIST_REQUEST','page':{'pageno':'1','pagesize':'5'},'content':{";
	var name = $.trim($("#oldinput_search").val());
	if (name != null && name != "") {
		reqmsg += "\"name_like\":\"" + name + "\"";
	}else{
		$("#hideul_nei1").html("");
		$("#hideul-1").hide();
		return;
	}
	reqmsg += "}}";

    jQuery.ajax({
          type : "post",
          async:false,
          url : "older.do?handler",
          dataType : "json",
          data: {
               "reqmsg":reqmsg
          },
          success : function(data){
              if(data.des=="success"){
              	  var htmlcode = "";
              	  if(data.content != null){
              	  	 if(data.content.olderList != null){
            	  		jQuery.each(data.content.olderList, function(i, item) {
            	  				if(item != null){
		    						htmlcode += "<li onclick=\"olderNamefuzhi('" + item.name + "'," + item.id + ")\">" + item.name + "</li>";		
            	  				}	
		    	  		});
		    	 	 }
		    	  }
		    	  $("#hideul_nei1").html(htmlcode);
		    	  $("#hideul-1").show();
              }else if(data.des=="failure"){
                 alert("查询失败");
              }
          },
          error:function(){
	           alert("error");
          }
     });
}
//老人姓名赋值
function olderNamefuzhi(name,olderId_hide){
	$("#oldinput_search").val(name);
	$("#olderId_hide").val(olderId_hide);
	$("#hideul_nei1").html("");
	$("#hideul-1").hide();
}

/**
 * 格式化时间
 * @method formateTime
 * @param {String} time 时间信息(YYYYMMDDHHmmSS)
 * @return 格式化的时间(YYYY-MM-DD HH:mm:SS)
 */
function formateTime(time) {
	if (time != null && time.length == 8) {
		return time.substring(0, 4) + "-" + time.substring(4, 6) + "-" + time.substring(6, 8);
	} else if(time != null && time.length == 14){
		return time.substring(0, 4) + "-" + time.substring(4, 6) + "-" + time.substring(6, 8) + " " + time.substring(8, 10) + ":" + time.substring(10, 12) + ":" + time.substring(12, 14);
	} else {
		return time;
	}
}

//更新报警信息状态,将0(有弹窗)改为99
function updateAlarm(){
	jQuery.ajax({
          type : "post",
          async:false,
          url : "devAlarm.do?handleupdateAlarmStatus",
          dataType : "json",
          data: {
               "state":99
          },
          success : function(data){
              if(data.result=="success"){
              	//alert("更新报警信息状态成功");
              }else if(data.result=="failure"){
                 alert("更新报警信息状态失败");
              }else{
              	alert(data.des);
              }
          },
          error:function(){
	           alert("error");
          }
     });
}
    </script>
    



  <script src="js/behaviour/voice-commands.js"></script>
  <script src="js/bootstrap/dist/js/bootstrap.min.js"></script>
<script type="text/javascript" src="js/jquery.flot/jquery.flot.js"></script>
<script type="text/javascript" src="js/jquery.flot/jquery.flot.pie.js"></script>
<script type="text/javascript" src="js/jquery.flot/jquery.flot.resize.js"></script>
<script type="text/javascript" src="js/jquery.flot/jquery.flot.labels.js"></script>
<script type="text/javascript" src="js/jquery.form.js"></script>
</body>
</html>
