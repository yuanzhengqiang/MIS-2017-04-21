<%@ page contentType="text/html;charset=UTF-8" language="java"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ page import="fsk.init.SystemInit"%>
<%
	String nickname = (String) session.getAttribute("nickname");
	if (nickname == null) {
		nickname = "";
	}
	String header = SystemInit.header;
	String headerImage = SystemInit.headerImage;
%>
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<link rel="shortcut icon" href="images/logo.png">

<title>编辑站点</title>

<!-- Bootstrap core CSS -->
<link href="js/bootstrap/dist/css/bootstrap.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="js/jquery.gritter/css/jquery.gritter.css" />

<link rel="stylesheet" href="fonts/font-awesome-4/css/font-awesome.min.css">

<link rel="stylesheet" type="text/css" href="js/jquery.nanoscroller/nanoscroller.css" />
<link rel="stylesheet" type="text/css" href="js/jquery.easypiechart/jquery.easy-pie-chart.css" />
<link rel="stylesheet" type="text/css" href="js/bootstrap.switch/bootstrap-switch.css" />
<link rel="stylesheet" type="text/css" href="js/bootstrap.datetimepicker/css/bootstrap-datetimepicker.min.css" />
<link rel="stylesheet" type="text/css" href="js/jquery.select2/select2.css" />
<link rel="stylesheet" type="text/css" href="js/bootstrap.slider/css/slider.css" />
<link rel="stylesheet" type="text/css" href="js/jquery.niftymodals/css/component.css" />
<link href="js/jquery.icheck/skins/square/blue.css" rel="stylesheet">

<link rel="stylesheet" href="js/jquery.crop/css/jquery.Jcrop.css" type="text/css" />
<link href="css/style.css" rel="stylesheet" />
<link rel="stylesheet" type="text/css" href="js/jquery.datatables/bootstrap-adapter/css/datatables.css" />
<script type="text/javascript" src="js/sortListTool.js"></script>
<style>
.accordion .panel,.accordion .panel:first-child {
	border-top: 1px solid #ECECEC;
	border-bottom: 1px solid #ECECEC;
}

.checkbox-inline {
	padding-left: 0;
	padding-right: 30px;
}

.checkbox-inline+.checkbox-inline {
	margin-left: 0;
}

.hideAndShow {
	display: none;
}

.hideul {
	position: absolute;
	top: 33px;
	z-index: 200;
	right: 15px;
	left: 15px;
	display: none
}

.hideul ul {
	border: 1px solid #ccc;
	width: 100%;
	background: #f4f4f4;
	padding-left: 0
}

.hideul ul li {
	list-style-type: none;
	text-indent: 20px
}

.hideul ul li:hover {
	background: #ddd
}
</style>
<script type="text/javascript" src="js/addressJS.js"></script>
</head>

<body>
	<!-- 上侧栏开始 -->
	<div id="head-nav" class="navbar navbar-default navbar-fixed-top">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
					<span class="fa fa-gear"></span>
				</button>
				<a class="navbar-brand" href="#" style="width:auto;background: url(images/<%=headerImage%>) no-repeat 0 10px;"><span><%=header%>/编辑站点</span>
				</a>
			</div>
			<div class="navbar-collapse collapse">
				<ul class="nav navbar-nav navbar-right user-nav">
					<li class="dropdown profile_menu"><a href="#" class="dropdown-toggle" data-toggle="dropdown"> <img src="images/avatar2.jpg" /> <span id="accountNickname"><%=nickname%></span></a></li>
				</ul>
			</div>
			<!--/.nav-collapse animate-collapse -->
		</div>
	</div>
	<!-- 上侧栏结束 -->

	<div id="cl-wrapper" style="padding-top:40px">
		<div class="container-fluid" id="pcont">
			<div class="cl-mcont">
				<div class="row">
					<div class="col-sm-12">
						<div class="block-flat profile-info">
							<div class="row">
								<div class="col-sm-2">
									<div class="avatar">
										<img src="photos/zhandian.png" id="touxiangId" class="profile-avatar" /> <input type="hidden" id="hide_siteTupian" value="" />
									</div>
								</div>
								<div class="col-sm-7">
									<div class="personal">
										<h1 class="name" style="font-size:24px;" id="zhandian_head">未知</h1>
										<p class="description" style="line-height:13px" id="jutidizhi_head">未知
										<p>
										<p class="description" style="line-height:13px;" id="jutidizhi_fuwu_head">未知
										<p>
										<p class="description" style="line-height:13px" id="name_tele_head">未知
										<p>
										<form style="display:none;" id="picuploadform" class="secondcol" action="position.do?pic1" method="post" enctype="multipart/form-data">
											<input id="pic4upload" name="pic4upload" type="file" onchange="javascript:$('#quedintupian').click()" accept="image/*">
										</form>
										<form style="display:none;" id="image_submit" action="position.do?pic2" method="post" enctype="multipart/form-data">
											<input type="hidden" name="srcPath" id="srcPath" value="" /> 
											<input type="hidden" name="type" id="type" value="sitePhoto_" /> 
											<input type="hidden" name="x1" id="x1" value="0" /> 
											<input type="hidden" name="y1" id="y1" value="0" /> 
											<input type="hidden" name="x2" id="x2" value="0" /> 
											<input type="hidden" name="y2" id="y2" value="0" />
										</form>
										<button type="button" class="btn btn-primary btn-flat" style="display:none;" id="sure_SC" onclick="uploadPic_cut()">确定</button>
										<c:if test="${site_xghead_btn_control != 'yes' or site_xghead_btn_show == 'yes'}">
											<button class="btn btn-primary btn-flat btn-rad" onclick="javascript:$('#pic4upload').click()">修改头像</button>
										</c:if>
										<input id="quedintupian" style="display:none;" type="button" value="确定" onclick="uploadPic()">
										<c:if test="${site_addemploy_btn_control != 'yes' or site_addemploy_btn_show == 'yes'}">
											<button class="btn btn-primary btn-flat btn-rad md-trigger" onclick="headAdd()" data-modal="guanlian-yuangong">增加员工</button>
										</c:if>
									</div>
								</div>
								<div class="col-sm-3">
									<table class="no-border no-strip skills">
										<tbody class="no-border-x no-border-y">
											<tr>
												<td style="width:50%;color:#666">服务次数</td>
												<!-- 4个相关展示信息 -->
												<td style="color:#999">88888</td>
											</tr>
											<tr>
												<td style="color:#666">综合服务评价</td>
												<td style="color:#999"><i class="fa fa-star" style="width:15px;"></i><i class="fa fa-star" style="width:15px;"></i><i class="fa fa-star" style="width:15px;"></i><i class="fa fa-star" style="width:15px;"></i><i class="fa fa-star-half-empty " style="width:15px;"></i>
												</td>
											</tr>
											<tr>
												<td style="color:#666">员工数量</td>
												<td style="color:#999" id="ygNum"></td>
											</tr>
											<tr>
												<td style="color:#666">老人数量</td>
												<td style="color:#999" id="oldNum"></td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="row" style="margin-top:0">
					<div class="col-sm-12">
						<div class="tab-container">
							<ul class="nav nav-tabs">
								<li class="active"><a data-toggle="tab" href="#siteBasicInfo">基本信息</a>
								</li>
								<li><a data-toggle="tab" href="#siteEmployees">所辖员工</a>
								</li>
								<li onclick="query3()"><a data-toggle="tab" href="#siteOlders">所辖会员</a>
								</li>
								<li><a data-toggle="tab" href="#siteHistoryServer">历史服务</a>
								</li>
							</ul>
							<div class="tab-content">
								<!-- 基本信息开始 -->
								<div id="siteBasicInfo" class="tab-pane  cont active">
									<div class="panel-group accordion accordion-semi" id="accordion1-1" style="margin-top:20px;">
										<div class="panel panel-default">
											<div class="panel-heading">
												<h4 class="panel-title">
													<a data-toggle="collapse" data-parent="#accordion1-1" href="#ac1-1"> <i class="fa fa-angle-right"></i>基本信息 </a>
												</h4>
											</div>
											<div id="ac1-1" class="panel-collapse collapse in">
												<div class="panel-body">
													<form class="form-horizontal">
														<div class="form-group">
															<label class="col-sm-2 control-label">名称<span style="color:red">*</span>
															</label>
															<div class="col-sm-4">
																<input type="text" class="form-control" id="name_input" readonly="readonly" tag="hedangdang"> <input type="hidden" id="name_input_hide">
															</div>
															<input id="zhanzhang_modalId" class="btn btn-primary btn-flat btn-rad md-trigger" type="hidden" data-modal="zhanzhang_modal" value="站长"> <label class="col-sm-2 control-label">站长</label>
															<div class="col-sm-4">
																<input type="text" class="form-control" id="zhanzhang_input" readonly="readonly" tag="hedangdang" onclick="javascript:return false;"> <input type="hidden" id="zhanzhangId_input">
															</div>
														</div>
														<div class="form-group">
															<label class="col-sm-2 control-label">联系人<span style="color:red">*</span></span>
															</label>
															<div class="col-sm-4">
																<input type="text" class="form-control" id="lianxiren_input" readonly="readonly" tag="hedangdang"> <input type="hidden" id="lianxiren_input_hide">
															</div>
															<label class="col-sm-2 control-label">联系电话<span style="color:red">*</span>
															</label>
															<div class="col-sm-4">
																<input type="text" class="form-control" id="lianxidianhua_input" readonly="readonly" tag="hedangdang"> <input type="hidden" id="lianxidianhua_input_hide">
															</div>
														</div>
														<div class="form-group">
															<label class="col-sm-2 control-label">站点类别<span style="color:red">*</span></span>
															</label>
															<div class="col-sm-4">
																<select class="form-control" id="siteleibie_input" disabled="disabled" tag="hedangdang">
																	<option value="医疗护理站 ">医疗护理站</option>
																	<option value="照护站">照护站</option>
																	<option value="日间照料中心">日间照料中心</option>
																	<option value="长者照护之家">长者照护之家</option>
																	<option value="养老院">养老院</option>
																	<option value="其他">其他</option>
																</select>
															</div>
														</div>
														<div class="form-group">
															<label class="col-sm-2 control-label">地址（省）<span style="color:red">*</span>
															</label>
															<div class="col-sm-4">
																<select class="form-control" id="quyushen_input" disabled="disabled" tag="hedangdang">

																</select> <input type="hidden" id="quyushen_input_hide">
															</div>
															<label class="col-sm-2 control-label">地址（市）<span style="color:red">*</span>
															</label>
															<div class="col-sm-4">
																<select class="form-control" id="quyushi_input" disabled="disabled" tag="hedangdang">
																</select> <input type="hidden" id="quyushi_input_hide">
															</div>
														</div>
														<div class="form-group">
															<label class="col-sm-2 control-label">地址（区）<span style="color:red">*</span>
															</label>
															<div class="col-sm-4">
																<select class="form-control" id="quyuqu_input" disabled="disabled" tag="hedangdang">
																</select> <input type="hidden" id="quyuqu_input_hide">
															</div>
															<label class="col-sm-2 control-label">地址（街道）<span style="color:red">*</span>
															</label>
															<div class="col-sm-4">
																<select class="form-control" id="quyujiedao_input" disabled="disabled" tag="hedangdang">
																</select> <input type="hidden" id="quyujiedao_input_hide">
															</div>
														</div>
														<div class="form-group">
															<label class="col-sm-2 control-label">地址（具体地址）<span style="color:red">*</span>
															</label>
															<div class="col-sm-10">
																<input type="text" class="form-control" id="jutidizhi" readonly="readonly" tag="hedangdang"> <input type="hidden" id="jutidizhi_hide">
															</div>
														</div>

													</form>
												</div>
											</div>
										</div>
									</div>
									<div class="panel-group accordion accordion-semi" id="accordion1-2">
										<div class="panel panel-default">
											<div class="panel-heading">
												<h4 class="panel-title">
													<a class="" data-toggle="collapse" data-parent="#accordion1-2" href="#ac1-2"> <i class="fa fa-angle-right"></i>服务信息 </a>
												</h4>
											</div>
											<div id="ac1-2" class="panel-collapse collapse in">
												<div class="panel-body">
													<div class="table-responsive">
														<table class="table no-border hover">
															<thead class="no-border">
																<tr>
																	<th style="width:20%;"><strong>服务区域（省）</strong>
																	</th>
																	<th style="width:20%;"><strong>服务区域（市）</strong>
																	</th>
																	<th style="width:20%;"><strong>服务区域（区）</strong>
																	</th>
																	<th style="width:30%;"><strong>服务区域（街道）</strong>
																	</th>
																	<th style="display:none;" tag="hedangdang"><strong>操作</strong>
																	</th>
																</tr>
															</thead>
															<a class="label label-primary md-trigger" data-modal="add-address" id="adddzxx" style="display:none;"><i class="fa fa-plus"></i>
															</a>
															<a class="label label-primary md-trigger" data-modal="add-addressBJ" id="editdzxx" style="display:none;"><i class="fa fa-pencil"></i>
															</a>
															<a class="label label-danger" id="deldzxx" style="display:none;"><i class="fa fa-times"></i>
															</a>
															<tbody class="no-border-y" id="addressMessge">
																<tr id="addressMessge_add">
																	<td></td>
																	<td></td>
																	<td></td>
																	<td></td>
																	<td style="display:none;" tag="hedangdang"><a class="label label-primary md-trigger" data-modal="add-address" onclick="dizhixinxi()"><i class="fa fa-plus"></i>
																	</a></td>
																</tr>
															</tbody>
														</table>
													</div>

												</div>
											</div>
										</div>
									</div>
									<input type="hidden" value="保存全部二次确定假按钮" class="md-trigger" data-modal="saveAllBasicHeal" id="fake-saveAllBasicHeal">
									<div class="row">
										<div class="col-sm-12" style="text-align:center;" id="hedangdang1">
											<button class="btn btn-flat btn-rad  btn-primary" onclick="able2edit()">编辑信息</button>
										</div>
									</div>
								</div>
								<!-- 基本信息结束 -->
								
								<!-- 所辖员工开始 -->
								<div id="siteEmployees" class="tab-pane ">
									<input type="hidden" value="" id="sortType"> <input type="hidden" value="" id="sortColumn">
									<div class="block-flats">
										<div class="content">
											<div class="row" style="margin-bottom: 15px;">
												<div class="col-sm-1">
													<c:if test="${site_queryemploy_btn_control != 'yes' or site_queryemploy_btn_show == 'yes'}">
														<button class="btn btn-primary " onclick="query2();">查询</button>
													</c:if>
												</div>
												<div class="col-sm-2">
													<a style="cursor:pointer;text-decoration:underline;vertical-align:bottom;" onclick="$('.hideAndShow').toggle();">更多查询条件</a>
												</div>
												<div class="col-sm-1" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>姓名</label>
												</div>
												<div class="col-sm-2" style="margin-bottom:10px;">
													<input class="form-control" type="text" style="width: 100%" id="name_input2">
												</div>
												<div class="col-sm-1   hideAndShow" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>角色</label>
												</div>
												<div class="col-sm-2   hideAndShow" style="margin-bottom:10px;">
													<select id="juese_input2" class="select2" multiple>
													</select>
												</div>
												<div class="col-sm-1   hideAndShow" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>职称名称</label>
												</div>
												<div class="col-sm-2   hideAndShow" style="margin-bottom:10px;">
													<select class="form-control" id="zhicheng1_input" style="width: 100%">
													</select>
												</div>
												<div class="col-sm-1   hideAndShow" style="text-align: right; vertical-align: middle; height: 34px; line-height: 34px;">
													<label>职称等级</label>
												</div>
												<div class="col-sm-2   hideAndShow" style="margin-bottom:10px;">
													<select class="form-control" id="zhicheng2_input" style="width: 100%">
													</select>
												</div>
											</div>
											<div class="row">
												<div class="col-sm-12">
													<c:if test="${site_delemployee_btn_control != 'yes' or site_delemployee_btn_show == 'yes'}">
														<button type="button" class="btn btn-danger btn-flat" style="float: right; margin-right: 0px;" onclick="doDel2()">
															<span><i class="fa fa-trash-o" style="margin-right:0px;"></i>删除</span>
														</button>
													</c:if>
													<c:if test="${site_addemployee_btn_control != 'yes' or site_addemployee_btn_show == 'yes'}">
														<button type="button" class="btn btn-primary btn-flat md-trigger" data-modal="guanlian-yuangong" style="float: right;" onclick="headAdd()">
															<span><i class="fa fa-plus" style="margin-right:5px;"></i>新增</span>
														</button>
													</c:if>
												</div>
											</div>
											<div class="table-responsive">
												<table class="table table-bordered hover">
													<thead>
														<tr>
															<th style="width:2%;"><input type="checkbox" class="col_selector" id="allselectchecker2" onclick="selectAll2()">
															</th>
															<th name="needSort" class="sorting" onclick="queryBySort(this,'chinese_name')">姓名</th>
															<th>角色</th>
															<th>职称</th>
															<th name="needSort" class="sorting" onclick="queryBySort(this,'starLevel')">星级</th>
															<th>操作</th>
														</tr>
													</thead>
													<tbody id="datacontainer2" role="alert" aria-live="polite" aria-relevant="all">
													</tbody>
												</table>
											</div>
											<div class="row" style="margin-right: 0px;">
												<div class="col-sm-12">
													<div id="datatable_info2" class="dataTables_info">当前显示0 条总记录中的第0-0条</div>
													<!-- 分页条开始 -->
													<div class="row">
														<div class="col-sm-4">
															<div class="pull-left" style="margin:10px 0" id="datatable2_length">
																<label class="pull-left" style="margin:10px 0;">每页</label> <label class="pull-left" style="margin:10px 0;"> <select id="pageSizeSelector2" class="form-control" aria-controls="datatable2" size="1" name="datatable2_length" onchange="query2()">
																		<option selected="selected" value="10">10</option>
																		<option value="25">25</option>
																		<option value="50">50</option>
																		<option value="100">100</option>
																</select> </label> <label class="pull-left" style="margin:10px 0;">条</label>
															</div>
														</div>
														<div class="col-sm-8">
															<div class="pull-right">
																<div class="dataTables_paginate paging_bs_normal">
																	<ul id="paginationArea2" class="pagination">
																		<li class="prev disabled"><a href="#"><span class="fa fa-angle-left"></span>&nbsp;上一页</a>
																		</li>
																		<li class="active"><a href="#">1</a>
																		</li>
																		<li class="next"><a href="#">下一页&nbsp;<span class="fa fa-angle-right"></span>
																		</a>
																		</li>
																	</ul>
																</div>
															</div>
														</div>
													</div>
													<!-- 分页条结束 -->
													<div class="clearfix"></div>
												</div>
											</div>
										</div>
									</div>
								</div>
								<!-- 所辖员工结束 -->
								
								<!-- 所辖会员开始 -->
								<div id="siteOlders" class="tab-pane">
									<input type="hidden" value="" id="sortType3"> <input type="hidden" value="" id="sortColumn3">
									<div class="block-flats">
										<div class="content">
											<div class="row" style="margin-bottom: 15px;">
												<div class="col-sm-12">
													<c:if test="${site_queryolder_btn_control != 'yes' or site_queryolder_btn_show == 'yes'}">
														<button class="btn btn-primary" style="margin-bottom: 0px !important; height: 34px;" onclick="query3();">查询</button>
													</c:if>
												</div>
												<div class="col-sm-11" style=" vertical-align: middle; height: 34px; line-height: 34px;margin-bottom:5px;">
													<a style="cursor:pointer;text-decoration:underline;" onclick="$(this).parent().siblings('.hideAndShow').toggle();">更多查询条件</a>
												</div>
												<div class="col-sm-1" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>姓名</label>
												</div>
												<div class="col-sm-2" style="margin-bottom:10px;">
													<input class="form-control" type="text" style="width: 100%" id="name_input3">
												</div>
												<div class="col-sm-1" style="text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>会员号</label>
												</div>
												<div class="col-sm-2" style="margin-bottom:10px;">
													<input class="form-control" type="text" style="width: 100%" id="idNumber3">
												</div>
												<div class="col-sm-1   hideAndShow" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>性别</label>
												</div>
												<div class="col-sm-2   hideAndShow" style="margin-bottom:10px;">
													<select class="form-control" type="text" id="sex3" style="width: 100%">
														<option value="">全部</option>
														<option value="男">男</option>
														<option value="女">女</option>
													</select>
												</div>
												<div class="col-sm-1   hideAndShow" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>年龄</label>
												</div>
												<div class="col-sm-2   hideAndShow" style="margin-bottom:10px;">
													<input class="form-control" type="text" style="width: 100%" id="age13">
												</div>
												<div class="col-sm-1   hideAndShow" style="text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>到</label>
												</div>
												<div class="col-sm-2   hideAndShow" style="margin-bottom:10px;">
													<input class="form-control" type="text" style="width: 100%" id="age23">
												</div>
												<div class="col-sm-1   hideAndShow" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>客户来源</label>
												</div>
												<div class="col-sm-2   hideAndShow" style="margin-bottom:10px;">
													<select class="form-control" type="text" id="customerSource3" style="width: 100%">
														<option value="">全部</option>
														<option value="医保">医保</option>
														<option value="政府采购">政府采购</option>
														<option value="商业">商业</option>
														<option value="其他">其他</option>
													</select>
												</div>
												<div class="col-sm-1   hideAndShow" style="text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
													<label>客户状态</label>
												</div>
												<div class="col-sm-2   hideAndShow" style="margin-bottom:10px;">
													<select class="form-control" type="text" style="width: 100%" id="customerState3">
														<option value="">全部</option>
														<option value="0">正常</option>
														<option value="1">审核不通过</option>
														<option value="2">待评估</option>
													</select>
												</div>

											</div>

											<div class="row">
												<div class="col-sm-12">
													<c:if test="${site_delOlder_btn_control != 'yes' or site_delOlder_btn_show == 'yes'}">
														<button type="button" class="btn btn-danger btn-flat" style="float: right; margin-right: 0px;" onclick="deleteOldMan()">
															<span><i class="fa fa-trash-o" style="margin-right:0px;"></i>删除</span>
														</button>
													</c:if>
													<c:if test="${site_addOlder_btn_control != 'yes' or site_addOlder_btn_show == 'yes'}">
														<button type="button" class="btn btn-primary btn-flat md-trigger" data-modal="guanlian-OldMan" style="float: right;" onclick="addOldMan()">
															<span><i class="fa fa-plus" style="margin-right:5px;"></i>新增</span>
														</button>
													</c:if>
												</div>
											</div>

											<div class="table-responsive">

												<table class="table table-bordered hover">
													<thead>
														<tr>
															<th style="width:2%;"><input type="checkbox" class="col_selector3" id="allselectchecker3" onclick="selectAll3()">
															</th>
															<th name="needSort" class="sorting" onclick="queryBySort3(this,'memberNum')">会员号</th>
															<th name="needSort" class="sorting" onclick="queryBySort3(this,'chinese_name')">姓名</th>
															<th name="needSort" class="sorting" onclick="queryBySort3(this,'chinese_gender')">性别</th>
															<th name="needSort" class="sorting" onclick="queryBySort3(this,'birthdate')">年龄</th>
															<th name="needSort" class="sorting" onclick="queryBySort3(this,'chinese_memberSource')">客户来源</th>
															<th name="needSort" class="sorting" onclick="queryBySort3(this,'memberStatus')">客户状态</th>
															<th name="needSort" class="sorting" onclick="queryBySort3(this,'mobileTel')">联系方式</th>
															<th>操作</th>
														</tr>
													</thead>
													<tbody id="datacontainer3" role="alert" aria-live="polite" aria-relevant="all">
													</tbody>
												</table>
											</div>

											<div class="row" style="margin-right: 0px;">
												<div class="col-sm-12">
													<div class="pull-left" id="datatable_info3">当前显示0 条总记录中的第0-0条</div>
													<!-- 分页条开始 -->
													<div class="row">
														<div class="col-sm-4" style="clear:both;">
															<div class="pull-left" style="margin:10px 0" id="datatable2_length">
																<label class="pull-left" style="margin:10px 0;">每页</label> <label class="pull-left" style="margin:10px 0;"> <select id="pageSizeSelector3" class="form-control" aria-controls="datatable2" size="1" name="datatable2_length" onchange="query3()">
																		<option selected="selected" value="10">10</option>
																		<option value="25">25</option>
																		<option value="50">50</option>
																		<option value="100">100</option>
																</select> </label> <label class="pull-left" style="margin:10px 0;">条</label>
															</div>
														</div>
														<div class="col-sm-8">
															<div class="pull-right">
																<div class="dataTables_paginate paging_bs_normal">
																	<ul id="paginationArea3" class="pagination">
																		<li class="prev disabled"><a href="#"><span class="fa fa-angle-left"></span>&nbsp;上一页</a>
																		</li>
																		<li class="active"><a href="#">1</a>
																		</li>
																		<li class="next"><a href="#">下一页&nbsp;<span class="fa fa-angle-right"></span>
																		</a>
																		</li>
																	</ul>
																</div>
															</div>
														</div>
													</div>
													<!-- 分页条结束 -->
												</div>
											</div>
										</div>
									</div>
								</div>
								<!-- 所辖会员结束 -->
								
								<!-- 历史服务开始 -->
								<div id="siteHistoryServer" class="tab-pane">
									<input type="hidden" id="addUserName" value=""> <input type="hidden" id="addUserSites" value=""> <input type="hidden" value="" id="sortType5"> <input type="hidden" value="" id="sortColumn5">
									<div class="row">
										<div class="col-sm-2" style=" vertical-align: middle; height: 34px; line-height: 34px;">
											<label>老人姓名</label>
										</div>
										<div class="col-sm-4 " style="position:relative">
											<div class="input-group ">
												<input class="form-control" type="text" id="oldinput_search" onclick="getolderName()" oninput="getolderName()" onmouseout="javascript:$('#hideul-1').hide();" onmouseover="javascript:$('#hideul-1').show();"> <span class="input-group-btn"><button class="btn btn-primary " type="button">
														<span class="fa fa-search"></span>
													</button>
												</span>
											</div>
											<div class="hideul" id="hideul-1" onmouseover="javascript:$('#hideul-1').show();" onmouseout="javascript:$('#hideul-1').hide();">
												<ul id="hideul_nei1">

												</ul>
											</div>
										</div>
										<div class="col-sm-2 " style=" vertical-align: middle; height: 34px; line-height: 34px;">
											<label>服务项目</label>
										</div>
										<div class="col-sm-4 " style="position:relative">
											<div class="input-group ">
												<input type="hidden" value="" id="fwxminput_Id"> <input class="form-control" type="text" id="fwxminput_search" onclick="getFWXM()" oninput="getFWXM()" onmouseout="javascript:$('#hideul-2').hide();" onmouseover="javascript:$('#hideul-2').show();"> <span class="input-group-btn"><button class="btn btn-primary " type="button">
														<span class="fa fa-search"></span>
													</button>
												</span>
											</div>
											<div class="hideul" id="hideul-2" onmouseover="javascript:$('#hideul-2').show();" onmouseout="javascript:$('#hideul-2').hide();">
												<ul id="hideul_nei2">

												</ul>
											</div>
										</div>
										<div class="col-sm-2" style=" vertical-align: middle; height: 34px; line-height: 34px;">
											<label>工单编号</label>
										</div>
										<div class="col-sm-4" style="margin-bottom:10px;">
											<input class="form-control" type="text" style="width: 100%" id="fuwugdbh_input">
										</div>

										<div class="col-sm-2  col-md-2" style="vertical-align: middle; height: 34px; line-height: 34px;">
											<label>服务状态</label>
										</div>
										<div class="col-sm-4 col-md-4" style="margin-bottom:10px;">
											<select id="fuwustate_input" class="select2" multiple>
												<option value="1">取消</option>
												<option value="2">待排班</option>
												<option value="3">待审核</option>
												<option value="4">审核通过</option>
												<option value="5">服务开始</option>
												<option value="6">服务结束</option>
												<option value="7">回访结束</option>
											</select>
										</div>
										<div class="col-sm-2  col-md-2" style=" vertical-align: middle; height: 34px; line-height: 34px;">
											<label>收费类别</label>
										</div>
										<div class="col-sm-4 col-md-4" style="margin-bottom:10px;">
											<select id="fuwutype_input" class="select2">
												<option value="">全部</option>
												<option value="1">医保</option>
												<option value="2">市场</option>
											</select>
										</div>
										<div class="col-sm-2  col-md-2" style=" vertical-align: middle; height: 34px; line-height: 34px;">
											<label>负责人</label>
										</div>
										<div class="col-sm-4 col-md-4" style="position:relative">
											<div class="input-group ">
												<input type="hidden" value="" id="pgrinputId"> <input class="form-control" type="text" id="pgrinput_search" onclick="getepgrName()" oninput="getepgrName()" onmouseout="javascript:$('#hideul-25').hide();" onmouseover="javascript:$('#hideul-25').show();"> <span class="input-group-btn"><button class="btn btn-primary " type="button">
														<span class="fa fa-search"></span>
													</button>
												</span>
											</div>
											<div class="hideul" id="hideul-25" onmouseover="javascript:$('#hideul-25').show();" onmouseout="javascript:$('#hideul-25').hide();">
												<ul id="hideul_nei25">
												</ul>
											</div>
										</div>
										<!-- 查询框结束 -->
										<!-- 操作按钮开始 -->
										<div class="col-sm-12" style="margin-top:20px">
											<c:if test="${serviceTask_query_btn_control != 'yes' or serviceTask_query_btn_show == 'yes'}">
												<button class="btn btn-primary" style="margin-bottom: 0px !important; height: 34px;margin-left:0;" onclick="query5()">查询</button>
											</c:if>
											<div class="btn-group" style="margin-top:5px;float:right;margin-right:0">
												<c:if test="${serviceTask_add_btn_control != 'yes' or serviceTask_add_btn_show == 'yes'}">
													<button type="button" class="btn btn-primary dropdown-toggle  md-trigger" data-toggle="dropdown" data-modal="servicegongdan_add" onclick="qingkongXZ()">
														<span><i class="fa fa-plus" style="margin-right:5px;"></i>新增</span>
													</button>
												</c:if>
												<c:if test="${serviceTask_del_btn_control != 'yes' or serviceTask_del_btn_show == 'yes'}">
													<button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown" style="margin-left:5px;margin-right:0" onclick="doDel5()">
														<span><i class="fa fa-minus" style="margin-right:5px;"></i>删除</span>
													</button>
												</c:if>
												<c:if test="${serviceTask_qx_btn_control != 'yes' or serviceTask_qx_btn_show == 'yes'}">
													<button type="button" class="btn btn-danger dropdown-toggle  md-trigger" data-toggle="dropdown" style="display:none;" data-modal="servicegongdan_quxiao" id="quxiao_open5"></button>
													<button type="button" class="btn btn-danger dropdown-toggle" data-toggle="dropdown" onclick="quxiao_qingkong()" style="margin-left:5px;margin-right:0">
														<span><i class="fa fa-minus" style="margin-right:5px;"></i>取消</span>
													</button>
												</c:if>
											</div>
										</div>

										<!-- 操作按钮结束 -->
										<!-- 数据表格开始 -->

										<div class="col-sm-12">
											<table class="table table-bordered dataTable hover" id="datatable" aria-describedby="datatable_info">
												<thead>
													<tr role="row">
														<th style="width:2%;"><input id="allselectchecker5" type="checkbox" class="col_selector5" onclick="selectAll5();">
														</th>
														<th name="needSort" class="sorting" onclick="queryBySort5(this,'serviceCode')"><strong>服务工单编号</strong>
														</th>
														<th name="needSort" class="sorting" onclick="queryBySort5(this,'chinese_olderName')"><strong>老人</strong>
														</th>
														<th><strong>服务项目</strong>
														</th>
														<th><strong>负责人</strong>
														</th>
														<th name="needSort" class="sorting" onclick="queryBySort5(this,'status')"><strong>工单状态</strong>
														</th>
														<th name="needSort" class="sorting" onclick="queryBySort5(this,'healthInsurance')"><strong>收费类别</strong>
														</th>
														<th name="needSort" class="sorting" onclick="queryBySort5(this,'serviceStartTime')"><strong>服务时间</strong>
														</th>
														<th><strong>操作</strong>
														</th>
													</tr>
												</thead>
												<tbody id="datacontainer5" role="alert" aria-live="polite" aria-relevant="all">
												</tbody>
											</table>
										</div>
									</div>
									<!-- 数据表格结束 --
									<!-- 数据条数提示开始 -->
									<div class="row">
										<div class="col-sm-12">
											<div class="pull-left">
												<div id="datatable_info5" class="dataTables_info">当前显示0 条总记录中的第0-0条</div>
											</div>
											<div class="clearfix"></div>
										</div>
									</div>
									<!-- 数据条数提示结束 -->
									<!-- 分页条开始 -->
									<div class="row">
										<div class="col-sm-4">
											<div class="dataTables_length" id="">
												<label style="margin-top:18px;">每页 <select id="pageSizeSelector5" size="1" onchange="query5()"><option selected="selected" value="10">10</option>
														<option value="25">25</option>
														<option value="50">50</option>
														<option value="100">100</option>
												</select> 条</label>
											</div>
										</div>
										<div class="col-sm-8">
											<div class="pull-right">
												<div class="dataTables_paginate paging_bs_normal">
													<ul id="paginationArea5" class="pagination">
														<li class="prev disabled"><a href="#"><span class="fa fa-angle-left"></span>&nbsp;上一页</a>
														</li>
														<li class="active"><a href="#">1</a>
														</li>
														<li class="next"><a href="#">下一页&nbsp;<span class="fa fa-angle-right"></span>
														</a>
														</li>
													</ul>
												</div>
											</div>
										</div>
									</div>
									<!-- 分页条结束 -->
								</div>
								<!-- 历史服务结束 -->
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- 主页面结束 -->
	
	<!-- 关联站长-->
	<div class="md-modal colored-header custom-width md-effect-9" id="zhanzhang_modal">
		<div class="md-content">
			<div class="modal-header">
				<h3>关联站长</h3>
				<button type="button" class="close md-close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body " id="erciquerenxinxi1">
				<div class="row">
					<div class="col-sm-1" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
						<label>姓名</label>
					</div>
					<div class="col-sm-2" style="margin-bottom:10px;">
						<input class="form-control" type="text" style="width: 100%" id="name_input_t">
					</div>
					<div class="col-sm-1" style="margin-bottom:5px;">
						<button class="btn btn-primary" style="margin-bottom: 0px !important; height: 34px;" onclick="query_t()">查询</button>
					</div>
				</div>
				<!-- 数据表格开始 -->
				<div class="row">
					<div class="col-sm-12">
						<table class="table table-bordered dataTable hover" id="datatable" aria-describedby="datatable_info">
							<thead>
								<tr role="row">
									<th><strong>选择</strong>
									</th>
									<th><strong>所属站点</strong>
									</th>
									<th><strong>站长</strong>
									</th>
									<th><strong>服务区域</strong>
									</th>
								</tr>
							</thead>
							<tbody id="datacontainer_t" role="alert" aria-live="polite" aria-relevant="all">
							</tbody>
						</table>
					</div>
				</div>
				<!-- 数据表格结束 -->
				<!-- 数据条数提示开始 -->
				<div class="row">
					<div class="col-sm-12">
						<div class="pull-left">
							<div id="datatable_info_t" class="dataTables_info">当前显示0 条总记录中的第0-0条</div>
						</div>
						<div class="clearfix"></div>
					</div>
				</div>
				<!-- 数据条数提示结束 -->
				<!-- 分页条开始 -->
				<div class="row">
					<div class="col-sm-4" style="clear:both;">
						<div class="pull-left" style="margin:10px 0" id="datatable2_length">
							<label class="pull-left" style="margin:10px 0;">每页</label> <label class="pull-left" style="margin:10px 0;"> <select id="pageSizeSelector_t" class="form-control" aria-controls="datatable2" size="1" name="datatable2_length" onchange="query_t()">
									<option selected="selected" value="10">10</option>
									<option value="25">25</option>
									<option value="50">50</option>
									<option value="100">100</option>
							</select> </label> <label class="pull-left" style="margin:10px 0;">条</label>
						</div>
					</div>
					<div class="col-sm-8">
						<div class="pull-right">
							<div class="dataTables_paginate paging_bs_normal">
								<ul id="paginationArea_t" class="pagination">
									<li class="prev disabled"><a href="#"><span class="fa fa-angle-left"></span>&nbsp;上一页</a>
									</li>
									<li class="active"><a href="#">1</a>
									</li>
									<li class="next"><a href="#">下一页&nbsp;<span class="fa fa-angle-right"></span>
									</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
				<!-- 分页条结束 -->
			</div>
			<div class="modal-footer">
				<button type="button" id="glzzquxiao" style="display:none;" class="btn btn-default btn-flat md-close" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>

	<!-- 二次确认：站点 保存全部-->
	<div class="md-modal colored-header custom-width md-effect-9" id="saveAllBasicHeal">
		<div class="md-content">
			<div class="modal-header">
				<h3>信息修改确认</h3>
				<button type="button" class="close md-close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body " id="erciquerenxinxi"></div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary btn-flat md-close" data-dismiss="modal" onclick="baocun1()">确定</button>
				<button type="button" class="btn btn-default btn-flat md-close" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>

	<!-- 服务地址信息(新增) -->
	<div class="md-modal colored-header custom-width md-effect-9" id="add-address">
		<div class="md-content">
			<div class="modal-header">
				<h3>服务地址信息添加</h3>
				<button type="button" class="close md-close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body form">
				<div class="form-group">
					<label>省</label> <select class="form-control" id="dizhixinxishen"></select>
				</div>
				<div class="form-group">
					<label>市</label> <select class="form-control" id="dizhixinxishi"></select>
				</div>
				<div class="form-group">
					<label>区</label> <select class="form-control" id="dizhixinxiqu"></select>
				</div>
				<div class="form-group">
					<label>街道</label> <select class="form-control" id="dizhixinxijiedao"></select>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary btn-flat md-close" data-dismiss="modal" onclick="savedzxi()">保存</button>
				<button type="button" class="btn btn-default btn-flat md-close" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>
	<!-- 服务地址信息(编辑) -->
	<div class="md-modal colored-header custom-width md-effect-9" id="add-addressBJ">
		<div class="md-content">
			<div class="modal-header">
				<h3>服务地址信息修改</h3>
				<button type="button" class="close md-close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body form">
				<div class="form-group">
					<label>省</label> <select class="form-control" id="dizhixinxishenBJ"></select>
				</div>
				<div class="form-group">
					<label>市</label> <select class="form-control" id="dizhixinxishiBJ"></select>
				</div>
				<div class="form-group">
					<label>区</label> <select class="form-control" id="dizhixinxiquBJ"></select>
				</div>
				<div class="form-group">
					<label>街道</label> <select class="form-control" id="dizhixinxijiedaoBJ"></select>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary btn-flat md-close" data-dismiss="modal" id="savedzxiBJ">保存</button>
				<button type="button" class="btn btn-default btn-flat md-close" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>

	<!-- 新增员工 -->
	<div class="md-modal colored-header custom-width md-effect-9" id="guanlian-yuangong">
		<div class="md-content" onclick="checkSelect_t2()" style="height:800px;overflow-y:scroll;width:700px;">
			<div class="modal-header">
				<h3>新增员工</h3>
				<button type="button" class="close md-close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<input type="hidden" id="hfids_t2"> <input type="hidden" id="hname_t2"> <input type="hidden" id="allchooseId_t2"> <input type="hidden" id="allchooseName_t2">
			</div>
			<div class="modal-body " id="erciquerenxinxi2">
				<div class="row">
					<div class="col-sm-1" style="clear:both;text-align: center; vertical-align: middle; height: 34px; line-height: 34px;width:100px;">
						<label>姓名</label>
					</div>
					<div class="col-sm-2" style="margin-bottom:10px;">
						<input class="form-control" type="text" style="width: 100%" id="name_input_t2">
					</div>
					<div class="col-sm-1" style="margin-bottom:5px;">
						<button class="btn btn-primary" style="margin-bottom: 0px !important; height: 34px;" onclick="query_t2()">查询</button>
					</div>
				</div>
				<!-- 数据表格开始 -->
				<div class="row">
					<div class="col-sm-12">
						<table class="table table-bordered dataTable hover" id="datatable" aria-describedby="datatable_info">
							<thead>
								<tr role="row">
									<th style="width:2%;"><input id="firstcheckbox_t2" type="checkbox" class="col_selector_t2" onclick="selectAll_t2();">
									</th>
									<th><strong>姓名</strong>
									</th>
									<th><strong>所属站点</strong>
									</th>
									<th><strong>角色</strong>
									</th>
								</tr>
							</thead>
							<tbody id="datacontainer_t2" role="alert" aria-live="polite" aria-relevant="all">
							</tbody>
						</table>
					</div>
				</div>
				<!-- 数据表格结束 -->
				<!-- 数据条数提示开始 -->
				<div class="row">
					<div class="col-sm-12">
						<div class="pull-left">
							<div id="datatable_info_t2" class="dataTables_info">当前显示0 条总记录中的第0-0条</div>
						</div>
						<div class="clearfix"></div>
					</div>
				</div>
				<!-- 数据条数提示结束 -->
				<!-- 分页条开始 -->
				<div class="row">
					<div class="col-sm-4" style="clear:both;">
						<div class="pull-left" style="margin:10px 0" id="datatable2_length">
							<label class="pull-left" style="margin:10px 0;">每页</label> <label class="pull-left" style="margin:10px 0;"> <select id="pageSizeSelector_t2" class="form-control" aria-controls="datatable2" size="1" name="datatable2_length" onchange="query_t2()">
									<option selected="selected" value="10">10</option>
									<option value="25">25</option>
									<option value="50">50</option>
									<option value="100">100</option>
							</select> </label> <label class="pull-left" style="margin:10px 0;">条</label>
						</div>
					</div>
					<div class="col-sm-8">
						<div class="pull-right">
							<div class="dataTables_paginate paging_bs_normal">
								<ul id="paginationArea_t2" class="pagination">
									<li class="prev disabled"><a href="#"><span class="fa fa-angle-left"></span>&nbsp;上一页</a>
									</li>
									<li class="active"><a href="#">1</a>
									</li>
									<li class="next"><a href="#">下一页&nbsp;<span class="fa fa-angle-right"></span>
									</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
				<!-- 分页条结束 -->
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary btn-flat md-close" data-dismiss="modal" onclick="savexinzeng_yg()">保存</button>
				<button type="button" id="glysquxiao" style="display:none;" class="btn btn-default btn-flat md-close" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>

	<!-- 新增会员 -->
	<div class="md-modal colored-header custom-width md-effect-9" id="guanlian-OldMan">
		<div class="md-content" style="height:800px;overflow-y:scroll;width:800px;">
			<div class="modal-header">
				<h3>新增会员</h3>
				<button type="button" class="close md-close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-sm-2" style="text-align: right; vertical-align: middle; height: 34px; line-height: 34px;">
						<label>服务区域</label>
					</div>
					<div class="col-sm-2" style="margin-bottom:10px;">
						<select class="form-control" type="text" id="quyushen_inputOldMan" style="width: 100%">
						</select>
					</div>
					<div class="col-sm-2" style="margin-bottom:10px;">
						<select class="form-control" type="text" id="quyushi_inputOldMan" style="width: 100%">
						</select>
					</div>
					<div class="col-sm-2" style="margin-bottom:10px;">
						<select class="form-control" type="text" id="quyuqu_inputOldMan" style="width: 100%">
						</select>
					</div>
					<div class="col-sm-2" style="margin-bottom:10px;">
						<select class="form-control" type="text" id="quyujiedao_inputOldMan" style="width: 100%">
						</select>
					</div>
					<div class="col-sm-1" style="margin-bottom:5px;">
						<button class="btn btn-primary" style="margin-bottom: 0px !important; height: 34px;" onclick="queryOldMan()">查询</button>
					</div>
				</div>
				<!-- 数据表格开始 -->
				<div class="row">
					<div class="col-sm-12">
						<table class="table table-bordered dataTable hover" id="datatable" aria-describedby="datatable_info">
							<thead>
								<tr role="row">
									<th><strong>选择</strong>
									</th>
									<th><strong>姓名</strong>
									</th>
									<th><strong>性别</strong>
									</th>
									<th><strong>联系方式</strong>
									</th>
									<th><strong>身份证</strong>
									</th>
								</tr>
							</thead>
							<tbody id="datacontainerOldMan" role="alert" aria-live="polite" aria-relevant="all">
							</tbody>
						</table>
					</div>
				</div>
				<!-- 数据表格结束 -->
				<!-- 数据条数提示开始 -->
				<div class="row">
					<div class="col-sm-12">
						<div class="pull-left">
							<div id="datatable_infoOldMan" class="dataTables_info">当前显示0 条总记录中的第0-0条</div>
						</div>
						<div class="clearfix"></div>
					</div>
				</div>
				<!-- 数据条数提示结束 -->
				<!-- 分页条开始 -->
				<div class="row">
					<div class="col-sm-4" style="clear:both;">
						<div class="pull-left" style="margin:10px 0" id="datatable2_length">
							<label class="pull-left" style="margin:10px 0;">每页</label> <label class="pull-left" style="margin:10px 0;"> <select id="pageSizeSelectorOldMan" class="form-control" aria-controls="datatableOldMan" size="1" name="datatable_length" onchange="queryOldMan()">
									<option selected="selected" value="10">10</option>
									<option value="25">25</option>
									<option value="50">50</option>
									<option value="100">100</option>
							</select> </label> <label class="pull-left" style="margin:10px 0;">条</label>
						</div>
					</div>
					<div class="col-sm-8">
						<div class="pull-right">
							<div class="dataTables_paginate paging_bs_normal">
								<ul id="paginationAreaOldMan" class="pagination">
									<li class="prev disabled"><a href="#"><span class="fa fa-angle-left"></span>&nbsp;上一页</a>
									</li>
									<li class="active"><a href="#">1</a>
									</li>
									<li class="next"><a href="#">下一页&nbsp;<span class="fa fa-angle-right"></span>
									</a>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
				<!-- 分页条结束 -->
			</div>
			<div class="modal-footer">
				<button type="button" style="display:none;" id="closeOldMan" class="btn btn-default btn-flat md-close" data-dismiss="modal">取消</button>
			</div>
		</div>
	</div>

	<!-- 新增服务工单 -->
	<div class="md-modal md-effect-1" id="servicegongdan_add" style="min-width:550px">
		<div class="md-content" style="height:800px;overflow-y:scroll">
			<div class="modal-header" style="border-bottom:1px solid #ddd;margin:0 20px;">
				<h3>新增服务工单</h3>
				<button type="button" class="close md-close" data-dismiss="modal" aria-hidden="true">&times;</button>
			</div>
			<div class="modal-body form">
				<div class="form-group" style="margin-bottom:0">
					<div class="row">
						<div class="col-sm-2 col-xs-4">老人</div>
						<div class="col-sm-4 col-xs-8 " style="position:relative;">
							<div class="input-group ">
								<input type="hidden" id="olderId_hide" value=""> <input class="form-control" type="text" id="oldinput_search2" onclick="getolderName2()" oninput="getolderName2()" onmouseout="javascript:$('#hideul-12').hide();" onmouseover="javascript:$('#hideul-12').show();"> <span class="input-group-btn"><button class="btn btn-primary " type="button">
										<span class="fa fa-search"></span>
									</button>
								</span>
							</div>
							<div class="hideul" id="hideul-12" onmouseover="javascript:$('#hideul-12').show();" onmouseout="javascript:$('#hideul-12').hide();">
								<ul id="hideul_nei12">

								</ul>
							</div>
						</div>
						<div class="col-sm-2 col-xs-4">联系人</div>
						<div class="col-sm-4 col-xs-8">
							<input type="text" class="form-control" id="oldinput_contentName" style="margin-bottom: 15px;">
						</div>
						<div class="col-sm-2 col-xs-4">联系电话</div>
						<div class="col-sm-4 col-xs-8">
							<input type="text" class="form-control" id="oldinput_contentTel" style="margin-bottom: 15px;">
						</div>
					</div>
				</div>
				<div class="form-group" style="margin-bottom:0;margin-top:0">
					<div class="row">
						<div class="col-sm-2 col-xs-4">联系地址</div>
						<div class="col-sm-10 col-xs-8">
							<input type="text" class="form-control" id="oldinput_contentAddress" style="margin-bottom: 15px;">
						</div>
					</div>
				</div>
				<div class="form-group" style="margin-bottom:0;margin-top:0">
					<div class="row">
						<div class="col-sm-2 col-xs-4">负责人</div>
						<div class="col-sm-10  col-xs-8 " style="position:relative;">
							<div class="input-group ">
								<input type="hidden" id="fuzerenId_hide" value=""> <input type="hidden" id="fuzerenName_hide" value=""> <input type="hidden" id="fuzerenRole_hide" value=""> <input type="hidden" id="fuzerenBH_hide" value=""> <input type="hidden" id="fuzerenSiteId_hide" value=""> <input type="hidden" id="fuzerenSiteName_hide" value=""> <input class="form-control" type="text" id="fprinput_search" onclick="getefprName()" oninput="getefprName()" onmouseout="javascript:$('#hideul-3').hide();" onmouseover="javascript:$('#hideul-3').show();"> <span class="input-group-btn"><button class="btn btn-primary " type="button">
										<span class="fa fa-search"></span>
									</button>
								</span>
							</div>
							<div class="hideul" id="hideul-3" onmouseover="javascript:$('#hideul-3').show();" onmouseout="javascript:$('#hideul-3').hide();">
								<ul id="hideul_nei3">

								</ul>
							</div>
						</div>
					</div>
				</div>
				<div class="form-group" style="margin-top:0">
					<div class="row">
						<div class="col-sm-2 col-xs-4">参与人</div>
						<div class="col-sm-10  col-xs-8 ">
							<select class="select2" id="cyrinput_search" multiple>

							</select>
						</div>
					</div>
				</div>
				<div class="form-group" style="margin-bottom:0">
					<div class="row">
						<div class="col-sm-2 col-xs-4">服务内容</div>
						<div class="col-sm-10  col-xs-8 " style="position:relative;">
							<div class="input-group ">
								<input type="hidden" id="fwxminput_Id4_hide" value=""> <input type="hidden" id="fwxminput_SCPRICE4_hide" value=""> <input type="hidden" id="fwxminput_YBPRICE4_hide" value=""> <input class="form-control" type="text" id="fwxminput_search4" onclick="getFWXM4()" oninput="getFWXM4()" onmouseout="javascript:$('#hideul-24').hide();" onmouseover="javascript:$('#hideul-24').show();"> <span class="input-group-btn"><button class="btn btn-primary " type="button">
										<span class="fa fa-search"></span>
									</button>
								</span>
							</div>
							<div class="hideul" id="hideul-24" onmouseover="javascript:$('#hideul-24').show();" onmouseout="javascript:$('#hideul-24').hide();">
								<ul id="hideul_nei24">

								</ul>
							</div>
						</div>
					</div>
				</div>
				<div class="form-group" style="margin-top:0">
					<div class="row">
						<div class="col-sm-2 col-xs-4">服务子项</div>
						<div class="col-sm-10  col-xs-8  ">
							<select class="select2" id="fuwuzixianginput_search" multiple>

							</select>
						</div>
					</div>
				</div>
				<div class="form-group">
					<div class="row">
						<div class="col-sm-2 col-xs-4">预计服务时长</div>
						<div class="col-sm-4 col-xs-8 ">
							<div class="input-group">
								<input type="text" class="form-control" id="yjfwsc" onpaste="return false;" onkeypress="keyPress()"><span class="input-group-addon">分钟</span>
							</div>
						</div>
						<div class="col-sm-2 col-xs-4" style="padding-top:5px">收费类型</div>
						<div class="col-sm-4 col-xs-8 ">
							<select id="fuwusflx_search" class="form-control" onchange="getFWXM_jiage()">
								<option value="医保">医保</option>
								<option value="市场">市场</option>
							</select>
						</div>
					</div>
				</div>
				<div class="form-group" style="margin-top:0">
					<div class="row">
						<div class="col-sm-2 col-xs-4">价格</div>
						<div class="col-sm-10 col-xs-8 " id="fuwusfjg_search">暂无</div>
					</div>
				</div>
				<div class="form-group">
					<div class="row">
						<div class=" col-sm-12">
							<table class="table no-border ">
								<thead class="no-border">
									<tr>
										<th><strong>&nbsp;&nbsp;预计服务时间</strong>
										</th>

										<th style="text-align:right;"><strong>操作</strong>
										</th>
									</tr>
								</thead>
								<tbody class="no-border-y mytablenopadding" id="yujiFWDate">
									<!-- <tr>
										<td >
											<input class="form-control datetime" size="16" type="text" value="" />
										</td>															
										<td > <a class="label label-danger" onclick="$(this).parent().parent().remove();" ><i class="fa fa-times"></i></a></td>
									</tr> -->
									<tr id="addshuizhong">
										<td></td>
										<td style="text-align:right"><a class="label btn-primary " onclick="addshuizhong();"><i class="fa fa-plus"></i>
										</a></td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn  btn-primary btn-flat" id="model_sure" onclick="saveMany()">确定</button>
				<button type="button" class="btn btn-default btn-flat md-close" data-dismiss="modal" id="closeAll" onclick="qingkongXZ()">取消</button>
			</div>
		</div>
	</div>

	<!-- 工单取消-->
	<div class="md-modal colored-header custom-width md-effect-9" id="servicegongdan_quxiao">
		<div class="md-content">
			<div class="modal-header">
				<h3>取消操作日志</h3>
				<button type="button" class="close md-close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<input type="hidden" id="idForQX" value="">
			</div>
			<div class="modal-body form form-horizontal">
				<!--  <form class="" > -->
				<div class="form-group" id="hyIfxianshi">
					<label class="col-sm-4 control-label">备注</label>
					<div class="col-sm-6 ">
						<textarea class="form-control" id="beizhu_input_quxiao"></textarea>
					</div>
				</div>
				<!-- </form> -->
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-primary btn-flat" data-dismiss="modal" onclick="sureQuxiao()">确定</button>
				<button type="button" class="btn btn-default btn-flat md-close" data-dismiss="modal" id="quxiao_tanchuang">取消</button>
			</div>
		</div>
	</div>

	<div class="md-overlay"></div>
	
	<script src="js/jquery.js"></script>
	<script type="text/javascript" src="js/jquery.nanoscroller/jquery.nanoscroller.js"></script>
	<script type="text/javascript" src="js/jquery.sparkline/jquery.sparkline.min.js"></script>
	<script type="text/javascript" src="js/jquery.easypiechart/jquery.easy-pie-chart.js"></script>
	<script src="js/jquery.ui/jquery-ui.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/jquery.nestable/jquery.nestable.js"></script>
	<script type="text/javascript" src="js/bootstrap.switch/bootstrap-switch.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
	<script src="js/jquery.select2/select2.min.js" type="text/javascript"></script>
	<script src="js/bootstrap.slider/js/bootstrap-slider.js" type="text/javascript"></script>
	<script type="text/javascript" src="js/jquery.gritter/js/jquery.gritter.js"></script>
	<script type="text/javascript" src="js/jquery.niftymodals/js/jquery.modalEffects.js"></script>
	<script type="text/javascript" src="js/masonry.js"></script>
	<script type="text/javascript" src="js/jquery.crop/js/jquery.Jcrop.js"></script>
	<script src="js/jquery.upload/js/jquery.iframe-transport.js"></script>
	<script src="js/jquery.upload/js/jquery.fileupload.js"></script>
	<script type="text/javascript" src="js/behaviour/general.js"></script>
	<script type="text/javascript" src="js/jquery.icheck/icheck.min.js"></script>

	<script type="text/javascript">
		/**页面初始化**/
		$(document).ready(function(){
	        //initialize the javascript
	        var homeUrl = "<%=request.getContextPath()%>" + "/welcome.do?main";
	  		$(".navbar-brand").attr("href",homeUrl);
	        App.init();
			$(".md-trigger").modalEffects();  //初始化模态框
			 
			/**基本信息页签**/
			//设置默认站点地址信息
	        //获取默认省  
	        var result = new Array();
	        result = getAddresses(4897);
	        var html="";
	        for(var i=0;i<result.length;i++){
	        	html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
	        }
	        $("#quyushen_input").html(html);
	        //获取默认市
	        getquyushixinxi($("#quyushen_input").val());
	        //获取默认区
	        getquyuquxinxi($("#quyushi_input").val());
	        //获取默认街道
	        getquyujiedaoxinxi($("#quyuqu_input").val());
	        //省级选择框变化事件
	        $("#quyushen_input").change(function(e){
	        	getquyushixinxi($("#quyushen_input").val());
	        	getquyuquxinxi($("#quyushi_input").val());
	        	getquyujiedaoxinxi($("#quyuqu_input").val());
	        });
	        //市级选择框变化事件
	        $("#quyushi_input").change(function(e){
	        	getquyuquxinxi($("#quyushi_input").val());
	        	getquyujiedaoxinxi($("#quyuqu_input").val());
	        });
	        //区级选择框变化事件
	        $("#quyuqu_input").change(function(e){
	        	getquyujiedaoxinxi($("#quyuqu_input").val());
	        });
	        
	        //弹出框 设置默认站点地址信息
			//弹出框省级选择框变化事件
			$("#dizhixinxishen").change(function(e){
	        	getquyushixinxiT($("#dizhixinxishen").val());
	        	getquyuquxinxiT($("#dizhixinxishi").val());
	        	getquyujiedaoxinxiT($("#dizhixinxiqu").val());
	        });
	        //弹出框市级选择框变化事件
	        $("#dizhixinxishi").change(function(e){
	        	getquyuquxinxiT($("#dizhixinxishi").val());
	        	getquyujiedaoxinxiT($("#dizhixinxiqu").val());
	        });
	        //弹出框区级选择框变化事件
	        $("#dizhixinxiqu").change(function(e){
	        	getquyujiedaoxinxiT($("#dizhixinxiqu").val());
	        });
	        //弹出框省级选择框变化事件-编辑
	        $("#dizhixinxishenBJ").change(function(e){
	        	var resultbj = new Array();
	    		resultbj = getAddresses($("#dizhixinxishenBJ").val());
	        	var htmlbj="";
	        	for(var i=0;i<resultbj.length;i++){
	        		htmlbj+="<option value=\""+resultbj[i].id+"\">"+resultbj[i].name+"</option>";
	        	}
	        	$("#dizhixinxishiBJ").html(htmlbj);
	        		
	        	var resultbj2 = new Array();
	    		resultbj2 = getAddresses($("#dizhixinxishiBJ").val());
	        	var htmlbj2="";
	        	for(var i=0;i<resultbj2.length;i++){
	        		htmlbj2+="<option value=\""+resultbj2[i].id+"\">"+resultbj2[i].name+"</option>";
	        	}
	        	$("#dizhixinxiquBJ").html(htmlbj2);
	        		
	        	var resultbj3 = new Array();
	    		resultbj3 = getAddresses($("#dizhixinxiquBJ").val());
	        	var htmlbj3="";
	        	for(var i=0;i<resultbj3.length;i++){
	        		htmlbj3+="<option value=\""+resultbj3[i].id+"\">"+resultbj3[i].name+"</option>";
	        	}
	        	$("#dizhixinxijiedaoBJ").html(htmlbj3);
	        });
	        //弹出框市级选择框变化事件-编辑
	        $("#dizhixinxishiBJ").change(function(e){
	        	var resultbj2 = new Array();
	    		resultbj2 = getAddresses($("#dizhixinxishiBJ").val());
	        	var htmlbj2="";
	        	for(var i=0;i<resultbj2.length;i++){
	        		htmlbj2+="<option value=\""+resultbj2[i].id+"\">"+resultbj2[i].name+"</option>";
	        	}
	        	$("#dizhixinxiquBJ").html(htmlbj2);
	        		
	        	var resultbj3 = new Array();
	    		resultbj3 = getAddresses($("#dizhixinxiquBJ").val());
	        	var htmlbj3="";
	        	for(var i=0;i<resultbj3.length;i++){
	        		htmlbj3+="<option value=\""+resultbj3[i].id+"\">"+resultbj3[i].name+"</option>";
	        	}
	        	$("#dizhixinxijiedaoBJ").html(htmlbj3);
	        });
	        //弹出框区级选择框变化事件-编辑
	        $("#dizhixinxiquBJ").change(function(e){
	        	var resultbj3 = new Array();
	    		resultbj3 = getAddresses($("#dizhixinxiquBJ").val());
	        	var htmlbj3="";
	        	for(var i=0;i<resultbj3.length;i++){
	        		htmlbj3+="<option value=\""+resultbj3[i].id+"\">"+resultbj3[i].name+"</option>";
	        	}
	        	$("#dizhixinxijiedaoBJ").html(htmlbj3);
	        });
	        	
	        /**所属员工页签**/
	        //职称默认值设置
	        getzhicheng1();
			$("#zhicheng2_input").html("<option value=\"\">全部</option>");
			$("#zhicheng1_input").change(function(e){
				if($("#zhicheng1_input").val() == ""){
					$("#zhicheng2_input").html("<option value=\"\">全部</option>");
				}else{
	        		getzhicheng2($("#zhicheng1_input").val());
	        	}
	    	});
	    	
	    	/**所属会员页签**/
	    	//设置默认所属区域地址信息
		    //获取默认省  
		    var resultOldMan = new Array();
		    resultOldMan = getAddresses(4897);
		    var htmlOldMan = "";
		    htmlOldMan +="<option value=\"\">省</option>";
		    for(var i = 0;i<resultOldMan.length;i++){
		    	htmlOldMan += "<option value=\"" + resultOldMan[i].id + "\">" + resultOldMan[i].name + "</option>";
		    }
		    $("#quyushen_inputOldMan").html(htmlOldMan);
		    $("#quyushi_inputOldMan").html("<option value=\"\">市</option>");
	    	$("#quyuqu_inputOldMan").html("<option value=\"\">区</option>");
	    	$("#quyujiedao_inputOldMan").html("<option value=\"\">街道</option>");
	        //省级选择框变化事件
	        $("#quyushen_inputOldMan").change(function(e){
	        	if($("#quyushen_inputOldMan").val() == ""){
	        		$("#quyushi_inputOldMan").html("<option value=\"\">市</option>");
	        		$("#quyuqu_inputOldMan").html("<option value=\"\">区</option>");
	        		$("#quyujiedao_inputOldMan").html("<option value=\"\">街道</option>");
	        	}else{
	        		getquyushixinxiOldMan($("#quyushen_inputOldMan").val());
	        		getquyuquxinxiOldMan($("#quyushi_inputOldMan").val());
	        		getquyujiedaoxinxiOldMan($("#quyuqu_inputOldMan").val());
	        	}
	        });
	        //市级选择框变化事件
	        $("#quyushi_inputOldMan").change(function(e){
	        	if($("#quyushi_inputOldMan").val() == ""){
	        		$("#quyuqu_inputOldMan").html("<option value=\"\">区</option>");
	        		$("#quyujiedao_inputOldMan").html("<option value=\"\">街道</option>");
	        	}else{
	        		getquyuquxinxiOldMan($("#quyushi_inputOldMan").val());
	        		getquyujiedaoxinxiOldMan($("#quyuqu_inputOldMan").val());
	        	}
	        });
	        //区级选择框变化事件
	        $("#quyuqu_inputOldMan").change(function(e){
	        	if($("#quyuqu_inputOldMan").val() == ""){
	        		$("#quyujiedao_inputOldMan").html("<option value=\"\">街道</option>");
	        	}else{
	        		getquyujiedaoxinxiOldMan($("#quyuqu_inputOldMan").val());
	        	}
	        });
	    	
	    	/**历史服务页签**/
	    	//添加回车事件
	    	$("#oldinput_search2").keydown(function() { //焦点在弹窗第一个时，按回车，焦点跳转到第二个
				if (event.keyCode == 13) {
					$("#oldinput_contentName").focus();
					return;
				}
			});
			$("#oldinput_contentName").keydown(function() { //...
				if (event.keyCode == 13) {
					$("#oldinput_contentTel").focus();
					return;
				}
			});
			$("#oldinput_contentTel").keydown(function() { //...
				if (event.keyCode == 13) {
					$("#oldinput_contentAddress").focus();
					return;
				}
			});
			$("#oldinput_contentAddress").keydown(function() { //...
				if (event.keyCode == 13) {
					$("#fprinput_search").focus();
					return;
				}
			});
			$("#fprinput_search").keydown(function() { //...
				if (event.keyCode == 13) {
					$("#cyrinput_search").focus();
					return;
				}
			});
			$("#cyrinput_search").keydown(function() { //...
				if (event.keyCode == 13) {
					$("#fwxminput_search4").focus();
					return;
				}
			});
			$("#fwxminput_search4").keydown(function() { //...
				if (event.keyCode == 13) {
					$("#fuwuzixianginput_search").focus();
					return;
				}
			});
			$("#fuwuzixianginput_search").keydown(function() { //...
				if (event.keyCode == 13) {
					$("#yjfwsc").focus();
					return;
				}
			});
			$("#yjfwsc").keydown(function() { //...
				if (event.keyCode == 13) {
					$("#model_sure").focus();
					return;
				}
			});
			
			query();//基本信息初始化
	        query2();
	       	query5();
			getLoginName();
	        getcyrName();
	        getallRoll();
		});
		
		
		
		/**概览**/
		//修改头像
		function baocuntouxiang(){
			var touxiangSrc=$("#hide_siteTupian").val();//头像
			var reqmsg="{'action':'ADD_SITE_INFO_REQUEST','content':{";
			
			if (touxiangSrc != null && touxiangSrc != "") {
		       	reqmsg += "\"mainPhoto\":\"" + touxiangSrc + "\",";
			}
			var siteId="<%=request.getAttribute("siteId")%>";
					reqmsg+="\"id\":"+siteId;
					reqmsg += "}}";
		
					jQuery.ajax({
		          	type : "post",
		          	async:true,
		          	url : "addSite.do?handler",
		          	dataType : "json",
		          	data: {
		           	    "reqmsg":reqmsg
		          	},
		          	success : function(data){
		              if(data.des=="success"){
		              	 alert("修改头像成功");
		              }else if(data.des=="failure"){
		                 alert("修改头像失败");
		              }else{
		              	 alert(data.des);
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		//上传图片
		function uploadPic() {
			var currPic = $("#pic4upload").val();
			if (currPic != null && currPic != "") {
				var ajax_option = {
					async:false,
					data:{},
					success:function(data) {
						if (data != null && data != "") {
							$("#srcPath").val(data); 
							//$("#touxiangId2").attr("src", data);  //将当前图片设为上传的图片
							openImagejsp(data);
						} else {
							alert("图片上传失败");
						}
					}
				};
				$("#picuploadform").ajaxSubmit(ajax_option);
			} else {
				//alert("请选择图片");
			}
		}
		//打开图片控件页面
		function openImagejsp(data){
			window.open ("view/imageCut/jquery-image-cut/image.jsp?"+data, "newwindow", "height=550, width=1100, top=200, left=450, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=no, status=no");
		}
		//上传裁剪后图片
		function uploadPic_cut() {
				var ajax_option = {
					async:false,
					data:{},
					success:function(data) {
						if (data != null && data != "") {
							var result = JSON.parse(data);
							$("#hide_siteTupian").val(result.base64);
							$("#touxiangId").attr("src", result.url);  //将当前图片设为上传的图片
							baocuntouxiang();
						} else {
							alert("图片上传失败");
						}
					}
				};
				$("#image_submit").ajaxSubmit(ajax_option);
		}
		
		
		/**基本信息页签**/
		//获取市信息
        function getquyushixinxi(id){
        	var result = new Array();
    		result = getAddresses(id);
        	var html="";
        	for(var i=0;i<result.length;i++){
        		html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
        	}
        	$("#quyushi_input").html(html);
        }
        //获取区信息
        function getquyuquxinxi(id){
        	var result = new Array();
    		result = getAddresses(id);
        	var html="";
        	for(var i=0;i<result.length;i++){
        		html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
        	}
        	$("#quyuqu_input").html(html);
        }
        //获取街道信息
        function getquyujiedaoxinxi(id){
        	var result = new Array();
    		result = getAddresses(id);
        	var html="";
        	for(var i=0;i<result.length;i++){
        		html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
        	}
        	$("#quyujiedao_input").html(html);
        }
		//二次确认弹窗
		function openFakeSaveButton(){
			var html = "您修改了站点<span style=\"color:#3380ff\">"+$("#zhandian_head").html()+"</span>的信息，是否确认保存？";
			$("#erciquerenxinxi").html(html);
			$('#fake-saveAllBasicHeal').click();
		}
		function able2edit(){
			$('input[tag=hedangdang]').removeAttr("readonly");//去掉input的
			$('select[tag=hedangdang]').removeAttr("disabled");//去掉select的
			var buttonHTML = '<button class="btn btn-flat btn-rad  btn-primary"  onclick="able2edit()">编辑信息</button><button class="btn btn-flat btn-rad  btn-success"  style="margin-left:30px" onclick="openFakeSaveButton();">保存全部</button><button class="btn btn-default btn-flat btn-rad" style="margin-left:30px" onclick="disabled2edit()">取消修改</button>';
			$('#hedangdang1').html(buttonHTML);
			$('#guanlianyishi2').html('<button class="btn btn-primary btn-flat btn-rad" >修改</button>');
			$('td[tag=hedangdang]').removeAttr("style");
			$('th[tag=hedangdang]').removeAttr("style");
			$("#zhanzhang_input").attr("onclick","guanlianzhanzhang()");
		}
		function disabled2edit(){
			query();
			$('input[tag=hedangdang]').attr("readonly","readonly");//去掉input的
			$('select[tag=hedangdang]').attr("disabled","disabled");//去掉select的
			var buttonHTML = '<button class="btn btn-flat btn-rad  btn-primary"  onclick="able2edit()">编辑信息</button>';
			$('#hedangdang1').html(buttonHTML);
			$('#guanlianyishi2').html(' ');
			$('td[tag=hedangdang]').css({"display":"none"});
			$('th[tag=hedangdang]').css({"display":"none"});
			$("#zhanzhang_input").attr("onclick","javascript:return false;");
		}
		//获取站点基本信息
		function query(){
			var siteId="<%=request.getAttribute("siteId")%>";
			var reqmsg="{'action':'QUERY_SITE_INFO_REQUEST','content':{\"masterEmployeeShow\":\"true\",\"employeeListShow\":\"true\",\"dataDicListShow\":\"true\",\"id\":"+siteId+"}}";
			
			  jQuery.ajax({
	          type : "post",
	          async:true,
	          url : "daeSite.do?handler",
	          dataType : "json",
	          data: {
	               "reqmsg":reqmsg
	          },
	          success : function(data){
	              if(data.des=="success"){
	            	  changeData(data);
	              }else if(data.des=="failure"){
	                 alert("查询失败");
	              }
	          },
	          error:function(){
		           alert("error");
	          }
	    	 });
		}
		function changeData(data){
				if (data.content != null) {
					if(data.content.mainPhoto != null && data.content.mainPhoto != ""){
						$("#touxiangId").attr("src",data.content.mainPhoto + "?random=" + Math.random());//头像
						$("#hide_siteTupian").val(data.content.mainPhoto);//头像
					}
					//头
					getyuangongAndLaoren(data.content.id);
					
					if(data.content.name != null && data.content.name != ""){
		 				$("#zhandian_head").html(data.content.name);//站点名称
		 			}else{
		 				$("#zhandian_head").html("未知");//站点名称
		 			}
		 			
		 			var pi=getNameById(data.content.provinceId);
		 			var ci=getNameById(data.content.cityId);
		 			var ai=getNameById(data.content.areaId);
		 			var si=getNameById(data.content.streetId);
		 			var ad=data.content.address;
		 			if(pi == null || pi == ""){
		 				pi="未知";
		 			}
		 			if(ci == null || ci == ""){
		 				ci="未知";
		 			}
		 			if(ai == null || ai == ""){
		 				ai="未知";
		 			}
		 			if(si == null || si == ""){
		 				si="未知";
		 			}
		 			if(ad == null || ad == ""){
		 				ad="未知";
		 			}
					$("#jutidizhi_head").html(pi+","+ci+","+ai+","+si+","+ad);//地址
		
					if(data.content.dataDicList != null && data.content.dataDicList.length > 0){
						var jiedao = "";
						jQuery.each(data.content.dataDicList, function(i, item) {
							jiedao += getNameById(item.id) + ",";
						});
						if(jiedao != ""){
							jiedao = jiedao.substring(0, jiedao.length-1);
						}
						if(jiedao != "" && jiedao != null){
							if(jiedao.length > 18){
								$("#jutidizhi_fuwu_head").html(jiedao.substr(0,18) + "...");//服务地址
							}else{
								$("#jutidizhi_fuwu_head").html(jiedao);//服务地址
							}
						}
					}
		
					var cp=data.content.contactPerson;
		 			var ct=data.content.contactTel;
		 			if(cp == null || cp == ""){
		 				cp="未知";
		 			}
		 			if(ct == null || ct == ""){
		 				ct="未知";
		 			}
		 
					$("#name_tele_head").html("负责人:"+cp+"/"+ct);//负责人：姓名和电话
				
		
					//主体
					$("#name_input").val(data.content.name);//站点名称
					if(data.content.masterEmployee != null){
						$("#zhanzhang_input").val(data.content.masterEmployee.name);//站长
						$("#zhanzhangId_input").val(data.content.masterEmployee.id);
					}
					$("#lianxiren_input").val(data.content.contactPerson);//联系人
					$("#lianxidianhua_input").val(data.content.contactTel);//联系电话
					$("#siteleibie_input").val(data.content.type);//站点类别
					$("#quyushen_input").val(data.content.provinceId);//地址（省）
					getquyushixinxi(data.content.provinceId);
					$("#quyushi_input").val(data.content.cityId);//地址（市）
					getquyuquxinxi(data.content.cityId);
					$("#quyuqu_input").val(data.content.areaId);//地址（区）
					getquyujiedaoxinxi(data.content.areaId);
					$("#quyujiedao_input").val(data.content.streetId);//地址（街道）
					$("#jutidizhi").val(data.content.address);//地址（具体地址）
					
					//服务地址信息
					if(data.content.dataDicList != null){
						var html23="";
						if(data.content.dataDicList != null && data.content.dataDicList.length > 0){
		 					var jiedaoId = 0;
		 					var jiedaoName = "";
		 					var quId = 0;
		 					var quName = "";
		 					var shiId = 0;
		 					var shiName = "";
		 					var shenId = 0;
		 					var shenName = "";
		 					jQuery.each(data.content.dataDicList, function(i, item) {
		 						jiedaoId = item.id;
		 						jiedaoName = getNameById(item.id);
		 						quId = getFatherIdBySonId(jiedaoId);
		 						quName = getNameById(quId);
		 						shiId = getFatherIdBySonId(quId);
		 						shiName = getNameById(shiId);
		 						shenId = getFatherIdBySonId(shiId);
		 						shenName = getNameById(shenId);
		 				 	
		 						html23+="<tr>";
								html23+="<td>"+shenName+"<input type=\"hidden\" value=\"" + shenId + "\"></td>";
								html23+="<td>"+shiName+"<input type=\"hidden\" value=\"" + shiId + "\"></td>";
								html23+="<td>"+quName+"<input type=\"hidden\" value=\"" + quId + "\"></td>";
								html23+="<td>"+jiedaoName+"<input type=\"hidden\" value=\"" + jiedaoId + "\"></td>";
								html23+="<td style=\"display:none;\" tag=\"hedangdang\"><a class=\"label label-default\" onclick=\"editxinxi(this)\"><i class=\"fa fa-pencil\"></i></a> <a class=\"label label-danger\" onclick=\"$(this).parent().parent().remove();\"><i class=\"fa fa-times\"></i></a></td>";							
								html23+="</tr>";
								
								jiedaoId = 0;
		 						jiedaoName = "";
		 						quId = 0;
		 						quName = "";
		 						shiId = 0;
		 						shiName = "";
		 						shenId = 0;
		 						shenName = "";
		 					});
		 					html23+="<tr id=\"addressMessge_add\">";
							html23+="<td></td>";
							html23+="<td></td>";
							html23+="<td></td>";
							html23+="<td></td>";
							html23+="<td style=\"display:none;\" tag=\"hedangdang\"><a class=\"label label-primary md-trigger\" data-modal=\"add-address\" onclick=\"dizhixinxi()\"><i class=\"fa fa-plus\"></i></a></td>";							
							html23+="</tr>";
							
							$("#addressMessge").html(html23);	
						}
					}
		 			
		 		}
		    }
		    //获取员工数量和老人数量
			function getyuangongAndLaoren(siteId){
				  var html="";
				  jQuery.ajax({
			          type : "post",
			          async:false,
			          url : "daeSite.do?getyuangongAndLaoren",
			          dataType : "json",
			          data: {
			               "siteId":siteId
			          },
			          success : function(data){
			              if(data.des=="success"){
			            	  $("#ygNum").html(data.ygNum);
			            	  $("#oldNum").html(data.oldNum);
			              }else{
			              	$("#ygNum").html("未知");
			            	$("#oldNum").html("未知");
			              }
			          },
			          error:function(){
			            	$("#ygNum").html("未知");
			            	$("#oldNum").html("未知");
				           alert("error");
			          }
			      });
			}
			//保存站点基本信息
	    	function baocun1(){
				var name_input = $("#name_input").val();//名称  
				if($.trim(name_input) == ""){
		 			alert("名称必填");
		 			return;
				}
				var zhanzhang_input= $("#zhanzhangId_input").val();//站长
				if($("#zhanzhang_input").val() == "" || $("#zhanzhang_input").val() == null){
					zhanzhang_input = "0";
				}
				
				var lianxiren_input = $("#lianxiren_input").val();//联系人
				if($.trim(lianxiren_input) == ""){
		 			alert("联系人必填");
		 			return;
				}
				var lianxidianhua_input = $("#lianxidianhua_input").val();//联系电话
				if($.trim(lianxidianhua_input) == ""){
		 			alert("联系电话必填");
		 			return;
				}
				var siteleibie_input = $("#siteleibie_input").val();//站点类别
				var quyushen_input = $("#quyushen_input").val();//地址（省）
				if($.trim(quyushen_input) == ""){
		 			alert("地址（省）必选");
		 			return;
				}
				var quyushi_input = $("#quyushi_input").val();//地址（市）
				if($.trim(quyushi_input) == ""){
		 			alert("地址（市）必选");
		 			return;
				}
				var quyuqu_input = $("#quyuqu_input").val();//地址（区）
				if($.trim(quyuqu_input) == ""){
		 			alert("地址（区）必选");
		 			return;
				}
				var quyujiedao_input = $("#quyujiedao_input").val();//地址（街道）
				if($.trim(quyujiedao_input) == ""){
		 			alert("地址（街道）必选");
		 			return;
				}
				var jutidizhi = $("#jutidizhi").val();//地址（具体地址）
				if($.trim(jutidizhi) == ""){
		 			alert("具体地址必填");
		 			return;
				}
				var reqmsg="{'action':'ADD_SITE_INFO_REQUEST','content':{";
		
	    		if (name_input != null && name_input != "") {
	        		reqmsg += "\"name\":\"" + name_input + "\",";
				}
	    		
	        	reqmsg += "\"masterEmployeeId\":" + zhanzhang_input + ",";
				
	    		if (lianxiren_input != null && lianxiren_input != "") {
	       			reqmsg += "\"contactPerson\":\"" + lianxiren_input + "\",";
				}
				if (lianxidianhua_input != null && lianxidianhua_input != "") {
	       			reqmsg += "\"contactTel\":\"" + lianxidianhua_input + "\",";
				}
				if (siteleibie_input != null && siteleibie_input != "") {
	       			reqmsg += "\"type\":\"" + siteleibie_input + "\",";
				}
				if (quyushen_input != null && quyushen_input != "") {
	        		reqmsg += "\"provinceId\":" + quyushen_input + ",";
				}
	    		if (quyushi_input != null && quyushi_input != "") {
	        		reqmsg += "\"cityId\":" + quyushi_input + ",";
				}
				if (quyuqu_input != null && quyuqu_input != "") {
	        		reqmsg += "\"areaId\":" + quyuqu_input + ",";
				}
				if (quyujiedao_input != null && quyujiedao_input != "") {
	        		reqmsg += "\"streetId\":" + quyujiedao_input + ",";
				}
				if (jutidizhi != null && jutidizhi != "") {
	        		reqmsg += "\"address\":\"" + jutidizhi + "\",";
				}
			
				var add11=$("#addressMessge tr:first td:last a");
				if(add11.length != 1){//有服务地址信息
					reqmsg +="\"site_dataDic_list\":[";
					$("#addressMessge tr:last").remove();
					var add3=$("#addressMessge tr");
					for(var i=0;i<add3.length;i++){
						reqmsg +="{\"dataDicId\":" + $("#addressMessge").find("tr:eq("+i+")").find("td:eq(3)").find("input").val() + "},";
					}
					
					reqmsg=reqmsg.substr(0,reqmsg.length-1);
					reqmsg +="],";
				}
			
				reqmsg=reqmsg.substr(0,reqmsg.length-1);
				var siteId="<%=request.getAttribute("siteId")%>";
				reqmsg +=",\"id\":"+siteId;
				reqmsg += "}}";
	
				jQuery.ajax({
		          	type : "post",
		          	async:true,
		          	url : "addSite.do?handler",
		          	dataType : "json",
		          	data: {
		           	    "reqmsg":reqmsg
		          	},
		          	success : function(data){
		              if(data.des=="success"){
		              	alert("修改成功");
		              	var id=data.content.id;
		              	var path="<%=request.getContextPath()%>";
		              	var url=path+"/daeSite.do?main&siteId="+id;
		              	window.location.replace(url);
		              }else if(data.des=="failure"){
		                 alert("修改失败");
		              }else{
		              	alert(data.des);
		              }
		          	},
		          	error:function(){
			           alert("error");
		          	}
	     		});
			}
		    //地址信息模块
			//打开地址信息弹窗框，并且设置默认值
			function dizhixinxi(){
				$("#dizhixinxidzlx").val(0);
				//获取省  
	        	var result = new Array();
	        	result = getAddresses(4897);
	        	var html="";
	        	for(var i=0;i<result.length;i++){
	        		html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
	        	}
	        	$("#dizhixinxishen").html(html);
	        	
	        	//获取默认市
	        	getquyushixinxiT($("#dizhixinxishen").val());
	        	//获取默认区
	        	getquyuquxinxiT($("#dizhixinxishi").val());
	        	//获取街道
	        	getquyujiedaoxinxiT($("#dizhixinxiqu").val());
	        	
				$("#adddzxx").click();
			}
			//弹出框获取市信息
	      	function getquyushixinxiT(id){
		        var result = new Array();
		    	result = getAddresses(id);
		        var html="";
		        for(var i=0;i<result.length;i++){
		        	html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
		        }
		        $("#dizhixinxishi").html(html);
	      	}
	     	//弹出框获取区信息
	      	function getquyuquxinxiT(id){
		        var result = new Array();
		    	result = getAddresses(id);
		        var html="";
		        for(var i=0;i<result.length;i++){
		        	html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
		        }
		        $("#dizhixinxiqu").html(html);
	      	}
	      	//弹出框获取街道信息
	      	function getquyujiedaoxinxiT(id){
		        var result = new Array();
		    	result = getAddresses(id);
		        var html="";
		        for(var i=0;i<result.length;i++){
		        	html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
		        }
		        $("#dizhixinxijiedao").html(html);
	      	}
			//保存弹出框地址信息
			function savedzxi(){
				var newhtml = '<tr><td>'+ $("#dizhixinxishen").find("option:selected").text() +'<input type=\"hidden\" value=\"' + $("#dizhixinxishen").val() + '\"></td><td>'+ $("#dizhixinxishi").find("option:selected").text() +'<input type=\"hidden\" value=\"' + $("#dizhixinxishi").val() + '\"></td><td>'+ $("#dizhixinxiqu").find("option:selected").text() +'<input type=\"hidden\" value=\"' + $("#dizhixinxiqu").val() + '\"></td><td>'+ $("#dizhixinxijiedao").find("option:selected").text() +'<input type=\"hidden\" value=\"' + $("#dizhixinxijiedao").val() + '\"></td><td ><a class="label label-default" onclick="editxinxi(this)"><i class="fa fa-pencil"></i></a> <a class="label label-danger" onclick="$(this).parent().parent().remove();"><i class="fa fa-times"></i></a></td></tr>';
			 	$(newhtml).insertBefore("#addressMessge_add"); 
			}
			//编辑弹出框地址信息
			function editxinxi(par){
				var shen = $(par).parent().prev().prev().prev().prev().find("input").val();
				var shi = $(par).parent().prev().prev().prev().find("input").val();
				var qu = $(par).parent().prev().prev().find("input").val();
				var jiedao = $(par).parent().prev().find("input").val();
				
				//获取省  
	        	var result = new Array();
	        	result = getAddresses(4897);
	        	var html="";
	        	for(var i=0;i<result.length;i++){
	        		html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
	        	}
	        	$("#dizhixinxishenBJ").html(html);
	        	
	        	//获取默认市
	        	var result2 = new Array();
	    		result2 = getAddresses(shen);
	        	var html2="";
	        	for(var i=0;i<result2.length;i++){
	        		html2+="<option value=\""+result2[i].id+"\">"+result2[i].name+"</option>";
	        	}
	        	$("#dizhixinxishiBJ").html(html2);
	        
	        	//获取默认区
	        	var result3 = new Array();
	    		result3 = getAddresses(shi);
	        	var html3="";
	        	for(var i=0;i<result3.length;i++){
	        		html3+="<option value=\""+result3[i].id+"\">"+result3[i].name+"</option>";
	        	}
	        	$("#dizhixinxiquBJ").html(html3);
	        	
	        	//获取默认街道
	        	var result4 = new Array();
	    		result4 = getAddresses(qu);
	        	var html4="";
	        	for(var i=0;i<result4.length;i++){
	        		html4+="<option value=\""+result4[i].id+"\">"+result4[i].name+"</option>";
	        	}
	        	$("#dizhixinxijiedaoBJ").html(html4);
	        	
	        	$("#dizhixinxishenBJ").val(shen);
	        	$("#dizhixinxishiBJ").val(shi);
	        	$("#dizhixinxiquBJ").val(qu);
				$("#dizhixinxijiedaoBJ").val(jiedao);
				
				$("#editdzxx").click();
				
				document.getElementById("savedzxiBJ").onclick = function(){			
					$(par).parent().prev().html($("#dizhixinxijiedaoBJ").find("option:selected").text() + "<input type=\"hidden\" value=\"" + $("#dizhixinxijiedaoBJ").val() + "\">");
					$(par).parent().prev().prev().html($("#dizhixinxiquBJ").find("option:selected").text() + "<input type=\"hidden\" value=\"" + $("#dizhixinxiquBJ").val() + "\">");
					$(par).parent().prev().prev().prev().html($("#dizhixinxishiBJ").find("option:selected").text() + "<input type=\"hidden\" value=\"" + $("#dizhixinxishiBJ").val() + "\">");
					$(par).parent().prev().prev().prev().prev().html($("#dizhixinxishenBJ").find("option:selected").text() + "<input type=\"hidden\" value=\"" + $("#dizhixinxishenBJ").val() + "\">");
				}
			}
			//关联站长模块
			var currentshownpage_t = 1;
			function guanlianzhanzhang(){
				query_t();
				$("#zhanzhang_modalId").click();
			}
			function query_t() {
				go2page_t(1);
			}
			function go2page_t(pagenumber){
			var pagesize = $("#pageSizeSelector_t option:selected").val();
			var name2search = $("#name_input_t").val();
			
			var reqmsg="{'action':'QUERY_EMPLOYEE_LIST_REQUEST','page':{'pageno':'" + pagenumber + "','pagesize':'" + pagesize + "'},'content':{\"siteListShow\":\"true\",\"dataDicListShow\":\"true\",";
			
			if (name2search != null && name2search != "") {
				reqmsg += "\"name_like\":\"" + name2search + "\",";
			}
		
			var roleIds = getIdByRoleName("站长");
			reqmsg += "\"roleIds\":\""+roleIds+"\",";
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:true,
		          url : "employee.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		            	  changeData_t(data);
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		//根据角色名称查找角色ID
		function getIdByRoleName(name){
			var id="0";
			 jQuery.ajax({
	          type : "post",
	          async:false,
	          url : "addOlders.do?getIdByRoleName",
	          dataType : "json",
	          data: {
	               "RoleName":name
	          },
	          success : function(data){
	              if(data.des=="success"){
	              		id = data.id;
	              }else if(data.des=="failure"){
	                 alert("查询失败");
	              }
	          },
	          error:function(){
		           alert("error");
	          }
	     	});
			return id;
		}
		function changeData_t(data){
			var htmlcode = "";
			if (data.content != null) {
				jQuery.each(data.content.employeeList, function(i, item) {
					htmlcode += "<tr class=\"gradeA odd\">";
					htmlcode += "<td class=\"btn btn-primary btn-md\" style=\"color:#fff;\" onclick=\"savezz("+item.id+",'"+item.name+"')\">选择</td>";
				    if (item.siteList != null && item.siteList.length > 0) {//所属站点
				    	if(item.siteList[0] != null){
							var siteName = "";
							jQuery.each(item.siteList, function(j, item2) {
								if(item2 != null){
									siteName += item2.name + ",";
								}
							});
							if(siteName != ""){
								siteName = siteName.substring(0, siteName.length-1);
							}
							htmlcode += "<td>" + siteName + "</td>";
						}else{
				    		htmlcode += "<td>无</td>";
				    	}	
					}else{
				    	htmlcode += "<td>无</td>";
				    }
				    htmlcode += "<td>" + item.name + "</td>";
				    if(item.siteStreetName != null && item.siteStreetName != ""){
				    	htmlcode += "<td>" + item.siteStreetName + "</td>";
				    }else{
				    	htmlcode += "<td>无</td>";
				    }
					htmlcode += "</tr>";
				});
			}
			$("#datacontainer_t").html(htmlcode);
			if (data.page != null) {
				genaratePaginateHtml_t(data.page.pageno, data.page.pageCount);
				genarateRecordNumberHtml_t(data.page.pageno, data.page.pagesize, data.page.recordCount);
			} else {
				genaratePaginateHtml_t(1, 1);
				genarateRecordNumberHtml_t(1, 10, 0);
			}
		}
		/**
		 * 生成分页信息
		 * @method genaratePaginateHtml_t
		 * @param {Number} currentpage 当前页
		 * @param {Number} totalpage 总页数
		 */
		function genaratePaginateHtml_t(currentpage, totalpage, pagesize) {
			currentshownpage_t = currentpage;
		
			var htmlcode = "";
			
			// 	上一页
			if (currentpage > 1) {
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page_t('1')\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page_t('" + (currentpage - 1) + "')\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			} else {
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			}
			
			// 	具体页码
			if (totalpage <= 5) {
				for (var i = 1; i <= totalpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page_t('" + i + "')\">" + i + "</a></li>";
					}
				}
			} else {
				var startpage = currentpage;
				var endpage = currentpage;
				while (true) {
					if (endpage - startpage >= 4) {
						break;
					} else {
						if (startpage > 1) {
							startpage = startpage - 1;
						}
						if (endpage < totalpage) {
							endpage = endpage - (-1);
						}
					}
				}
				
				for (var i = startpage; i <= endpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page_t('" + i + "')\">" + i + "</a></li>";
					}
				}
			}
			
			// 	下一页
			if (totalpage > currentpage) {
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page_t('" + (parseInt(currentpage) + 1) + "')\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page_t('" + parseInt(totalpage) + "')\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			} else {
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			}
			$("#paginationArea_t").html(htmlcode);
		}
		/**
		 * 生成记录数信息
		 * @method genarateRecordNumberHtml_t
		 * @param {Number} currentpage 当前页
		 * @param {Number} pagesize 每页记录条目数
		 * @param {Number} totalRecord 总记录数
		 */
		function genarateRecordNumberHtml_t(currentpage, pagesize, totalRecord) {
			var recordInfos = "";
			if (totalRecord > 0) {
			    recordInfos = "当前显示" + totalRecord + "条总记录";
				recordInfos += "中第" + ((currentpage - 1) * pagesize + 1) + "-";
				if (currentpage * pagesize > totalRecord) {
					recordInfos += totalRecord;
				} else {
					recordInfos += currentpage * pagesize;
				}
				recordInfos += "条 ";
			} else {
				recordInfos = "当前显示0 条总记录中的第0-0条";
			}
			
			$("#datatable_info_t").html(recordInfos);
		}
		//保存关联站长
		function savezz(id,name){
			$("#zhanzhang_input").val(name);
			$("#zhanzhangId_input").val(id);
			$("#glzzquxiao").click();
		}
	
	
	
		/**所辖员工页签**/
		//根据排序规则重新查询
		function queryBySort(par,column){
			var classFlag = listSortClickEvent(par);
			var type = judgmentChinese(column);
			if(type != null && type != ""){
				classFlag = type + classFlag;
				column = column.substr(8,column.length);
			}
			$("#sortType").val(classFlag);
			$("#sortColumn").val(column);
			go2page2(currentshownpage2);
		}
		//获取职称信息
        function getzhicheng1(){
	        var result = new Array();
	    	result = getAddresses(4921);
	        var html="";
	        html+="<option value=\"\">全部</option>";
	        for(var i=0;i<result.length;i++){
	        	html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
	        }
	        $("#zhicheng1_input").html(html);
        }
        //获取职称信息
        function getzhicheng2(id){
	        var result = new Array();
	    	result = getAddresses(id);
	        var html="";
	        html+="<option value=\"\">全部</option>";
	        for(var i=0;i<result.length;i++){
	        	html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
	        }
	        $("#zhicheng2_input").html(html);
        }
		var currentshownpage2 = 1;
		//批量删除所辖员工
		function doDel2() {
			var selectedItemNumber = $("tbody .col_selector2:checked").length;
			if (selectedItemNumber >= 1) {
				var ids2del = "";
				$("tbody .col_selector2:checked").each(function() {
					ids2del += $(this).val() + ",";
				});
				if (ids2del != "") {
					ids2del = ids2del.substring(0, ids2del.length - 1);
				}
				var siteId="<%=request.getAttribute("siteId")%>";
				var reqmsg="{'action':'ADD_EMPLOYEE_INFO_REQUEST','content':{\"delEmployeesIds\":\""+ids2del + "\",\"delSiteId\":"+ siteId +"}}";
		
			    if (confirm("是否确认删除?"))  {  
						jQuery.ajax({
		          			type : "post",
		          			async:true,
		          			url : "employee.do?handler",
		         			dataType : "json",
		          			data: {
		               			"reqmsg":reqmsg
		          			},
		          		success : function(data){
		                    if(data.result=="100"){
		                    	alert(data.des);
		            	  		query2();
		               		}else{
		                 		alert(data.des);
		              		}
		          		},
		          		error:function(){
			     		      alert("error");
		         		 }
		    		    });
		       }
			} else {
				alert("请选择要删除的数据");
			}
		}
		function selectAll2() {
			if ($("#allselectchecker2").is(':checked')) {
				$(".col_selector2").prop("checked", true);
			} else {
				$(".col_selector2").prop("checked", false);
			}
		}
		//查询所辖员工
		function query2() {
			go2page2(1);
		}
		function go2page2(pagenumber){
			var pagesize = $("#pageSizeSelector2 option:selected").val();
			var name_input2 = $("#name_input2").val();
			var juese_input2 = $("#juese_input2").val();
			
			var zhicheng1_input = $("#zhicheng1_input").val();
			var zhicheng2_input = $("#zhicheng2_input").val();
			
			var reqmsg="{'action':'QUERY_EMPLOYEE_LIST_REQUEST',";
			
			var sortType = $("#sortType").val();
			var sortColumn = $("#sortColumn").val();
			if(sortType != null && sortType != ""){
				reqmsg += "'order':[{'column':'" + sortColumn + "','type':'" + sortType + "'}],";
			}
			
			reqmsg +="'page':{'pageno':'" + pagenumber + "','pagesize':'" + pagesize + "'},'content':{";
			
			var siteId="<%=request.getAttribute("siteId")%>";
			reqmsg +="\"siteId\":"+siteId+ ",";
			
			if (name_input2 != null && name_input2 != "") {
				reqmsg += "\"name_like\":\"" + name_input2 + "\",";
			}
			
			if (juese_input2 != null && juese_input2 != "") {
				reqmsg += "\"roleIds\":\"" + juese_input2 + "\",";
			}
			
			if($("#zhicheng1_input").val() != null){
			if($("#zhicheng1_input").val() != ""){
				reqmsg += "\"zhicheng1\":\"" + zhicheng1_input + "\"," + "\"zhicheng2\":\"" + zhicheng2_input + "\",";
			}else if($("#zhicheng1_input").val() == "" && $("#zhicheng1_input").val() != ""){
				reqmsg += "\"zhicheng1\":\"\"," + "\"zhicheng2\":\"" + zhicheng2_input + "\",";
			}
			}
			
			reqmsg += "}}";
			
		    jQuery.ajax({
		          type : "post",
		          async:true,
		          url : "employee.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		            	  changeData2(data);
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		function changeData2(data){
			var htmlcode = "";
			if (data.content != null) {
				jQuery.each(data.content.employeeList, function(i, item) {
					htmlcode += "<tr class=\"gradeA odd\"><td><input type=\"checkbox\" value=\"" + item.id + "\" class=\"col_selector2\"></td>";			
				    htmlcode += "<td>" + item.name + "</td>";				
				    htmlcode += "<td>" + item.roleNames + "</td>";
				    if(item.zhichengs != null && item.zhichengs != ""){
				    	htmlcode += "<td>" + item.zhichengs + "</td>";	
				    }else{
				    	htmlcode += "<td>无</td>";			    
				    }					
				    htmlcode += "<td>" + xingjiChange(item.starLevel)+ "</td>";	
				    
				    htmlcode += "<td><div class=\"btn-group\">";
					htmlcode += "<button class=\"btn btn-default btn-xs\" type=\"button\">操作</button>";
					htmlcode += "<button data-toggle=\"dropdown\" class=\"btn btn-xs btn-primary dropdown-toggle\" type=\"button\">";
					htmlcode += "<span class=\"caret\" style=\"padding:0;\"></span>";
					htmlcode += "<span class=\"sr-only\">Toggle Dropdown</span>";
					htmlcode += "</button>";
					htmlcode += "<ul role=\"menu\" class=\"dropdown-menu pull-right\">";
					var headUrl = "<%=request.getContextPath()%>";
					<c:if test="${site_queryemployXQ_opt_control != 'yes' or site_queryemployXQ_opt_show == 'yes'}">
					htmlcode += "<li><a href=\""+headUrl+"/daeEmployee.do?main&employeeId="+item.id+"\" target=\"_blank\">查看详情</a></li>";
					</c:if>	
					<c:if test="${site_delemploy_opt_control != 'yes' or site_delemploy_opt_show == 'yes'}">
					htmlcode += "<li onclick=\"del2('" + item.id + "')\"><a href=\"###\">删除</a></li>";
					</c:if>	
					htmlcode += "</ul>";
					htmlcode += "</div></td>";		
							
					htmlcode += "</tr>";
				});
			}
			$("#datacontainer2").html(htmlcode);
			if (data.page != null) {
				genaratePaginateHtml2(data.page.pageno, data.page.pageCount);
				genarateRecordNumberHtml2(data.page.pageno, data.page.pagesize, data.page.recordCount);
			} else {
				genaratePaginateHtml2(1, 1);
				genarateRecordNumberHtml2(1, 10, 0);
			}
		}
		//星级转化
		function xingjiChange(id){
				var name="未知";
		     	switch (id)
				{
					case 1:
		  			name="一星";
		  			break;
		  			
					case 2:
		  			name="二星";
		  			break;
		
					case 3:
		  			name="三星";
		  			break;
		  			
		  			case 4:
		  			name="四星";
		  			break;
		  			
		  			case 5:
		  			name="五星";
		  			break;
		  			
		  			default:
		  			break;
				}
				return name;
		}
		//单个删除所辖员工
		function del2(id) {
				var siteId="<%=request.getAttribute("siteId")%>";
				var reqmsg="{'action':'ADD_EMPLOYEE_INFO_REQUEST','content':{\"delEmployeesIds\":\""+id + "\",\"delSiteId\":"+ siteId +"}}";
		
					  if (confirm("是否确认删除?"))  {  
						jQuery.ajax({
		          			type : "post",
		          			async:true,
		          			url : "employee.do?handler",
		         			dataType : "json",
		          			data: {
		               			"reqmsg":reqmsg
		          			},
		          		success : function(data){
		                    if(data.result=="100"){
		                    	alert(data.des);
		            	  		query2();
		               		}else{
		                 		alert(data.des);
		              		}
		          		},
		          		error:function(){
			     		      alert("error");
		         		 }
		    		    });
		    		 }
		}
		/**
		 * 生成记录数信息
		 * @method genarateRecordNumberHtml2
		 * @param {Number} currentpage 当前页
		 * @param {Number} pagesize 每页记录条目数
		 * @param {Number} totalRecord 总记录数
		 */
		function genarateRecordNumberHtml2(currentpage, pagesize, totalRecord) {
			var recordInfos = "";
			if (totalRecord > 0) {
			    recordInfos = "当前显示" + totalRecord + "条总记录";
				recordInfos += "中第" + ((currentpage - 1) * pagesize + 1) + "-";
				if (currentpage * pagesize > totalRecord) {
					recordInfos += totalRecord;
				} else {
					recordInfos += currentpage * pagesize;
				}
				recordInfos += "条 ";
			} else {
				recordInfos = "当前显示0 条总记录中的第0-0条";
			}
			
			$("#datatable_info2").html(recordInfos);
		}
		/**
		 * 生成分页信息
		 * @method genaratePaginateHtml2
		 * @param {Number} currentpage 当前页
		 * @param {Number} totalpage 总页数
		 */
		function genaratePaginateHtml2(currentpage, totalpage, pagesize) {
			currentshownpage2 = currentpage;
		
			var htmlcode = "";
			
			//上一页
			if (currentpage > 1) {
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page2('1')\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page2('" + (currentpage - 1) + "')\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			} else {
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			}
			
			//具体页码
			if (totalpage <= 5) {
				for (var i = 1; i <= totalpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page2('" + i + "')\">" + i + "</a></li>";
					}
				}
			} else {
				var startpage = currentpage;
				var endpage = currentpage;
				while (true) {
					if (endpage - startpage >= 4) {
						break;
					} else {
						if (startpage > 1) {
							startpage = startpage - 1;
						}
						if (endpage < totalpage) {
							endpage = endpage - (-1);
						}
					}
				}
				
				for (var i = startpage; i <= endpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page2('" + i + "')\">" + i + "</a></li>";
					}
				}
			}
			
			//下一页
			if (totalpage > currentpage) {
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page2('" + (parseInt(currentpage) + 1) + "')\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page2('" + parseInt(totalpage) + "')\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			} else {
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			}
			$("#paginationArea2").html(htmlcode);
		}
		//获取所有角色
		function getallRoll(){
		  var html="";
		  jQuery.ajax({
	          type : "post",
	          async:false,
	          url : "addEmployee.do?getRoleName",
	          dataType : "json",
	          data: {
	               "RoleName":"角色"
	          },
	          success : function(data){
	              if(data.des=="success"){
	            	  var id=data.id.split(",");
	            	  var name=data.name.split(",");
	            	  for(var i=0;i<id.length;i++){
	            	  	if("老人".indexOf(name[i]) == -1){
	            	  		html=html+"<option value=\""+id[i]+"\">"+name[i]+"</option>";
	            	  	}
	            	  }
	              }
	          },
	          error:function(){
		           alert("error");
	          }
	      });
	      
		  $("#juese_input2").html(html);
		}
		//新增本站员工
	    function headAdd(){
	   		query_t2();
	    }
	    var currentshownpage_t2 = 1;
	    function query_t2() {
		  go2page_t2(1);
	    }
	    function go2page_t2(pagenumber){
			var pagesize = $("#pageSizeSelector_t2 option:selected").val();
			var name2search = $("#name_input_t2").val();
			
			var reqmsg="{'action':'QUERY_EMPLOYEE_LIST_REQUEST','page':{'pageno':'" + pagenumber + "','pagesize':'" + pagesize + "'},'content':{\"siteListShow\":\"true\",\"dataDicListShow\":\"true\",";
		
			if (name2search != null && name2search != "") {
				reqmsg += "\"name_like\":\"" + name2search + "\",";
			}
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:true,
		          url : "employee.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		            	  changeData_t2(data);
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		function changeData_t2(data){
			var htmlcode = "";
			if (data.content != null) {
			var allchooseId2="";
			var allchooseName2="";
			jQuery.each(data.content.employeeList, function(i, item) {
				allchooseId2=allchooseId2+item.id+",";
				allchooseName2=allchooseName2+item.name+",";
				allchooseId2.replace(",,",",");
				allchooseName2.replace(",,",",");
			});
			
			if(allchooseId2 != ""){
				allchooseId2 = allchooseId2.substr(0,allchooseId2.length-1)
			}
			if(allchooseName2 != ""){
				allchooseName2 = allchooseName2.substr(0,allchooseName2.length-1)
			}
			$("#allchooseId_t2").val(allchooseId2);
			$("#allchooseName_t2").val(allchooseName2);
			var siteId_yuan="<%=request.getAttribute("siteId")%>";
				jQuery.each(data.content.employeeList, function(i, item) {
					var siteName = "";
					var siteId = "";
				 	if (item.siteList != null && item.siteList.length > 0) {//所属站点
				    	if(item.siteList[0] != null){
							jQuery.each(item.siteList, function(j, item2) {
								siteName += item2.name + ",";
								siteId += item2.id + ",";
							});
							if(siteName != ""){
								siteName = siteName.substring(0, siteName.length-1);
							}
							if(siteId != ""){
								siteId = siteId.substring(0, siteId.length-1);
							}
						}
					}
					if(siteId.indexOf(siteId_yuan) == -1){
						htmlcode += "<tr class=\"gradeA odd\">";
						htmlcode += "<td><input id=\""+item.id+"\" value=\""+item.name+"\" name=\"index_t2\" type=\"checkbox\" onclick=\"selectOne_t2("+item.id+",'"+item.name+"')\" class=\"col_selector_t2\"></td>";
						htmlcode += "<td>" + item.name + "</td>";	
				    	if(siteName != ""){
				    		 htmlcode += "<td>" + siteName + "</td>";	
				    	}else{
				    		 htmlcode += "<td>无</td>";	
				    	}
				    	htmlcode += "<td>" + item.roleNames + "</td>";		
						htmlcode += "</tr>";
					}else{
						htmlcode += "<tr class=\"gradeA odd\">";
						htmlcode += "<td></td>";
						htmlcode += "<td>" + item.name + "</td>";	
				    	if(siteName != ""){
				    		 htmlcode += "<td>" + siteName + "</td>";	
				    	}else{
				    		 htmlcode += "<td>无</td>";	
				    	}
				    	htmlcode += "<td>" + item.roleNames + "</td>";		
						htmlcode += "</tr>";
					}
					
				});
			}
		
			$("#datacontainer_t2").html(htmlcode);
			if (data.page != null) {
				genaratePaginateHtml_t2(data.page.pageno, data.page.pageCount);
				genarateRecordNumberHtml_t2(data.page.pageno, data.page.pagesize, data.page.recordCount);
			} else {
				genaratePaginateHtml_t2(1, 1);
				genarateRecordNumberHtml_t2(1, 10, 0);
			}
			checkSelect_t2();
		}
		/**
		 * 生成分页信息
		 * @method genaratePaginateHtml_t2
		 * @param {Number} currentpage 当前页
		 * @param {Number} totalpage 总页数
		 */
		function genaratePaginateHtml_t2(currentpage, totalpage, pagesize) {
			currentshownpage_t2 = currentpage;
		
			var htmlcode = "";
			
			// 	上一页
			if (currentpage > 1) {
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page_t2('1')\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page_t2('" + (currentpage - 1) + "')\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			} else {
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			}
			
			// 	具体页码
			if (totalpage <= 5) {
				for (var i = 1; i <= totalpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page_t2('" + i + "')\">" + i + "</a></li>";
					}
				}
			} else {
				var startpage = currentpage;
				var endpage = currentpage;
				while (true) {
					if (endpage - startpage >= 4) {
						break;
					} else {
						if (startpage > 1) {
							startpage = startpage - 1;
						}
						if (endpage < totalpage) {
							endpage = endpage - (-1);
						}
					}
				}
				
				for (var i = startpage; i <= endpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page_t2('" + i + "')\">" + i + "</a></li>";
					}
				}
			}
			
			// 	下一页
			if (totalpage > currentpage) {
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page_t2('" + (parseInt(currentpage) + 1) + "')\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page_t2('" + parseInt(totalpage) + "')\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			} else {
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			}
			$("#paginationArea_t2").html(htmlcode);
		}
		/**
		 * 生成记录数信息
		 * @method genarateRecordNumberHtml_t2
		 * @param {Number} currentpage 当前页
		 * @param {Number} pagesize 每页记录条目数
		 * @param {Number} totalRecord 总记录数
		 */
		function genarateRecordNumberHtml_t2(currentpage, pagesize, totalRecord) {
			var recordInfos = "";
			if (totalRecord > 0) {
			    recordInfos = "当前显示" + totalRecord + "条总记录";
				recordInfos += "中第" + ((currentpage - 1) * pagesize + 1) + "-";
				if (currentpage * pagesize > totalRecord) {
					recordInfos += totalRecord;
				} else {
					recordInfos += currentpage * pagesize;
				}
				recordInfos += "条 ";
			} else {
				recordInfos = "当前显示0 条总记录中的第0-0条";
			}
			
			$("#datatable_info_t2").html(recordInfos);
		}
      function checkSelect_t2() {//检查所有复选框
            var checklist = document.getElementsByName("index_t2");
            var haveChoose = document.getElementById("hfids_t2").value.toString();
            var haveChoose2 = new Array();
            var haveChoose2 = haveChoose.split(",");
            if (haveChoose == "") {
                for (var i = 0; i < checklist.length; i++) {
                    checklist[i].checked = 0;
                }
            } else {
                for (var i = 0; i < checklist.length; i++) {
                    for (var j = 0; j < haveChoose2.length; j++) {
                        if (checklist[i].id == haveChoose2[j]) {
                            checklist[i].checked = 1;
                        }
                    }
                }
            }
        }
  		function selectOne_t2(id, name) {//单框
            if (document.getElementById(id).checked) {
                if (document.getElementById("hfids_t2").value == "") {
                    document.getElementById("hfids_t2").value = document.getElementById("hfids_t2").value + id;
                } else {
                    document.getElementById("hfids_t2").value = document.getElementById("hfids_t2").value + "," + id;
                }
                if (document.getElementById("hname_t2").value == "") {
                    document.getElementById("hname_t2").value = document.getElementById("hname_t2").value + name;
                } else {
                    document.getElementById("hname_t2").value = document.getElementById("hname_t2").value + "," + name;
                }
            } else {
                var p = document.getElementById("hfids_t2").value.toString();
                var pp = p.split(",");
                if (pp[0] == id) {
                    var strings = p.replace(id+",", "");
                    document.getElementById("hfids_t2").value = strings;
                }else{
                    var strings = p.replace("," + id, "");
                    document.getElementById("hfids_t2").value = strings;
                }

                var p2 = document.getElementById("hname_t2").value.toString();
                var pp2 = p2.split(",");
                if (pp2[0] == name) {
                    var strings2 = p2.replace(name + ",", "");
                    document.getElementById("hname_t2").value = strings2;
                } else {
                    var strings2 = p2.replace("," + name, "");
                    document.getElementById("hname_t2").value = strings2;
                }
            }
            document.getElementById("firstcheckbox_t2").checked = false;
   		}
		function selectAll_t2() {//全选框
            if (document.getElementById("firstcheckbox_t2").checked) {
                document.getElementById("hfids_t2").value = $("#allchooseId_t2").val();
                
                document.getElementById("hname_t2").value = $("#allchooseName_t2").val();
                var checklist = document.getElementsByName("index_t2");
                for (var i = 0; i < checklist.length; i++) {
                    checklist[i].checked = 1;
                }
            } else {
                document.getElementById("hfids_t2").value = "";
                document.getElementById("hname_t2").value = "";
                var checklist = document.getElementsByName("index_t2");
                for (var i = 0; i < checklist.length; i++) {
                    checklist[i].checked = 0;
                }
            }
		}
   		//保存新增
		function savexinzeng_yg(){
			var html="";
			var siteId="<%=request.getAttribute("siteId")%>";
			if(document.getElementById("hfids_t2").value != "" && document.getElementById("hname_t2").value != ""){
				var ids = document.getElementById("hfids_t2").value;
				var reqmsg="{'action':'ADD_EMPLOYEE_INFO_REQUEST','content':{\"changeEmployeesIds\":\""+ids + "\",\"changesiteId\":"+siteId+"}}";

				jQuery.ajax({
          			type : "post",
          			async:true,
          			url : "employee.do?handler",
         			dataType : "json",
          			data: {
               			"reqmsg":reqmsg
          			},
          		success : function(data){
                   if(data.result=="100"){
                    	alert(data.des);
            	  		query2();
               		}else{
                 		alert(data.des);
              		}
          		},
          		error:function(){
	     		      alert("error");
         		 }
    		    });
			}
		}
		
		
		/**所辖会员页签**/
		//根据排序规则重新查询
		function queryBySort3(par,column){
			var classFlag = listSortClickEvent(par);
			var type = judgmentChinese(column);
			if(type != null && type != ""){
				classFlag = type + classFlag;
				column = column.substr(8,column.length);
			}
			$("#sortType3").val(classFlag);
			$("#sortColumn3").val(column);
			go2page3(currentshownpage3);
		}
		var currentshownpage3 = 1;
		function selectAll3() {
			if ($("#allselectchecker3").is(':checked')) {
				$(".col_selector3").prop("checked", true);
			} else {
				$(".col_selector3").prop("checked", false);
			}
		}
		//查询所辖会员
		function query3() {
			go2page3(1);
		}
		function go2page3(pagenumber){
			var pagesize = $("#pageSizeSelector3 option:selected").val();
			var name2search = $("#name_input3").val();
			var idNumber = $("#idNumber3").val();
			var sex = $("#sex3").val();
			
			var age1 = $("#age13").val();
			var age2 = $("#age23").val();
			var reg = new RegExp("^[0-9]*$"); 
		    if(age1 != "" && !reg.test(age1)){  
		        alert("请输入符合规范的年龄");  
		        return;
		    }  
		    if(age2 != "" && !reg.test(age2)){  
		        alert("请输入符合规范的年龄");  
		        return;
		    }  
			if(age1 != "" && age2 != "" && age1>age2){
				alert("最大年龄不能小于最小年龄");
				return;
			}
			var d = new Date();
			var nowYear = d.getFullYear();
			var year1="";
			var year2="";
			if($.trim(age1) != ""){
				 year1= nowYear- age1 + "0101";
			}
			if($.trim(age2) != ""){
				 year2= nowYear- age2 + "0101";
			}
			
			var customerSource = "";
			if($("#customerSource3").val() != ""){
				customerSource = $("#customerSource3").val();
			}
			var customerState = "";
			if($("#customerState3").val() != ""){
				customerState =	$("#customerState3").val();
			}
			var reqmsg="{'action':'QUERY_OLDER_LIST_REQUEST',";
			
			var sortType = $("#sortType3").val();
			var sortColumn = $("#sortColumn3").val();
			if(sortType != null && sortType != ""){
				if(sortColumn == "birthdate"){
					if(sortType == "desc"){
						sortType = "asc";
					}else if(sortType == "asc"){
						sortType = "desc";
					}
				}
				reqmsg += "'order':[{'column':'" + sortColumn + "','type':'" + sortType + "'}],";
			}
			
			reqmsg += "'page':{'pageno':'" + pagenumber + "','pagesize':'" + pagesize + "'},'content':{";
			
			var siteId = "<%=request.getAttribute("siteId")%>";
		
			if (name2search != null && name2search != "") {
				reqmsg += "\"name_like\":\"" + name2search + "\",";
			}
			if (idNumber != null && idNumber != "") {
				reqmsg += "\"memberNum_like\":\"" + idNumber + "\",";
			}
			if (sex != null && sex != "") {
				reqmsg += "\"gender\":\"" + sex + "\",";
			}
			if (year1 != null && year1 != "") {
				reqmsg += "\"birthdate_le\":\"" + year1 + "\",";
			}
			if (year2 != null && year2 != "") {
				reqmsg += "\"birthdate_ge\":\"" + year2 + "\",";
			}
			if (customerSource != null && customerSource != "") {
				reqmsg += "\"memberSource_like\":\"" + customerSource + "\",";
			}
			if (customerState != null && customerState != "") {
				reqmsg += "\"memberStatus\":" + customerState + ",";
			}
			if (siteId != null && siteId != "") {
				reqmsg += "\"siteIdsQuery\":\"" + siteId + "\",";
			}
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:true,
		          url : "older.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		            	  changeData3(data);
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		function changeData3(data){
			var htmlcode = "";
			if (data.content != null) {
				jQuery.each(data.content.olderList, function(i, item) {
					htmlcode += "<tr class=\"gradeA odd\"><td><input type=\"checkbox\" value=\"" + item.id + "\" class=\"col_selector3\"></td>";		
				    htmlcode += "<td>" + item.memberNum + "</td>";	
				    htmlcode += "<td>" + item.name + "</td>";
				    htmlcode += "<td>" + item.gender + "</td>";		
				    htmlcode += "<td>" + getAge(item.birthdate) + "</td>";				
				    htmlcode += "<td>" + item.memberSource + "</td>";		
				    htmlcode += "<td>" + khztChange(item.memberStatus) + "</td>";	
				    
				    if((item.homeTel == null || item.homeTel == "") && (item.mobileTel == null || item.mobileTel == "")){
				    	htmlcode += "<td></td>";
				    }else if((item.homeTel != null && item.homeTel != "") && (item.mobileTel == null || item.mobileTel == "")){
				    	htmlcode += "<td>" + item.homeTel + "</td>";
				    }else if((item.homeTel == null || item.homeTel == "") && (item.mobileTel != null && item.mobileTel != "")){
				    	htmlcode += "<td>" + item.mobileTel + "</td>";
				    }else{
				    	htmlcode += "<td>" + item.homeTel + "/" + item.mobileTel + "</td>";
				    }
				    
					htmlcode += "<td><div class=\"btn-group\">";
					htmlcode += "<button class=\"btn btn-default btn-xs\" type=\"button\">操作</button>";
					htmlcode += "<button data-toggle=\"dropdown\" class=\"btn btn-xs btn-primary dropdown-toggle\" type=\"button\">";
					htmlcode += "<span class=\"caret\" style=\"padding:0;\"></span>";
					htmlcode += "<span class=\"sr-only\">Toggle Dropdown</span>";
					htmlcode += "</button>";
					htmlcode += "<ul role=\"menu\" class=\"dropdown-menu pull-right\">";
					var headUrl = "<%=request.getContextPath()%>";
					<c:if test="${older_edit_opt_control != 'yes' or older_edit_opt_show == 'yes'}">
					htmlcode += "<li><a href=\""+headUrl+"/daeOlder.do?main&id="+item.id+"\" target=\"_blank\">查看详情</a></li>";
					</c:if>	
					<c:if test="${older_delOldMan_opt_control != 'yes' or older_delOldMan_opt_show == 'yes'}">
					htmlcode += "<li onclick=\"deleteOneOldMan('" + item.id + "')\"><a href=\"###\">删除</a></li>";
					</c:if>	
					htmlcode += "</ul>";
					htmlcode += "</div></td>";		
					htmlcode += "</tr>";
				
				});
			}
			
			$("#datacontainer3").html(htmlcode);
			if (data.page != null) {
				genaratePaginateHtml3(data.page.pageno, data.page.pageCount);
				genarateRecordNumberHtml3(data.page.pageno, data.page.pagesize, data.page.recordCount);
			} else {
				genaratePaginateHtml3(1, 1);
				genarateRecordNumberHtml3(1, 10, 0);
			}
		}
		//单个删除所属会员
		function deleteOneOldMan(olderId) {
			var name = $("#addUserName").val();
			if(name == "" || name == null){
				alert("当前非员工,无法操作");
				return;
			}
			var siteId = "<%=request.getAttribute("siteId")%>";
			if (confirm("是否确认删除?"))  {  
				jQuery.ajax({
		          	type : "post",
		          	async:true,
		          	url : "olderSite.do?delByIds",
		         	dataType : "json",
		          	data: {
		               	"olderIds":olderId,
		               	"siteId":siteId
		          	},
		          	success : function(data){
		                if(data.result == "100"){
		                    alert(data.des);
		            	  	go2page3(currentshownpage3);
		               	}else{
		                 	alert(data.des);
		              	}
		          	},
		          	error:function(){
			     		alert("error");
		         	}
		    	});
		    }
		}
		//批量删除所属会员
		function deleteOldMan() {
			var name = $("#addUserName").val();
			if(name == "" || name == null){
				alert("当前非员工,无法操作");
				return;
			}
			var siteId = "<%=request.getAttribute("siteId")%>";
			var selectedItemNumber = $("tbody .col_selector3:checked").length;
			if (selectedItemNumber >= 1) {
				var ids2del = "";
				$("tbody .col_selector3:checked").each(function() {
					ids2del += $(this).val() + ",";
				});
				if (ids2del != "") {
					ids2del = ids2del.substring(0, ids2del.length - 1);
				}
			  if (confirm("是否确认删除?"))  {  
				jQuery.ajax({
					type:"post",
					url:"olderSite.do?delByIds",
					async:true,
					dataType:"json",
					data:{
						"olderIds":ids2del,
		               	"siteId":siteId
					},
					success:function(data) {
						alert(data.des);
						if (data.result == "success") {
							go2page3(currentshownpage3);
						}else{
		                    alert("删除失败");
		                }
					},
					error:function() {
						alert("error");
					}
				});
				}
			} else {
				alert("请选择要删除的数据");
			}
		}
		//根据出生年月日计算年龄yyyymmdd
		function getAge(strBirthday){
			if(strBirthday == null || strBirthday == ""){
				return "";
			}
			var birthYear = strBirthday.substr(0,4);
			var d = new Date();
			var nowYear = d.getFullYear();
			var age = nowYear-birthYear;
			return age;
		}
		//客户状态
		function khztChange(id){
			var name="未知";
	     	switch (id)
			{
				case 0:
	  			name="正常";
	  			break;
	  			
				case 1:
	  			name="审核不通过";
	  			break;
	
				case 2:
	  			name="待评估";
	  			break;
	  			
	  			default:
	  			break;
			}
			return name;
		}
		/**
		 * 生成记录数信息
		 * @method genarateRecordNumberHtml3
		 * @param {Number} currentpage 当前页
		 * @param {Number} pagesize 每页记录条目数
		 * @param {Number} totalRecord 总记录数
		 */
		function genarateRecordNumberHtml3(currentpage, pagesize, totalRecord) {
			var recordInfos = "";
			if (totalRecord > 0) {
			    recordInfos = "当前显示" + totalRecord + "条总记录";
				recordInfos += "中第" + ((currentpage - 1) * pagesize + 1) + "-";
				if (currentpage * pagesize > totalRecord) {
					recordInfos += totalRecord;
				} else {
					recordInfos += currentpage * pagesize;
				}
				recordInfos += "条 ";
			} else {
				recordInfos = "当前显示0 条总记录中的第0-0条";
			}
			
			$("#datatable_info3").html(recordInfos);
		}
		/**
		 * 生成分页信息
		 * @method genaratePaginateHtml3
		 * @param {Number} currentpage 当前页
		 * @param {Number} totalpage 总页数
		 */
		function genaratePaginateHtml3(currentpage, totalpage, pagesize) {
			currentshownpage3 = currentpage;
		
			var htmlcode = "";
			
			//上一页
			if (currentpage > 1) {
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page3('1')\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page3('" + (currentpage - 1) + "')\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			} else {
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			}
			
			//具体页码
			if (totalpage <= 5) {
				for (var i = 1; i <= totalpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page3('" + i + "')\">" + i + "</a></li>";
					}
				}
			} else {
				var startpage = currentpage;
				var endpage = currentpage;
				while (true) {
					if (endpage - startpage >= 4) {
						break;
					} else {
						if (startpage > 1) {
							startpage = startpage - 1;
						}
						if (endpage < totalpage) {
							endpage = endpage - (-1);
						}
					}
				}
				
				for (var i = startpage; i <= endpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page3('" + i + "')\">" + i + "</a></li>";
					}
				}
			}
			
			//下一页
			if (totalpage > currentpage) {
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page3('" + (parseInt(currentpage) + 1) + "')\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page3('" + parseInt(totalpage) + "')\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			} else {
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			}
			$("#paginationArea3").html(htmlcode);
		}
		//新增会员弹窗模块
		//获取市信息
        function getquyushixinxiOldMan(id){
        	var result = new Array();
    		result = getAddresses(id);
        	var html = "";
        	html +="<option value=\"\">市</option>";
        	for(var i=0;i<result.length;i++){
        		html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
        	}
        	$("#quyushi_inputOldMan").html(html);
        }
        //获取区信息
        function getquyuquxinxiOldMan(id){
        	var result = new Array();
    		result = getAddresses(id);
        	var html = "";
        	html +="<option value=\"\">区</option>";
        	for(var i=0;i<result.length;i++){
        		html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
        	}
        	$("#quyuqu_inputOldMan").html(html);
        }
        //获取街道信息
        function getquyujiedaoxinxiOldMan(id){
        	var result = new Array();
    		result = getAddresses(id);
        	var html = "";
        	html +="<option value=\"\">街道</option>";
        	for(var i=0;i<result.length;i++){
        		html+="<option value=\""+result[i].id+"\">"+result[i].name+"</option>";
        	}
        	$("#quyujiedao_inputOldMan").html(html);
        }
		function addOldMan(){
		   	queryOldMan();
		}
	    var currentshownpageOldMan = 1;
	    function queryOldMan() {
		   go2pageOldMan(1);
	    }
	    function go2pageOldMan(pagenumber){
			var pagesize = $("#pageSizeSelectorOldMan option:selected").val();
			var quyushen_input = $("#quyushen_inputOldMan").val();
	 		var quyushi_input = $("#quyushi_inputOldMan").val();
	 		var quyuqu_input = $("#quyuqu_inputOldMan").val();
	 		var quyujiedao_input = $("#quyujiedao_inputOldMan").val();
			
			var reqmsg = "{'action':'QUERY_OLDER_LIST_REQUEST',";
			reqmsg += "'page':{'pageno':'" + pagenumber + "','pagesize':'" + pagesize + "'},'content':{";
			if (quyushen_input != null && quyushen_input != "") {
				reqmsg += "\"serviceProvinceId\":" + quyushen_input + ",";
			}
			if (quyushi_input != null && quyushi_input != "") {
				reqmsg += "\"serviceCityId\":" + quyushi_input + ",";
			}
			if (quyuqu_input != null && quyuqu_input != "") {
				reqmsg += "\"serviceAreaId\":" + quyuqu_input + ",";
			}
			if (quyujiedao_input != null && quyujiedao_input != "") {
				reqmsg += "\"serviceStreetId\":" + quyujiedao_input + ",";
			}
		
		    reqmsg += "}}";
	
		    jQuery.ajax({
		          type : "post",
		          async:true,
		          url : "older.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des == "success"){
		            	  changeDataOldMan(data);
		              }else{
		                  alert("查询老人信息失败");
		              }
		          },
		          error:function(){
			           alert("查询老人信息失败");
		          }
		     });
		}
		function changeDataOldMan(data){
			var htmlcode = "";
			if (data.content != null) {
				jQuery.each(data.content.olderList, function(i, item) {
					htmlcode += "<tr><td class=\"btn btn-primary btn-md\" style=\"color:#fff;\" onclick=\"saveNewMember(" + item.id + ")\">选择</td>";
				    htmlcode += "<td>" + item.name + "</td>";//姓名
				    htmlcode += "<td>" + item.gender + "</td>";//性别
				    if(item.homeTel != null && item.homeTel != "" && item.mobileTel != null && item.mobileTel != ""){
				    	htmlcode += "<td>" + item.homeTel+" / "+ item.mobileTel+ "</td>";//联系方式
				    }else if((item.homeTel != null && item.homeTel != "") && (item.mobileTel == null || item.mobileTel == "")){
				    	htmlcode += "<td>" + item.homeTel + "</td>";//联系方式
				    }else if((item.mobileTel != null && item.mobileTel != "") && ((item.homeTel == null || item.homeTel == ""))){
				    	htmlcode += "<td>" + item.mobileTel + "</td>";//联系方式
				    }else{
				    	htmlcode += "<td></td>";//联系方式
				    }
				    htmlcode += "<td>" + item.idnumber + "</td>";//身份证
					htmlcode += "</tr>";
				});
			}
			$("#datacontainerOldMan").html(htmlcode);
			
			if (data.page != null) {
				genaratePaginateHtmlOldMan(data.page.pageno, data.page.pageCount);
				genarateRecordNumberHtmlOldMan(data.page.pageno, data.page.pagesize, data.page.recordCount);
			} else {
				genaratePaginateHtmlOldMan(1, 1);
				genarateRecordNumberHtmlOldMan(1, 10, 0);
			}
		}
		//保存新增会员
		function saveNewMember(id){
			var name = $("#addUserName").val();
			if(name == "" || name == null){
				alert("当前非员工,无法操作");
				return;
			}
			var siteId = "<%=request.getAttribute("siteId")%>";
			var reqmsg = "{'action':'ADD_OLDER_SITE_INFO_REQUEST','content':{";
			reqmsg += "'olderId':" + id + ",";
			reqmsg += "'siteId':" + siteId;
			reqmsg += "}}";
			
			jQuery.ajax({
	          type : "post",
	          async:true,
	          url : "olderSite.do?handler",
	          dataType : "json",
	          data: {
	               "reqmsg":reqmsg
	          },
	          success : function(data){
	          	  alert(data.des);
	              if(data.result == "success"){
	            	  go2page3(currentshownpage3);
	            	  $("#closeOldMan").click();
	              }
	          },
	          error:function(){
		           alert("保存新增会员失败");
	          }
	       });
		}
		/**
		 * 生成记录数信息
		 * @method genarateRecordNumberHtml
		 * @param {Number} currentpage 当前页
		 * @param {Number} pagesize 每页记录条目数
		 * @param {Number} totalRecord 总记录数
		 */
		function genarateRecordNumberHtmlOldMan(currentpage, pagesize, totalRecord) {
			var recordInfos = "";
			if (totalRecord > 0) {
			    recordInfos = "当前显示" + totalRecord + "条总记录";
				recordInfos += "中第" + ((currentpage - 1) * pagesize + 1) + "-";
				if (currentpage * pagesize > totalRecord) {
					recordInfos += totalRecord;
				} else {
					recordInfos += currentpage * pagesize;
				}
				recordInfos += "条 ";
			} else {
				recordInfos = "当前显示0 条总记录中的第0-0条";
			}
			
			$("#datatable_infoOldMan").html(recordInfos);
		}
		
		/**
		 * 生成分页信息
		 * @method genaratePaginateHtml
		 * @param {Number} currentpage 当前页
		 * @param {Number} totalpage 总页数
		 */
		function genaratePaginateHtmlOldMan(currentpage, totalpage, pagesize) {
			currentshownpageOldMan = currentpage;
		
			var htmlcode = "";
			
			//上一页
			if (currentpage > 1) {
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2pageOldMan('1')\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2pageOldMan('" + (currentpage - 1) + "')\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			} else {
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			}
			
			//具体页码
			if (totalpage <= 5) {
				for (var i = 1; i <= totalpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2pageOldMan('" + i + "')\">" + i + "</a></li>";
					}
				}
			} else {
				var startpage = currentpage;
				var endpage = currentpage;
				while (true) {
					if (endpage - startpage >= 4) {
						break;
					} else {
						if (startpage > 1) {
							startpage = startpage - 1;
						}
						if (endpage < totalpage) {
							endpage = endpage - (-1);
						}
					}
				}
				
				for (var i = startpage; i <= endpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2pageOldMan('" + i + "')\">" + i + "</a></li>";
					}
				}
			}
			
			//下一页
			if (totalpage > currentpage) {
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2pageOldMan('" + (parseInt(currentpage) + 1) + "')\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2pageOldMan('" + parseInt(totalpage) + "')\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			} else {
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			}
			$("#paginationAreaOldMan").html(htmlcode);
		}
		
		
		/**历史服务页签**/
		//根据排序规则重新查询
		function queryBySort5(par,column){
			var classFlag = listSortClickEvent(par);
			var type = judgmentChinese(column);
			if(type != null && type != ""){
				classFlag = type + classFlag;
				column = column.substr(8,column.length);
			}
			$("#sortType5").val(classFlag);
			$("#sortColumn5").val(column);
			go2page5(currentshownpage5);
		}
		//只能输入数字0-9
        function keyPress() {
            var theEvent = window.event || arguments.callee.caller.arguments[0];
    		var keyCode = theEvent.keyCode || theEvent.which;
    		if ((keyCode < 48 || keyCode > 57) && keyCode != 8 && keyCode != 37 && keyCode != 39) {
               theEvent.preventDefault();
            }
        }
        function addshuizhong(){
	   	   var addhtml = '<tr><td ><input class="form-control datetime" size="16"  type="text"></td><td><a class="label label-danger" onclick="$(this).parent().parent().remove();" ><i class="fa fa-times"></i></a></td></tr>';
	   	   $(addhtml).insertBefore("#addshuizhong"); 
	   	   var config = {dateTime:true};  //初始化新增的datepicker，不会导致格式错乱
	       $( ".ui-datepicker" ).datepicker();
	       if(config.dateTime){
	     	  $(".datetime").datetimepicker({autoclose: true});
	   	   }
	    }
   		var currentshownpage5 = 1;
	    function selectAll5() {
			if ($("#allselectchecker5").is(':checked')) {
				$(".col_selector5").prop("checked", true);
			} else {
				$(".col_selector5").prop("checked", false);
			}
		}
		//查询历史服务信息
		function query5() {
			go2page5(1);
		}
		function go2page5(pagenumber){
			var pagesize = $("#pageSizeSelector5 option:selected").val();
			var oldinput_search = $.trim($("#oldinput_search").val());
			var fwxminput_Id = $("#fwxminput_Id").val();
			var fwxminput_search = $("#fwxminput_search").val();
			var fuwustate_input = $("#fuwustate_input").val();
			var fuwutype_input = $("#fuwutype_input").val();
			var fuwugdbh_input = $("#fuwugdbh_input").val();
			
			var pgrinputId = $("#pgrinputId").val();
			if($.trim($("#pgrinput_search").val()) == ""){
				$("#pgrinputId").val("");
				pgrinputId = "";
			}
			var reqmsg="{'action':'QUERY_SERVICE_TASK_LIST_REQUEST',";
			
			var sortType = $("#sortType5").val();
			var sortColumn = $("#sortColumn5").val();
			if(sortType != null && sortType != ""){
				reqmsg += "'order':[{'column':'" + sortColumn + "','type':'" + sortType + "'}],";
			}
			
			reqmsg += "'page':{'pageno':'" + pagenumber + "','pagesize':'" + pagesize + "'},'content':{\"serviceListShow\":\"true\",\"serviceEmployeeListShow\":\"true\",";
			
			reqmsg += "\"source_isNull\":\"null\",";
			var siteId="<%=request.getAttribute("siteId")%>";
			if (siteId != null && siteId != "") {
				reqmsg += "\"siteId\":" + siteId + ",";
			}
			if (oldinput_search != null && oldinput_search != "") {
				reqmsg += "\"olderName_like\":\"" + oldinput_search + "\",";
			}
			if (fwxminput_Id != null && fwxminput_Id != "") {
				reqmsg += "\"serviceId\":" + fwxminput_Id + ",";
			}
			if((fwxminput_search != "" && fwxminput_search != null) && (fwxminput_Id == "" || fwxminput_Id == null)){
				reqmsg += "\"serviceId\":0,";
			}
			if (fuwustate_input != null && fuwustate_input != "") {
				reqmsg += "\"status_in\":\"" + fuwustate_input + "\",";
			}
			if (fuwutype_input != null && fuwutype_input != "") {
				reqmsg += "\"healthInsurance\":" + fuwutype_input + ",";
			}
			if (fuwugdbh_input != null && fuwugdbh_input != "") {
				reqmsg += "\"serviceCode\":\"" + fuwugdbh_input + "\",";
			}
			if (pgrinputId != null && pgrinputId != "") {
				reqmsg += "\"chargeEmployeeId\":" + pgrinputId + ",";
			}
			
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:true,
		          url : "serviceTask.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		            	  changeData5(data);
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		/**
		 * 格式化时间
		 * @method formateTime
		 * @param {String} time 时间信息(YYYYMMDDHHmmSS)
		 * @return 格式化的时间(YYYY-MM-DD HH:mm:SS)
		 */
		function formateTime(time) {
			if (time != null && time.length == 14) {
				return time.substring(0, 4) + "-" + time.substring(4, 6) + "-" + time.substring(6, 8) + " " + time.substring(8, 10) + ":" + time.substring(10, 12) + ":" + time.substring(12, 14);
			} else {
				return time;
			}
		}
		function changeData5(data){
			var htmlcode = "";
			if (data.content != null) {
				var fwxm = "";
				var fzrName = "";
				jQuery.each(data.content.serviceTaskList, function(i, item) {
					htmlcode += "<tr class=\"gradeA odd\"><td><input type=\"checkbox\" value=\"" + item.id + "\" class=\"col_selector5\"></td>";		
				    htmlcode += "<td>" + item.serviceCode + "</td>";
				    htmlcode += "<td>" + item.olderName + "</td>";
				    fwxm = "";
				    jQuery.each(item.serviceList, function(j, item2) {
				    	fwxm += item2.name + ",";
				    });
				    if(fwxm != ""){
				    	fwxm = fwxm.substr(0,fwxm.length-1);
				    }
				    htmlcode += "<td>" + fwxm + "</td>";
				    
				    jQuery.each(item.serviceEmployeeList, function(z, item3) {
				    	if(item3.type == "1"){
				    		fzrName = item3.name;
				    	}
				    });
				    htmlcode += "<td>" + fzrName + "</td>";
				    fzrName = "";
				    
				    htmlcode += "<td>" + fwstateChange(item.status) + "</td>";				
				    htmlcode += "<td>" + fwlbChange(item.healthInsurance) + "</td>";
				    htmlcode += "<td>" + formateTime(item.serviceStartTime) + "</td>";
				   
					htmlcode += "<td><div class=\"btn-group\">";
					htmlcode += "<button class=\"btn btn-default btn-xs\" type=\"button\">操作</button>";
					htmlcode += "<button data-toggle=\"dropdown\" class=\"btn btn-xs btn-primary dropdown-toggle\" type=\"button\">";
					htmlcode += "<span class=\"caret\" style=\"padding:0;\"></span>";
					htmlcode += "<span class=\"sr-only\">Toggle Dropdown</span>";
					htmlcode += "</button>";
					htmlcode += "<ul role=\"menu\" class=\"dropdown-menu pull-right\">";
					var headUrl = "<%=request.getContextPath()%>";
					<c:if test="${serviceTask_queryXQ_opt_control != 'yes' or serviceTask_queryXQ_opt_show == 'yes'}">
					htmlcode += "<li><a href=\""+headUrl+"/serviceTask.do?mainXQ&id="+item.id+"\" target=\"_blank\">查看详情</a></li>";
					</c:if>	
					<c:if test="${serviceTask_del_opt_control != 'yes' or serviceTask_del_opt_show == 'yes'}">
					htmlcode += "<li onclick=\"del25('" + item.id + "')\"><a href=\"###\">删除</a></li>";
					</c:if>	
					<c:if test="${serviceTask_qx_opt_control != 'yes' or serviceTask_qx_opt_show == 'yes'}">
					htmlcode += "<li onclick=\"quxiao_qingkong2('" + item.id + "')\"><a href=\"###\">取消</a></li>";
					</c:if>	
					htmlcode += "</ul>";
					htmlcode += "</div></td>";		
					htmlcode += "</tr>";
				});
			}
			$("#datacontainer5").html(htmlcode);
			if (data.page != null) {
				genaratePaginateHtml5(data.page.pageno, data.page.pageCount);
				genarateRecordNumberHtml5(data.page.pageno, data.page.pagesize, data.page.recordCount);
			} else {
				genaratePaginateHtml5(1, 1);
				genarateRecordNumberHtml5(51, 10, 0);
			}
		}
		//服务状态
		function fwstateChange(id){
			var name="未知";
	     	switch (id)
			{
				case 1:
	  			name="取消";
	  			break;
	  			
				case 2:
	  			name="待排班";
	  			break;
	  			
	  			case 3:
	  			name="待审核";
	  			break;
	  			
	  			case 4:
	  			name="审核通过";
	  			break;
	  			
	  			case 5:
	  			name="服务开始";
	  			break;
	  			
	  			case 6:
	  			name="服务结束";
	  			break;
	  			
	  			case 7:
	  			name="回访结束";
	  			break;
	  			
	  			default:
	  			break;
			}
			return name;
		}
		//服务类别
		function fwlbChange(id){
			var name="未知";
	     	switch (id)
			{
				case 1:
	  			name="医保";
	  			break;
	  			
				case 2:
	  			name="市场";
	  			break;
	  			
	  			default:
	  			break;
			}
			return name;
		}
		/**
		 * 生成记录数信息
		 * @method genarateRecordNumberHtml5
		 * @param {Number} currentpage 当前页
		 * @param {Number} pagesize 每页记录条目数
		 * @param {Number} totalRecord 总记录数
		 */
		function genarateRecordNumberHtml5(currentpage, pagesize, totalRecord) {
			var recordInfos = "";
			if (totalRecord > 0) {
			    recordInfos = "当前显示" + totalRecord + "条总记录";
				recordInfos += "中第" + ((currentpage - 1) * pagesize + 1) + "-";
				if (currentpage * pagesize > totalRecord) {
					recordInfos += totalRecord;
				} else {
					recordInfos += currentpage * pagesize;
				}
				recordInfos += "条 ";
			} else {
				recordInfos = "当前显示0 条总记录中的第0-0条";
			}
			
			$("#datatable_info5").html(recordInfos);
		}
		/**
		 * 生成分页信息
		 * @method genaratePaginateHtml5
		 * @param {Number} currentpage 当前页
		 * @param {Number} totalpage 总页数
		 */
		function genaratePaginateHtml5(currentpage, totalpage, pagesize) {
			currentshownpage5 = currentpage;
		
			var htmlcode = "";
			
			//上一页
			if (currentpage > 1) {
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page5('1')\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre\"><a href=\"#\" onclick=\"go2page5('" + (currentpage - 1) + "')\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			} else {
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;首页</a></li>";
				htmlcode += "<li class=\"pre disabled\"><a href=\"#\"><span class=\"fa fa-angle-left\"></span>&nbsp;上一页</a></li>";
			}
			
			//具体页码
			if (totalpage <= 5) {
				for (var i = 1; i <= totalpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page5('" + i + "')\">" + i + "</a></li>";
					}
				}
			} else {
				var startpage = currentpage;
				var endpage = currentpage;
				while (true) {
					if (endpage - startpage >= 4) {
						break;
					} else {
						if (startpage > 1) {
							startpage = startpage - 1;
						}
						if (endpage < totalpage) {
							endpage = endpage - (-1);
						}
					}
				}
				
				for (var i = startpage; i <= endpage; i++) {
					if (currentpage == i) {
						htmlcode += "<li class=\"active\"><a href=\"#\">" + i + "</a></li>";
					} else {
						htmlcode += "<li><a href=\"#\" onclick=\"go2page5('" + i + "')\">" + i + "</a></li>";
					}
				}
			}
			
			//下一页
			if (totalpage > currentpage) {
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page5('" + (parseInt(currentpage) + 1) + "')\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next\"><a href=\"#\" onclick=\"go2page5('" + parseInt(totalpage) + "')\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			} else {
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">下一页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
				htmlcode += "<li class=\"next disabled\"><a href=\"#\">末页&nbsp;<span class=\"fa fa-angle-right\"></span></a></li>";
			}
			$("#paginationArea5").html(htmlcode);
		}
		//批量删除历史服务
		function doDel5() {
			var name = $("#addUserName").val();
			if(name == "" || name == null){
				alert("当前非员工,无法操作");
				return;
			}
			var selectedItemNumber = $("tbody .col_selector5:checked").length;
			if (selectedItemNumber >= 1) {
				var ids2del = "";
				$("tbody .col_selector5:checked").each(function() {
					ids2del += $(this).val() + ",";
				});
				if (ids2del != "") {
					ids2del = ids2del.substring(0, ids2del.length - 1);
				}
			  if (confirm("是否确认删除?"))  {  
				jQuery.ajax({
					type:"post",
					url:"serviceTask.do?del",
					async:true,
					dataType:"json",
					data:{ids:ids2del},
					success:function(data) {
						alert(data.des);
						if (data.result == "success") {
							go2page5(currentshownpage5);
						}else if(data.des=="failure"){
		                 alert("删除失败");
		                }
					},
					error:function() {
						alert("error");
					}
				});
				}
			} else {
				alert("请选择要删除的数据");
			}
		}
		//单个删除历史服务
		function del25(id) {
			var name = $("#addUserName").val();
			if(name == "" || name == null){
				alert("当前非员工,无法操作");
				return;
			}
			  if (confirm("是否确认删除?"))  {  
				jQuery.ajax({
					type:"post",
					url:"serviceTask.do?del",
					async:true,
					dataType:"json",
					data:{ids:id},
					success:function(data) {
						alert(data.des);
						if (data.result == "success") {
							go2page5(currentshownpage5);
						}else if(data.des=="failure"){
		                 alert("删除失败");
		                }
					},
					error:function() {
						alert("error");
					}
				});
			}
		}
		
		//实时获取老人姓名
		function getolderName(){
			var reqmsg="{'action':'QUERY_OLDER_LIST_REQUEST','page':{'pageno':'1','pagesize':'5'},'content':{";
			var name = $.trim($("#oldinput_search").val());
			if (name != null && name != "") {
				reqmsg += "\"name_like\":\"" + name + "\"";
			}else{
				$("#hideul_nei1").html("");
				$("#hideul-1").hide();
				return;
			}
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "older.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		              	  	 if(data.content.olderList != null){
		            	  		jQuery.each(data.content.olderList, function(i, item) {
		            	  				if(item != null){
				    						htmlcode += "<li onclick=\"olderNamefuzhi('" + item.name + "')\">" + item.name + "</li>";		
		            	  				}	
				    	  		});
				    	 	 }
				    	  }
				    	  $("#hideul_nei1").html(htmlcode);
				    	  $("#hideul-1").show();
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		//老人姓名赋值
		function olderNamefuzhi(name){
			$("#oldinput_search").val(name);
			$("#hideul_nei1").html("");
			$("#hideul-1").hide();
		}
		
		//实时获取服务项目
		function getFWXM(){
			var reqmsg="{'action':'QUERY_SERVICE_LIST_REQUEST','page':{'pageno':'1','pagesize':'5'},'content':{";
			//reqmsg += "\"status\":1,";
			reqmsg += "\"deleted\":0,";
			var name = $("#fwxminput_search").val();
			if (name != null && name != "") {
				reqmsg += "\"name_like\":\"" + name + "\"";
			}else{
				$("#hideul_nei2").html("");
				$("#hideul-2").hide();
				return;
			}
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "service.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		              	  	 if(data.content.serviceList != null){
		            	  		jQuery.each(data.content.serviceList, function(i, item) {
		            	  				if(item != null){
				    						htmlcode += "<li onclick=\"fwxmNamefuzhi('" + item.name + "','" + item.id + "')\">" + item.name + "</li>";		
		            	  				}	
				    	  		});
				    	 	 }
				    	  }
				    	  $("#hideul_nei2").html(htmlcode);
				    	  $("#hideul-2").show();
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		//服务项目名称赋值
		function fwxmNamefuzhi(name,id){
			$("#fwxminput_Id").val(id);
			$("#fwxminput_search").val(name);
			$("#hideul_nei2").html("");
			$("#hideul-2").hide();
		}

		//实时获取老人姓名
		function getolderName2(){
			var reqmsg="{'action':'QUERY_OLDER_LIST_REQUEST','page':{'pageno':'1','pagesize':'5'},'content':{\"olderAddressListShow\":\"true\",";
			var name = $("#oldinput_search2").val();
			if (name != null && name != "") {
				reqmsg += "\"name_like\":\"" + name + "\"";
			}else{
				$("#hideul_nei12").html("");
				$("#hideul-12").hide();
				return;
			}
			reqmsg += "}}";
			
			var address = "";
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "older.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		              	  	 if(data.content.olderList != null){
		              	  	 	jQuery.each(data.content.olderList, function(i, item) {
		            	  			if(item != null){
		            	  				if(item.olderAddressList != null){
		 									jQuery.each(item.olderAddressList, function(j, item2) {//居住地
		 										if(item2.addressType == 0){
		 											if(item2.address != "" && item2.address != null){
		 												address=getNameById(item2.provinceId)+","+getNameById(item2.cityId)+","+getNameById(item2.areaId)+","+item2.address;
		 											}else{
		 												address=getNameById(item2.provinceId)+","+getNameById(item2.cityId)+","+getNameById(item2.areaId);
		 											}
		 										}
		 									});
		 								}
				    					htmlcode += "<li onclick=\"olderNamefuzhi2(" + item.id + ",'" + item.name + "  " + item.memberNum + "','" + item.memberSource + "','" + item.name + "','" + item.mobileTel + "','" + address + "')\">" + item.name + "  " + item.memberNum + "</li>";		
		            	  			}	
				    	  		});
				    	 	 }
				    	  }
				    	  $("#hideul_nei12").html(htmlcode);
				    	  $("#hideul-12").show();
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		//老人姓名赋值
		function olderNamefuzhi2(id,namememberNum,memberSource,name,mobileTel,address){
			var oldinput_contentName = $.trim($("#oldinput_contentName").val());
			var oldinput_contentTel = $.trim($("#oldinput_contentTel").val());
			var oldinput_contentAddress = $.trim($("#oldinput_contentAddress").val());
			if(oldinput_contentName != "" || oldinput_contentTel != "" || oldinput_contentAddress != ""){
				if (confirm("是否需要覆盖老人联系人信息"))  {  
		 			$("#oldinput_contentName").val(name);
		 			$("#oldinput_contentTel").val(mobileTel);
		 			$("#oldinput_contentAddress").val(address);
		 		}
			}else{
				$("#oldinput_contentName").val(name);
		 		$("#oldinput_contentTel").val(mobileTel);
		 		$("#oldinput_contentAddress").val(address);
			}
			
			$("#olderId_hide").val(id);
			$("#oldinput_search2").val(name);
			$("#hideul_nei12").html("");
			$("#hideul-12").hide();
			if(memberSource == "医保"){
		        $("#fuwusflx_search").val("医保");
		    }else{
		        $("#fuwusflx_search").val("市场");
		    }
		    getFWXM_jiage();
		}
		
		//实时获取负责人姓名
		function getefprName(){
			var siteIds = $("#addUserSites").val();
			var reqmsg="{'action':'QUERY_EMPLOYEE_LIST_REQUEST','page':{'pageno':'1','pagesize':'5'},'content':{\"siteListShow\":\"true\",";
			var name = $("#fprinput_search").val();
			if(siteIds != "" && siteIds != null){
				reqmsg += "\"siteIds\":\"" + siteIds + "\",";
			}
			if (name != null && name != "") {
				reqmsg += "\"name_like\":\"" + name + "\"";
			}else{
				$("#hideul_nei3").html("");
				$("#hideul-3").hide();
				return;
			}
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "employee.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		              	  	 if(data.content.employeeList != null){
		            	  		jQuery.each(data.content.employeeList, function(i, item) {
		            	  			if(item != null){
				    					htmlcode += "<li onclick=\"fprNamefuzhi(" + item.id + ",'" + item.name + "  " + item.indexNum + "','" + item.name + "','" + item.roleNames +"','" + item.indexNum +"')\">" + item.name + "  " + item.indexNum + "</li>";		
		            	  			}
		            	  			if(item.siteList != null && item.siteList.length > 0){
		            	  				$("#fuzerenSiteId_hide").val(item.siteList[0].id);
		            	  				$("#fuzerenSiteName_hide").val(item.siteList[0].name);
		            	  			}
				    	  		});
				    	 	 }
				    	  }
				    	  $("#hideul_nei3").html(htmlcode);
				    	  $("#hideul-3").show();
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		//负责人姓名赋值
		function fprNamefuzhi(id,nameindexNum,name,roleNames,bianhao){
			$("#fuzerenId_hide").val(id);
			$("#fprinput_search").val(nameindexNum);
			$("#fuzerenName_hide").val(name);
			$("#fuzerenRole_hide").val(roleNames);
			$("#fuzerenBH_hide").val(bianhao);
			$("#hideul_nei3").html("");
			$("#hideul-3").hide();
		}
		
		//实时获取参与人姓名
		function getcyrName(){
			var siteIds = $("#addUserSites").val();
			var reqmsg="{'action':'QUERY_EMPLOYEE_LIST_REQUEST','page':{'pageno':'1','pagesize':'2000000'},'content':{";
			//var name = $("#cyrinput_search").val();
			//if (name != null && name != "") {
			//	reqmsg += "\"name_like\":\"" + name + "\"";
			//}else{
			//	$("#cyrinput_search").val("");
			//	return;
			//}
			if(siteIds != "" && siteIds != null){
				reqmsg += "\"siteIds\":\"" + siteIds + "\",";
			}
			
			reqmsg += "}}";
			
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "employee.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		              	  	 if(data.content.employeeList != null){
		            	  		jQuery.each(data.content.employeeList, function(i, item) {
		            	  				if(item != null){
				    						htmlcode += "<option value=\"" + item.id + "\">" + item.name + "  " + item.indexNum + "</option>";		
		            	  				}	
				    	  		});
				    	 	 }
				    	  }
				    	  $("#cyrinput_search").html(htmlcode);
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		function getFWXM_jiage(){
			var reqmsg="{'action':'QUERY_SERVICE_INFO_REQUEST','content':{";
			var fwxminput_Id4_hide = $("#fwxminput_Id4_hide").val();
			var name = $("#fwxminput_search4").val();
			if (name == null || name == "") {
				return;
			}
			if (fwxminput_Id4_hide != null && fwxminput_Id4_hide != "") {
				reqmsg += "\"id\":" + fwxminput_Id4_hide + ",";
			}else{
				return;
			}
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "service.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		            	  	if($("#fuwusflx_search").val() == "医保"){
		            	  		$("#fuwusfjg_search").html(data.content.medicalPrice);
		            	  	}else if($("#fuwusflx_search").val() == "市场"){
		            	  		$("#fuwusfjg_search").html(data.content.marketPrice);
		            	  	}
				    	  }
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		
		//实时获取服务项目
		function getFWXM4(){
			$("#fuwuzixianginput_search").html("");
			$("#fuwuzixianginput_search").val("").trigger("change");
			var reqmsg="{'action':'QUERY_SERVICE_LIST_REQUEST','page':{'pageno':'1','pagesize':'5'},'content':{";
			reqmsg += "\"status\":1,";
			reqmsg += "\"deleted\":0,";
			var name = $("#fwxminput_search4").val();
			if (name != null && name != "") {
				reqmsg += "\"name_like\":\"" + name + "\"";
			}else{
				$("#hideul_nei24").html("");
				$("#hideul-24").hide();
				return;
			}
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "service.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		              	  	 if(data.content.serviceList != null){
		            	  		jQuery.each(data.content.serviceList, function(i, item) {
		            	  				if(item != null){
				    						htmlcode += "<li onclick=\"fwxmNamefuzhi4('" + item.name + "','" + item.id + "'," + item.marketPrice + "," + item.medicalPrice + ")\">" + item.name + "</li>";		
		            	  				}	
				    	  		});
				    	 	 }
				    	  }
				    	  $("#hideul_nei24").html(htmlcode);
				    	  $("#hideul-24").show();
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		//服务项目名称赋值4
		function fwxmNamefuzhi4(name,id,marketPrice,medicalPrice){
			if($("#fuwusflx_search").val() == "医保"){
		        $("#fuwusfjg_search").html(medicalPrice);
		    }else if($("#fuwusflx_search").val() == "市场"){
		        $("#fuwusfjg_search").html(marketPrice);
		    }
			$("#fwxminput_Id4_hide").val(id);
			$("#fwxminput_search4").val(name);
			$("#fwxminput_SCPRICE4_hide").val(marketPrice);
			$("#fwxminput_YBPRICE4_hide").val(medicalPrice);
			$("#hideul_nei24").html("");
			$("#hideul-24").hide();
			
			var reqmsg="{'action':'QUERY_SERVICE_CHILD_LIST_REQUEST','page':{'pageno':'1','pagesize':'1000'},'content':{";
			reqmsg += "\"serviceId\":" + id + ",";
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "serviceChild.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		              	  	 if(data.content.serviceChildList != null){
		            	  		jQuery.each(data.content.serviceChildList, function(i, item) {
		            	  			if(item != null){
				    					htmlcode += "<option value=\"" + item.name + "\">" + item.name + "</option>";		
		            	  			}
				    	  		});
				    	 	 }
				    	  }
				    	  $("#fuwuzixianginput_search").html(htmlcode);
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		
		//获取老人基本信息
		function getOlderJBXX(olderId){
			var olderData = "";
			var reqmsg="{'action':'QUERY_OLDER_INFO_REQUEST','content':{\"olderAddressListShow\":\"true\",\"id\":"+olderId+"}}";
				  jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "daeOlder.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		            	  if(data.content != null){
		            	  	olderData = JSON.stringify(data.content);
		            	  }
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		    });
		    return olderData;
		}
		 	//获取当前登陆员工姓名
			function getLoginName(){
		    	  var userId_login = "<%=request.getAttribute("userId")%>";
				  var reqmsg="{'action':'QUERY_EMPLOYEE_LIST_REQUEST','page':{'pageno':'1','pagesize':'1'},'content':{\"siteListShow\":\"true\",\"userId\":"+userId_login+"}}";
		
				  jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "employee.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		            	  if (data.content != null) {
		            	    var siteIds = "";
		            	  	if(data.content.employeeList != null && data.content.employeeList.length == 1){
		            	  		if(data.content.employeeList[0] != null && data.content.employeeList[0] != ""){
		            	  			var name = data.content.employeeList[0].name;
		            	  			$("#addUserName").val(name);
		            	  			if (data.content.employeeList[0].siteList != null && data.content.employeeList[0].siteList.length > 0) {//所属站点
		            	  				jQuery.each(data.content.employeeList[0].siteList, function(j, item2) {
											siteIds += item2.id + ",";
										});
										if(siteIds != ""){
											siteIds = siteIds.substring(0, siteIds.length-1);
										}
										$("#addUserSites").val(siteIds);
		            	  			}
		            	  		}
		            	  	}
						}
					}else if(data.des=="failure"){
		                 alert("查询失败");
		            }
		          },
		          error:function(){
			           alert("error");
		          }
		     	  });
			}
			//获取参与人姓名角色
			function getcyrNameRole(id){
				  var reqmsg="{'action':'QUERY_EMPLOYEE_INFO_REQUEST','content':{\"id\":"+id+"}}";
				  var nameroles = "";
				  jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "employee.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		            	  if (data.content != null) {
		            	  	   nameroles = data.content.name + "||" + data.content.roleNames + "||" + data.content.indexNum;
		            	  }
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     	  });
		     	  return nameroles;
			}
		//获取当前时间return yyyymmddhhmmss
		function getNowFormatDate2() {
		    var date = new Date();
		    var month = date.getMonth() + 1;
		    var strDate = date.getDate();
		    var strHour = date.getHours();
		    var strMinutes = date.getMinutes();
		    var strSeconds = date.getSeconds();
		    
		    if (month >= 1 && month <= 9) {
		        month = "0" + month;
		    }
		    if (strDate >= 0 && strDate <= 9) {
		        strDate = "0" + strDate;
		    }
		    if (strHour >= 0 && strHour <= 9) {
		        strHour = "0" + strHour;
		    }
		    if (strMinutes >= 0 && strMinutes <= 9) {
		        strMinutes = "0" + strMinutes;
		    }
		    if (strSeconds >= 0 && strSeconds <= 9) {
		        strSeconds = "0" + strSeconds;
		    }
		    var currentdate = date.getFullYear() + "" + month + "" + strDate + "" + strHour + "" + strMinutes + "" + strSeconds;
		    return currentdate;
		}
		
		//到2016-08-08 12:12分的时间选择器转化YYYYMMDDhhmmss
		function changeTime(time){
			var times = "";
			times = String(time);
			if(times == null || times == ""){
				return;
			}
			times = times.split("-")[0] + times.split("-")[1] + String(times.split("-")[2]).substr(0,2) + String(times.split("-")[2]).substr(3,2) + String(times.split("-")[2]).substr(6,2) + "00";
			return times;
		}
		function saveMany(){
			var yujiFWDateList = $("#yujiFWDate tr");
			var time = "";
			var flag = 0;
				var olderId = $("#olderId_hide").val();
				if(olderId == null || olderId == ""){
					alert("请选择老人");
					return;
				}
				var contactName = $.trim($("#oldinput_contentName").val());
				var contactTel = $.trim($("#oldinput_contentTel").val());
				var address = $.trim($("#oldinput_contentAddress").val());
				if(contactName == null || contactName == ""){
					alert("请填写联系人");
					return;
				}
				if(contactTel == null || contactTel == ""){
					alert("请填写联系电话");
					return;
				}
				if(address == null || address == ""){
					alert("请填写联系地址");
					return;
				}
				var fuzerenId_hide = $("#fuzerenId_hide").val();
				if(fuzerenId_hide == null || fuzerenId_hide == ""){
					alert("请选择负责人");
					return;
				}
				var fwxminput_Id4_hide = $("#fwxminput_Id4_hide").val();
				if(fwxminput_Id4_hide == "" || fwxminput_Id4_hide == null){
					alert("请选择服务内容");
					return;
				}
				//var fuwuzixianginput_search = $("#fuwuzixianginput_search").val();
				//if(fuwuzixianginput_search == "" || fuwuzixianginput_search == null){
				//	alert("请选择服务子项");
				//	return;
				//}
				var yjfwsc = $("#yjfwsc").val();
				var reg1 = new RegExp("^(0|[1-9][0-9]*)$"); 
				if(!reg1.test(yjfwsc)){ 
		       		alert("请输入符合规范的预计服务时长!");
		       		return;
		   	 	}
			if(yujiFWDateList.length > 1){//有时间
				for(var i = 0;i<yujiFWDateList.length-1;i++){
					time = changeTime($("#yujiFWDate").find("tr:eq("+i+")").find("td:eq(0)").find("input").val());
					if(time == null || time == ""){
						alert("请选择时间");
						return;
					}
				}
				for(var i = 0;i<yujiFWDateList.length-1;i++){
					time = changeTime($("#yujiFWDate").find("tr:eq("+i+")").find("td:eq(0)").find("input").val());
					flag = save(time);
				}
				if(flag == 1){
					$("#closeAll").click();
		            alert("新增成功");
		            query5();
				}else{
					alert("新增失败");
				}
			}else{
				//演示逻辑
				//flag = save('');
				//if(flag == 1){
				//	$("#closeAll").click();
		        //    alert("新增成功");
		        //    query();
				//}else{
				//	alert("新增失败");
				//}
				alert("请选择预计服务时间");
				return;
			}
		}
		function save(yujiFWDate){
			var olderId = $("#olderId_hide").val();
		
			var flag = 0;
			var olderData = getOlderJBXX(olderId);
			var olderMemberNum = "";
			var olderName = "";
			var olderBirthdate = "";
			var serviceAreaId = 0;
			var serviceStreetId = 0;
			var contactName = $.trim($("#oldinput_contentName").val());
			var contactTel = $.trim($("#oldinput_contentTel").val());
			var address = $.trim($("#oldinput_contentAddress").val());
			if(olderData != ""){
				var obj = JSON.parse(olderData);
				olderMemberNum = obj.memberNum;
				olderName = obj.name;
				olderBirthdate = obj.birthdate;
				serviceAreaId = obj.serviceAreaId;
				serviceStreetId = obj.serviceStreetId;
				/* contactName = obj.name;
				contactTel = obj.mobileTel;
				if(obj.olderAddressList != null){
		 			jQuery.each(obj.olderAddressList, function(i, item) {//居住地
		 				if(item.addressType == 0){
		 					if(item.address != "" && item.address != null){
		 						address=getNameById(item.provinceId)+","+getNameById(item.cityId)+","+getNameById(item.areaId)+","+item.address;
		 					}else{
		 						address=getNameById(item.provinceId)+","+getNameById(item.cityId)+","+getNameById(item.areaId);
		 					}
		 				}
		 			});
		 		} */
			}
			
			var fuzerenSiteId_hide = $("#fuzerenSiteId_hide").val();
			var fuzerenSiteName_hide = $("#fuzerenSiteName_hide").val();
		
			var fwxminput_Id4_hide = $("#fwxminput_Id4_hide").val();
			var fwxminput_SCPRICE4_hide = $("#fwxminput_SCPRICE4_hide").val();
			var fwxminput_YBPRICE4_hide = $("#fwxminput_YBPRICE4_hide").val();
			
			var fuwuzixianginput_search = $("#fuwuzixianginput_search").val();
			if(fuwuzixianginput_search == "" || fuwuzixianginput_search == null){
				fuwuzixianginput_search = "";
			}
			
			var yjfwsc = $("#yjfwsc").val();
			
			var fuzerenId_hide = $("#fuzerenId_hide").val();
			var fuzerenName_hide = $("#fuzerenName_hide").val();
			var fuzerenRole_hide = $("#fuzerenRole_hide").val();
			var fuzerenBH_hide = $("#fuzerenBH_hide").val();
			
			var cyrinput_search = $("#cyrinput_search").val();
			var canyurenArray = null;
			if(cyrinput_search != null && cyrinput_search !=""){
				canyurenArray = String(cyrinput_search).split(",");
			}
			
			var reqmsg="{'action':'ADD_SERVICE_TASK_INFO_REQUEST','content':{";
			
			if (olderId != null && olderId != "") {
		        reqmsg += "\"olderId\":" + olderId + ",";
			}
			if (olderMemberNum != null && olderMemberNum != "") {
		        reqmsg += "\"olderMemberNum\":\"" + olderMemberNum + "\",";
			}
			if (olderName != null && olderName != "") {
		        reqmsg += "\"olderName\":\"" + olderName + "\",";
			}
			if (olderBirthdate != null && olderBirthdate != "") {
		        reqmsg += "\"olderBirthdate\":\"" + olderBirthdate + "\",";
			}
			if (serviceAreaId != null && serviceAreaId != 0) {
		        reqmsg += "\"serviceAreaId\":" + serviceAreaId + ",";
			}
			if (serviceStreetId != null && serviceStreetId != 0) {
		        reqmsg += "\"serviceStreetId\":" + serviceStreetId + ",";
			}
			if (contactName != null && contactName != "") {
		        reqmsg += "\"contactName\":\"" + contactName + "\",";
			}
			if (contactTel != null && contactTel != "") {
		        reqmsg += "\"contactTel\":\"" + contactTel + "\",";
			}
			if (address != null && address != "") {
		        reqmsg += "\"address\":\"" + address + "\",";
			}
			
			if (yujiFWDate != null && yujiFWDate != "") {
		        reqmsg += "\"serviceExpectTime\":\"" + yujiFWDate + "\",";
			}
			//else{//下次删除
			//	reqmsg += "\"status\":2,";
			//}
		    reqmsg += "\"status\":4,";
		
			if (fuzerenSiteId_hide != null && fuzerenSiteId_hide != "") {
		        reqmsg += "\"siteId\":" + fuzerenSiteId_hide + ",";
			}
			if (fuzerenSiteName_hide != null && fuzerenSiteName_hide != "") {
		        reqmsg += "\"siteName\":\"" + fuzerenSiteName_hide + "\",";
			}
			
			var fuwusflx_search = $("#fuwusflx_search").val();
			if(fuwusflx_search == "医保"){
				reqmsg += "\"healthInsurance\":1,";
				reqmsg += "\"price\":" + fwxminput_YBPRICE4_hide + ",";
			}else{
				reqmsg += "\"healthInsurance\":2,";
				reqmsg += "\"price\":" + fwxminput_SCPRICE4_hide + ",";
			}
			
		
			var name = $("#addUserName").val();
			if(name == "" || name == null){
				alert("当前非员工,无法操作");
				return;
			}
			reqmsg += "\"addPerson\":\"" + name + "\",";
			reqmsg += "\"addTime\":\"" + getNowFormatDate2() + "\",";
			
			if (fwxminput_Id4_hide != null && fwxminput_Id4_hide != "") {
		        reqmsg += "\"serviceTask_service_list\":[{";
		        reqmsg += "\"serviceId\":" + fwxminput_Id4_hide + "," ;
		        reqmsg += "\"fuwuSonNames\":\"" + fuwuzixianginput_search + "\",";
		        reqmsg += "\"yjfuwuTime\":\"" + yjfwsc + "分钟\",";
		        reqmsg += "}]," ;
			}
			
			if (fuzerenId_hide != null && fuzerenId_hide != "") {
				reqmsg += "\"chargeEmployeeId\":" + fuzerenId_hide +",";
			}
			
			reqmsg += "\"serviceEmployeeList\":[" ;
			if (fuzerenId_hide != null && fuzerenId_hide != "") {
				reqmsg += "{\"employeeId\":" + fuzerenId_hide +",";
				reqmsg += "\"name\":\"" + fuzerenName_hide +"\",";
				reqmsg += "\"employeeCode\":\"" + fuzerenBH_hide +"\",";
				reqmsg += "\"role\":\"" + fuzerenRole_hide +"\",";
				reqmsg += "\"type\":1},";
			}
			if(canyurenArray != null && canyurenArray != ""){
				for(var i = 0;i < canyurenArray.length;i++){
					var nameroles = getcyrNameRole(canyurenArray[i]);
					reqmsg += "{\"employeeId\":" + canyurenArray[i] +",";
					if(nameroles.split("||").length == 3){
						reqmsg += "\"name\":\"" + nameroles.split("||")[0] +"\",";
						reqmsg += "\"role\":\"" + nameroles.split("||")[1] +"\",";
						reqmsg += "\"employeeCode\":\"" + nameroles.split("||")[2] +"\",";
					}
					reqmsg += "\"type\":2},";
				}
			}
			reqmsg += "],";
			
			reqmsg += "\"serviceLogList\":[" ;
			reqmsg += "{\"createTime\":\"" + getNowFormatDate2() +"\",";
			reqmsg += "\"createPerson\":\"" + name +"\",";
			reqmsg += "\"type\":\"新增工单\",";
			reqmsg += "\"log\":\"" + name + "新增了工单\"}";
			reqmsg += "],";
			
			reqmsg=reqmsg.substr(0,reqmsg.length-1);
			reqmsg += "}}";
		
			jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "serviceTask.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	flag = 1;
		              	//alert("保存成功");
		              }else if(data.des=="failure"){
		                 alert("保存失败");
		              }else{
		              	alert(data.des);
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		     return flag;
		}
		
		function qingkongXZ(){
			$("#olderId_hide").val("");
			$("#oldinput_search2").val("");
			$("#oldinput_contentName").val("");
			$("#oldinput_contentTel").val("");
			$("#oldinput_contentAddress").val("");
			
			$("#fuzerenId_hide").val("");
			$("#fuzerenSiteId_hide").val("");
			$("#fuzerenSiteName_hide").val("");
			$("#fuzerenName_hide").val("");
			$("#fuzerenRole_hide").val("");
			$("#fuzerenBH_hide").val("");
			
			$("#fprinput_search").val("");
			
			$("#cyrinput_search").val("").trigger("change");
			
			$("#fwxminput_search4").val("");
			$("#fwxminput_Id4_hide").val("");
			$("#fwxminput_SCPRICE4_hide").val("");
			$("#fwxminput_YBPRICE4_hide").val("");
			
			var html = "";
			html += "<tr id=\"addshuizhong\">";			
			html += "<td> </td>";					
			html += "<td style=\"text-align:right\"><a class=\"label btn-primary \" onclick=\"addshuizhong();\"><i class=\"fa fa-plus\"></i></a> </td>";								
			html += "</tr>";								
			$("#yujiFWDate").html(html);	
			
			$("#fuwuzixianginput_search").html("");
			$("#fuwuzixianginput_search").val("").trigger("change");
			$("#yjfwsc").val("");	
			
			$("#fuwusflx_search").val("医保");	
			$("#fuwusfjg_search").html("暂无");						
		}
		
		
		function quxiao_qingkong(){
			var name = $("#addUserName").val();
			if(name == "" || name == null){
				alert("当前非员工,无法操作");
				return;
			}
			$("#beizhu_input_quxiao").val("");
			var selectedItemNumber = $("tbody .col_selector5:checked").length;
			if (selectedItemNumber < 1) {
				alert("请选择要取消的数据");
				return;
			}else{
				$("#idForQX").val("");
				$("#quxiao_open5").click();
			}
		}
		function quxiao_qingkong2(id){
			var name = $("#addUserName").val();
			if(name == "" || name == null){
				alert("当前非员工,无法操作");
				return;
			}
			$("#beizhu_input_quxiao").val("");
			$("#quxiao_open5").click();
			$("#idForQX").val(id);
		}
		function sureQuxiao() {
			var beizhu_input_quxiao = $("#beizhu_input_quxiao").val();
			if(beizhu_input_quxiao != null && beizhu_input_quxiao != ""){
				if(beizhu_input_quxiao.length > 200){
					alert("备注超出字数限制200字");
					return;
				}
			}
			var name = $("#addUserName").val();
			var reqmsg="{'action':'ADD_SERVICE_TASK_INFO_REQUEST','content':{";
			
			var idForQX = $("#idForQX").val();
			if(idForQX != null && idForQX != ""){//单个
				 reqmsg += "\"id\":" + idForQX + ",";
			}else{
				var selectedItemNumber = $("tbody .col_selector5:checked").length;
				if (selectedItemNumber >= 1) {
					var ids2del = "";
					$("tbody .col_selector5:checked").each(function() {
						ids2del += $(this).val() + ",";
					});
					if (ids2del != "") {
						ids2del = ids2del.substring(0, ids2del.length - 1);
					}
				  
					if (ids2del != null && ids2del != "") {
		        		reqmsg += "\"ids2del\":\"" + ids2del + "\",";
					}
				} else {
					alert("请选择要取消的数据");
					return;
				}
			}
			
				reqmsg += "\"status\":1,";
			
				reqmsg += "\"serviceLogList\":[" ;
				reqmsg += "{\"createTime\":\"" + getNowFormatDate2() +"\",";
				reqmsg += "\"createPerson\":\"" + name +"\",";
				reqmsg += "\"type\":\"取消工单\",";
				if(beizhu_input_quxiao == null || beizhu_input_quxiao == ""){
					reqmsg += "\"log\":\"" + name + "取消了工单\"}";
				}else{
					reqmsg += "\"log\":\"" + beizhu_input_quxiao + "\"}";
				}
				reqmsg += "],";
			
				reqmsg += "}}";
				
				jQuery.ajax({
		         	 type : "post",
		         	 async:false,
		         	 url : "serviceTask.do?handler",
		        	  dataType : "json",
		        	  data: {
		        	       "reqmsg":reqmsg
		        	  },
		         	 success : function(data){
		         	     if(data.result == "100"){
		         	     	go2page5(currentshownpage5);
		         	     	alert("取消工单成功");
		         	     	$("#quxiao_tanchuang").click();
		         	     }else{
		         	        alert("取消工单失败");
		         	        $("#quxiao_tanchuang").click();
		         	     }
		         	 },
		         	 error:function(){
			     	      alert("error");
		          	}
		     	});
		}
		
		//实时获取负责人姓名
		function getepgrName(){
			var reqmsg="{'action':'QUERY_EMPLOYEE_LIST_REQUEST','page':{'pageno':'1','pagesize':'5'},'content':{";
			var name = $("#pgrinput_search").val();
			if (name != null && name != "") {
				reqmsg += "\"name_like\":\"" + name + "\"";
			}else{
				$("#hideul_nei25").html("");
				$("#hideul-25").hide();
				return;
			}
			reqmsg += "}}";
		
		    jQuery.ajax({
		          type : "post",
		          async:false,
		          url : "employee.do?handler",
		          dataType : "json",
		          data: {
		               "reqmsg":reqmsg
		          },
		          success : function(data){
		              if(data.des=="success"){
		              	  var htmlcode = "";
		              	  if(data.content != null){
		              	  	 if(data.content.employeeList != null){
		            	  		jQuery.each(data.content.employeeList, function(i, item) {
		            	  				if(item != null){
				    						htmlcode += "<li onclick=\"pgrNamefuzhi('" + item.name + "'," + item.id + ")\">" + item.name + "</li>";		
		            	  				}	
				    	  		});
				    	 	 }
				    	  }
				    	  $("#hideul_nei25").html(htmlcode);
				    	  $("#hideul-25").show();
		              }else if(data.des=="failure"){
		                 alert("查询失败");
		              }
		          },
		          error:function(){
			           alert("error");
		          }
		     });
		}
		//负责人姓名赋值
		function pgrNamefuzhi(name,id){
			$("#pgrinputId").val(id);
			$("#pgrinput_search").val(name);
			$("#hideul_nei25").html("");
			$("#hideul-25").hide();
		}
		
	</script>
	
	<script src="js/behaviour/voice-commands.js"></script>
	<script src="js/bootstrap/dist/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/jquery.flot/jquery.flot.js"></script>
	<script type="text/javascript" src="js/jquery.flot/jquery.flot.pie.js"></script>
	<script type="text/javascript" src="js/jquery.flot/jquery.flot.resize.js"></script>
	<script type="text/javascript" src="js/jquery.flot/jquery.flot.labels.js"></script>
	<script type="text/javascript" src="js/jquery.form.js"></script>
</body>
</html>
