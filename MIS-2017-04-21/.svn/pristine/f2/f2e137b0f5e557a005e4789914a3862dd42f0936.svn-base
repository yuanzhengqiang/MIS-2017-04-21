package fsk.util;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class SQLserverUtils {
	private static SQLserverUtils sqlserver;
	Connection conn = null;
	Statement stmt = null;
	ResultSet rs = null;

	/**
	 * 获取实例
	 * 
	 * @return
	 */
	public static SQLserverUtils getInstance() {
		if (sqlserver == null) {
			sqlserver = new SQLserverUtils();
		}
		return sqlserver;
	}

	public ResultSet selectBySQL(String sql) {

		try {
			Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
			String url = "jdbc:sqlserver://10.7.20.202:1433; DatabaseName=KXT_Middleware";
			String user = "KXTdb";
			String password = "KXTsoft2010"; // 用户名和密码在此都设为空；
			conn = DriverManager.getConnection(url, user, password);
			stmt = conn.createStatement();
			sql = "select * from Server_ChannelIP where IPAddress='10.7.20.151'";
			rs = stmt.executeQuery(sql);

		} catch (Exception ex) {
			if (stmt != null) {
				try {
					stmt.close();
				} catch (Exception ex1) {
				}
			}
			if (conn != null) {
				try {
					conn.close();
				} catch (Exception ex1) {
				}
			}
			if (rs != null) {
				try {
					rs.close();
				} catch (Exception ex1) {
				}
			}
		}
		return rs;

	}

	public void close() {
		if (stmt != null) {
			try {
				stmt.close();
			} catch (Exception ex1) {
			}
		}
		if (conn != null) {
			try {
				conn.close();
			} catch (Exception ex1) {
			}
		}
		if (rs != null) {
			try {
				rs.close();
			} catch (Exception ex1) {
			}
		}
	}

	public String updateBySQL(String sql) {
		int result = 0;
		try {
			Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
			String url = "jdbc:sqlserver://10.7.20.202:1433; DatabaseName=KXT_Middleware";
			String user = "KXTdb";
			String password = "KXTsoft2010"; // 用户名和密码在此都设为空；
			conn = DriverManager.getConnection(url, user, password);
			stmt = conn.createStatement();
			sql = "select * from Server_ChannelIP where IPAddress='10.7.20.151'";
			result = stmt.executeUpdate(sql);

		} catch (Exception ex) {
			if (stmt != null) {
				try {
					stmt.close();
				} catch (Exception ex1) {
				}
			}
			if (conn != null) {
				try {
					conn.close();
				} catch (Exception ex1) {
				}
			}
			if (rs != null) {
				try {
					rs.close();
				} catch (Exception ex1) {
				}
			}
		}
		return null;

	}
}
