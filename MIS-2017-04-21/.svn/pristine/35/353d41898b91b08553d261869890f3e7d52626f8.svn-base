package fsk.parse.siteServiceArea;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.servlet.http.HttpServletRequest;

import net.sf.json.JSONArray;
import net.sf.json.JSONObject;

import org.apache.log4j.Logger;

import com.framework.system.common.entity.dataDic.DataDicEntity;
import com.framework.system.db.query.OrderVO;
import com.framework.system.util.JsonUtil;

import fsk.entity.site.SiteEntity;
import fsk.entity.siteServiceArea.SiteServiceAreaEntity;
 /**   
 * @Title: Parse
 * @Description: 站点服务区域关联表解析器
 * @author feng.gu
 * @date 2016-06-21 08:39:49
 * @version V1.0   
 *
 */
public class SiteServiceAreaParse {
	private static Logger logger = Logger.getLogger(SiteServiceAreaParse.class);
	private static SiteServiceAreaParse siteServiceAreaParse;

	/**
	 * 获取实例
	 * 
	 * @return
	 */
	public static SiteServiceAreaParse getInstance() {
		if (siteServiceAreaParse == null) {
			siteServiceAreaParse = new SiteServiceAreaParse();
		}
		return siteServiceAreaParse;
	}

	public Map<String, Object> parse(int type, String command,String reqStr,
			HttpServletRequest request) {
		// 定义返回参数
		Map<String, Object> parseMap = new HashMap<String, Object>();
		if (type == 1) {
			// json
			parseMap = this.parseByJson(command,reqStr, request);
		} else if (type == 2) {
			// xml
			parseMap = this.parseByXml(command,reqStr, request);
		}
		return parseMap;
	}

	private Map<String, Object> parseByJson(String command,String reqStr,
			HttpServletRequest request) {
		// 定义返回参数
		Map<String, Object> parseMap = new HashMap<String, Object>();
		try {
			String actionReturn = null;
			SiteServiceAreaEntity siteServiceAreaReturn = null;
			List<SiteServiceAreaEntity> siteServiceAreaListReturn = null;
			Integer idReturn = null;			
			Map<String, Object> queryMapReturn = null;
			int pagenoReturn = 1;
			int pagesizeReturn = 10;
			List<OrderVO> orderListReturn = null;
			
															Boolean siteShowReturn = false;
			Boolean delSiteReturn = false;
																								Boolean serviceStreetShowReturn = false;
			Boolean delServiceStreetReturn = false;
															
			//json
			Map reqParams = JsonUtil.getMap4Json(reqStr);
			JSONObject contentreq = (JSONObject)reqParams.get("content");
			if ("ADD_SITE_SERVICE_AREA_INFO_REQUEST".equals(command)) {
				actionReturn = "save";
				siteServiceAreaReturn = new SiteServiceAreaEntity();
				if(true){
					if(contentreq!=null){
												    						    Integer id = (Integer)contentreq.get("id");
	                		if(id!=null){
			                	siteServiceAreaReturn.setId(id);
			                }
						    												    						    Integer siteId = (Integer)contentreq.get("siteId");
	                		if(siteId!=null){
			                	siteServiceAreaReturn.setSiteId(siteId);
			                }
						    												    						    Integer serviceStreetId = (Integer)contentreq.get("serviceStreetId");
	                		if(serviceStreetId!=null){
			                	siteServiceAreaReturn.setServiceStreetId(serviceStreetId);
			                }
						    											}					
				}
																				if(true){
					Object site = contentreq.get("site");
					if(site!=null){
						JSONObject obj = (JSONObject)site;
						if(obj!=null){
							SiteEntity entity = new SiteEntity();						
								                		Integer id = (Integer)obj.get("id");
	                		if(id!=null){
			                	entity.setId(id);
			                }
								                		Integer masterEmployeeId = (Integer)obj.get("masterEmployeeId");
	                		if(masterEmployeeId!=null){
			                	entity.setMasterEmployeeId(masterEmployeeId);
			                }
								                		String name = (String)obj.get("name");
	                		if(name!=null){
			                	entity.setName(name);
			                }
								                		String mainPhoto = (String)obj.get("mainPhoto");
	                		if(mainPhoto!=null){
			                	entity.setMainPhoto(mainPhoto);
			                }
								                		String contactPerson = (String)obj.get("contactPerson");
	                		if(contactPerson!=null){
			                	entity.setContactPerson(contactPerson);
			                }
								                		String contactTel = (String)obj.get("contactTel");
	                		if(contactTel!=null){
			                	entity.setContactTel(contactTel);
			                }
								                		Integer provinceId = (Integer)obj.get("provinceId");
	                		if(provinceId!=null){
			                	entity.setProvinceId(provinceId);
			                }
								                		Integer cityId = (Integer)obj.get("cityId");
	                		if(cityId!=null){
			                	entity.setCityId(cityId);
			                }
								                		Integer areaId = (Integer)obj.get("areaId");
	                		if(areaId!=null){
			                	entity.setAreaId(areaId);
			                }
								                		Integer streetId = (Integer)obj.get("streetId");
	                		if(streetId!=null){
			                	entity.setStreetId(streetId);
			                }
								                		String address = (String)obj.get("address");
	                		if(address!=null){
			                	entity.setAddress(address);
			                }
														siteServiceAreaReturn.setSite(entity);
						}						
					}
				}
																																if(true){
					Object serviceStreet = contentreq.get("serviceStreet");
					if(serviceStreet!=null){
						JSONObject obj = (JSONObject)serviceStreet;
						if(obj!=null){
							DataDicEntity entity = new DataDicEntity();						
								                		Integer id = (Integer)obj.get("id");
	                		if(id!=null){
			                	entity.setId(id);
			                }
								                		String code = (String)obj.get("code");
	                		if(code!=null){
			                	entity.setCode(code);
			                }
								                		String name = (String)obj.get("name");
	                		if(name!=null){
			                	entity.setName(name);
			                }
								                		String value = (String)obj.get("value");
	                		if(value!=null){
			                	entity.setValue(value);
			                }
								                		String des = (String)obj.get("des");
	                		if(des!=null){
			                	entity.setDes(des);
			                }
								                		Integer parentId = (Integer)obj.get("parentId");
	                		if(parentId!=null){
			                	entity.setParentId(parentId);
			                }
								                		Integer createUserId = (Integer)obj.get("createUserId");
	                		if(createUserId!=null){
			                	entity.setCreateUserId(createUserId);
			                }
								                		String createTime = (String)obj.get("createTime");
	                		if(createTime!=null){
			                	entity.setCreateTime(createTime);
			                }
								                		Integer updateUserId = (Integer)obj.get("updateUserId");
	                		if(updateUserId!=null){
			                	entity.setUpdateUserId(updateUserId);
			                }
								                		String updateTime = (String)obj.get("updateTime");
	                		if(updateTime!=null){
			                	entity.setUpdateTime(updateTime);
			                }
														siteServiceAreaReturn.setServiceStreet(entity);
						}						
					}
				}
																			} else if ("QUERY_SITE_SERVICE_AREA_INFO_REQUEST".equals(command)) {
				actionReturn = "getById";
				if(true){
					if(contentreq!=null){
						idReturn = (Integer)contentreq.get("id");
					        																												String siteShow = (String)contentreq.get("siteShow");
							if("true".equals(siteShow)){
								siteShowReturn = true;
							}
																																																								String serviceStreetShow = (String)contentreq.get("serviceStreetShow");
							if("true".equals(serviceStreetShow)){
								serviceStreetShowReturn = true;
							}
																																	}	
				}
			} else if ("QUERY_SITE_SERVICE_AREA_LIST_REQUEST".equals(command)) {
				actionReturn = "getListByCondition";
				if(true){
					if(contentreq!=null){
						queryMapReturn = new HashMap<String, Object>();
																		Integer id_gt = (Integer)contentreq.get("id_gt");
						Integer id_ge = (Integer)contentreq.get("id_ge");
						Integer id_lt = (Integer)contentreq.get("id_lt");
						Integer id_le = (Integer)contentreq.get("id_le");
						String id_in = (String)contentreq.get("id_in");
						Integer id = (Integer)contentreq.get("id");
                        if(id_gt!=null){
                        	queryMapReturn.put("id_gt", id_gt);
						}
						if(id_ge!=null){
                        	queryMapReturn.put("id_ge", id_ge);
						}
						if(id_lt!=null){
                        	queryMapReturn.put("id_lt", id_lt);
						}
						if(id_le!=null){
                        	queryMapReturn.put("id_le", id_le);
						}
						if(id_in!=null){
                        	queryMapReturn.put("id_in", id_in);
						}
						if(id!=null){
                        	queryMapReturn.put("id", id);
						}		
																								Integer siteId_gt = (Integer)contentreq.get("siteId_gt");
						Integer siteId_ge = (Integer)contentreq.get("siteId_ge");
						Integer siteId_lt = (Integer)contentreq.get("siteId_lt");
						Integer siteId_le = (Integer)contentreq.get("siteId_le");
						String siteId_in = (String)contentreq.get("siteId_in");
						Integer siteId = (Integer)contentreq.get("siteId");
                        if(siteId_gt!=null){
                        	queryMapReturn.put("siteId_gt", siteId_gt);
						}
						if(siteId_ge!=null){
                        	queryMapReturn.put("siteId_ge", siteId_ge);
						}
						if(siteId_lt!=null){
                        	queryMapReturn.put("siteId_lt", siteId_lt);
						}
						if(siteId_le!=null){
                        	queryMapReturn.put("siteId_le", siteId_le);
						}
						if(siteId_in!=null){
                        	queryMapReturn.put("siteId_in", siteId_in);
						}
						if(siteId!=null){
                        	queryMapReturn.put("siteId", siteId);
						}		
																								Integer serviceStreetId_gt = (Integer)contentreq.get("serviceStreetId_gt");
						Integer serviceStreetId_ge = (Integer)contentreq.get("serviceStreetId_ge");
						Integer serviceStreetId_lt = (Integer)contentreq.get("serviceStreetId_lt");
						Integer serviceStreetId_le = (Integer)contentreq.get("serviceStreetId_le");
						String serviceStreetId_in = (String)contentreq.get("serviceStreetId_in");
						Integer serviceStreetId = (Integer)contentreq.get("serviceStreetId");
                        if(serviceStreetId_gt!=null){
                        	queryMapReturn.put("serviceStreetId_gt", serviceStreetId_gt);
						}
						if(serviceStreetId_ge!=null){
                        	queryMapReturn.put("serviceStreetId_ge", serviceStreetId_ge);
						}
						if(serviceStreetId_lt!=null){
                        	queryMapReturn.put("serviceStreetId_lt", serviceStreetId_lt);
						}
						if(serviceStreetId_le!=null){
                        	queryMapReturn.put("serviceStreetId_le", serviceStreetId_le);
						}
						if(serviceStreetId_in!=null){
                        	queryMapReturn.put("serviceStreetId_in", serviceStreetId_in);
						}
						if(serviceStreetId!=null){
                        	queryMapReturn.put("serviceStreetId", serviceStreetId);
						}		
															
						    																																																	
																																			String siteShow = (String)contentreq.get("siteShow");
							if("true".equals(siteShow)){
								siteShowReturn = true;
							}
																																																								String serviceStreetShow = (String)contentreq.get("serviceStreetShow");
							if("true".equals(serviceStreetShow)){
								serviceStreetShowReturn = true;
							}
																																	}
					JSONObject pagereq = (JSONObject)reqParams.get("page");
				    if (pagereq != null) {
				    String pagenotemp = (String)pagereq.get("pageno");
				    String pagesizetemp = (String)pagereq.get("pagesize");
				    if ((pagenotemp != null) && (!"".equals(pagenotemp.trim()))) {
				          pagenoReturn = Integer.valueOf(pagenotemp).intValue();
				    }
				    if ((pagesizetemp != null) && (!"".equals(pagesizetemp.trim()))) {
				          pagesizeReturn = Integer.valueOf(pagesizetemp).intValue();
				        }
				    }
				    Object orderreq = (Object) reqParams.get("order");
					if (orderreq != null) {
						JSONArray order = (JSONArray)orderreq;
						orderListReturn = new ArrayList<OrderVO>();
						for(int i=0;i<order.size();i++){
							JSONObject obj = order.getJSONObject(i);
							OrderVO orderVO = new OrderVO();
							orderVO.setName((String)obj.get("column"));
							orderVO.setOrderType((String)obj.get("type"));
							orderListReturn.add(orderVO);
						}						
					}
				}
			} else if ("DEL_SITE_SERVICE_AREA_INFO_REQUEST".equals(command)) {
				actionReturn = "del";
				if(true){
					if(contentreq!=null){
						idReturn = (Integer)contentreq.get("id");	
						    																												String delSite = (String)contentreq.get("delSite");
							if("true".equals(delSite)){
								delSiteReturn = true;
							}
																																																								String delServiceStreet = (String)contentreq.get("delServiceStreet");
							if("true".equals(delServiceStreet)){
								delServiceStreetReturn = true;
							}
																																	}	
				}
			} else if ("DEL_SITE_SERVICE_AREA_LIST_REQUEST".equals(command)) {
				actionReturn = "delList";
				if(true){
					if(contentreq!=null){
						queryMapReturn = new HashMap<String, Object>();
																		Integer id_gt = (Integer)contentreq.get("id_gt");
						Integer id_ge = (Integer)contentreq.get("id_ge");
						Integer id_lt = (Integer)contentreq.get("id_lt");
						Integer id_le = (Integer)contentreq.get("id_le");
						String id_in = (String)contentreq.get("id_in");
						Integer id = (Integer)contentreq.get("id");
                        if(id_gt!=null){
                        	queryMapReturn.put("id_gt", id_gt);
						}
						if(id_ge!=null){
                        	queryMapReturn.put("id_ge", id_ge);
						}
						if(id_lt!=null){
                        	queryMapReturn.put("id_lt", id_lt);
						}
						if(id_le!=null){
                        	queryMapReturn.put("id_le", id_le);
						}
						if(id_in!=null){
                        	queryMapReturn.put("id_in", id_in);
						}
						if(id!=null){
                        	queryMapReturn.put("id", id);
						}		
																								Integer siteId_gt = (Integer)contentreq.get("siteId_gt");
						Integer siteId_ge = (Integer)contentreq.get("siteId_ge");
						Integer siteId_lt = (Integer)contentreq.get("siteId_lt");
						Integer siteId_le = (Integer)contentreq.get("siteId_le");
						String siteId_in = (String)contentreq.get("siteId_in");
						Integer siteId = (Integer)contentreq.get("siteId");
                        if(siteId_gt!=null){
                        	queryMapReturn.put("siteId_gt", siteId_gt);
						}
						if(siteId_ge!=null){
                        	queryMapReturn.put("siteId_ge", siteId_ge);
						}
						if(siteId_lt!=null){
                        	queryMapReturn.put("siteId_lt", siteId_lt);
						}
						if(siteId_le!=null){
                        	queryMapReturn.put("siteId_le", siteId_le);
						}
						if(siteId_in!=null){
                        	queryMapReturn.put("siteId_in", siteId_in);
						}
						if(siteId!=null){
                        	queryMapReturn.put("siteId", siteId);
						}		
																								Integer serviceStreetId_gt = (Integer)contentreq.get("serviceStreetId_gt");
						Integer serviceStreetId_ge = (Integer)contentreq.get("serviceStreetId_ge");
						Integer serviceStreetId_lt = (Integer)contentreq.get("serviceStreetId_lt");
						Integer serviceStreetId_le = (Integer)contentreq.get("serviceStreetId_le");
						String serviceStreetId_in = (String)contentreq.get("serviceStreetId_in");
						Integer serviceStreetId = (Integer)contentreq.get("serviceStreetId");
                        if(serviceStreetId_gt!=null){
                        	queryMapReturn.put("serviceStreetId_gt", serviceStreetId_gt);
						}
						if(serviceStreetId_ge!=null){
                        	queryMapReturn.put("serviceStreetId_ge", serviceStreetId_ge);
						}
						if(serviceStreetId_lt!=null){
                        	queryMapReturn.put("serviceStreetId_lt", serviceStreetId_lt);
						}
						if(serviceStreetId_le!=null){
                        	queryMapReturn.put("serviceStreetId_le", serviceStreetId_le);
						}
						if(serviceStreetId_in!=null){
                        	queryMapReturn.put("serviceStreetId_in", serviceStreetId_in);
						}
						if(serviceStreetId!=null){
                        	queryMapReturn.put("serviceStreetId", serviceStreetId);
						}		
																		
																														String delSite = (String)contentreq.get("delSite");
						if("true".equals(delSite)){
							delSiteReturn = true;
						}
																																																String delServiceStreet = (String)contentreq.get("delServiceStreet");
						if("true".equals(delServiceStreet)){
							delServiceStreetReturn = true;
						}
																													}
					JSONObject pagereq = (JSONObject)reqParams.get("page");
				    if (pagereq != null) {
				    String pagenotemp = (String)pagereq.get("pageno");
				    String pagesizetemp = (String)pagereq.get("pagesize");
				    if ((pagenotemp != null) && (!"".equals(pagenotemp.trim()))) {
				          pagenoReturn = Integer.valueOf(pagenotemp).intValue();
				    }
				    if ((pagesizetemp != null) && (!"".equals(pagesizetemp.trim()))) {
				          pagesizeReturn = Integer.valueOf(pagesizetemp).intValue();
				        }
				    }
				}
			}

			if (actionReturn != null && !"".equals(actionReturn)) {
				parseMap.put("action", actionReturn);
			}
			if (siteServiceAreaReturn != null) {
				parseMap.put("siteServiceArea", siteServiceAreaReturn);
			}
			if (siteServiceAreaListReturn != null && siteServiceAreaListReturn.size() > 0) {
				parseMap.put("siteServiceAreaList", siteServiceAreaListReturn);
			}
			if (idReturn != null) {
				parseMap.put("id", idReturn);
			}	
			if (orderListReturn != null && orderListReturn.size() > 0) {
				parseMap.put("orderList", orderListReturn);
			}		
			if (queryMapReturn != null) {
				parseMap.put("queryMap", queryMapReturn);
			}
			if (pagenoReturn > 0) {
				parseMap.put("pageno", pagenoReturn);
			}
			if (pagesizeReturn > 0) {
				parseMap.put("pagesize", pagesizeReturn);
			}
			
			
															if (siteShowReturn != null) {
				parseMap.put("siteShow", siteShowReturn);
			}
			if (delSiteReturn != null) {
				parseMap.put("delSite", delSiteReturn);
			}
																								if (serviceStreetShowReturn != null) {
				parseMap.put("serviceStreetShow", serviceStreetShowReturn);
			}
			if (delServiceStreetReturn != null) {
				parseMap.put("delServiceStreet", delServiceStreetReturn);
			}
															
			
			
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
			logger.error(e);
		}
		return parseMap;
	}

	private Map<String, Object> parseByXml(String command,String reqStr,
			HttpServletRequest request) {
		// TODO Auto-generated method stub
		return null;
	}
}
